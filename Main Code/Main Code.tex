
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatability definitions
    \def\gt{>}
    \def\lt{<}
    % Document parameters
    \title{Main Code}
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    Recommendation System

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}4}]:} \PY{c+c1}{\PYZsh{}importing all necessary packages.}
        
        \PY{k+kn}{from} \PY{n+nn}{PIL} \PY{k}{import} \PY{n}{Image}
        \PY{k+kn}{import} \PY{n+nn}{requests}
        \PY{k+kn}{from} \PY{n+nn}{io} \PY{k}{import} \PY{n}{BytesIO}
        \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
        \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
        \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
        \PY{k+kn}{import} \PY{n+nn}{warnings}
        \PY{c+c1}{\PYZsh{}from bs4 import BeautifulSoup\PYZsh{}pulling data of html and xml files}
        \PY{k+kn}{from} \PY{n+nn}{nltk}\PY{n+nn}{.}\PY{n+nn}{corpus} \PY{k}{import} \PY{n}{stopwords}
        \PY{k+kn}{from} \PY{n+nn}{nltk}\PY{n+nn}{.}\PY{n+nn}{tokenize} \PY{k}{import} \PY{n}{word\PYZus{}tokenize}
        \PY{k+kn}{import} \PY{n+nn}{nltk}
        \PY{n}{nltk}\PY{o}{.}\PY{n}{download}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{stopwords}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{k+kn}{import} \PY{n+nn}{math}
        \PY{k+kn}{import} \PY{n+nn}{time}
        \PY{k+kn}{import} \PY{n+nn}{re}
        \PY{c+c1}{\PYZsh{}import os}
        \PY{k+kn}{import} \PY{n+nn}{seaborn} \PY{k}{as} \PY{n+nn}{sns}
        \PY{k+kn}{from} \PY{n+nn}{collections} \PY{k}{import} \PY{n}{Counter}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{feature\PYZus{}extraction}\PY{n+nn}{.}\PY{n+nn}{text} \PY{k}{import} \PY{n}{CountVectorizer}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{feature\PYZus{}extraction}\PY{n+nn}{.}\PY{n+nn}{text} \PY{k}{import} \PY{n}{TfidfVectorizer}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics}\PY{n+nn}{.}\PY{n+nn}{pairwise} \PY{k}{import} \PY{n}{cosine\PYZus{}similarity}  
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{pairwise\PYZus{}distances}
        \PY{k+kn}{from} \PY{n+nn}{matplotlib} \PY{k}{import} \PY{n}{gridspec}
        \PY{k+kn}{from} \PY{n+nn}{scipy}\PY{n+nn}{.}\PY{n+nn}{sparse} \PY{k}{import} \PY{n}{hstack}\PY{c+c1}{\PYZsh{}stack matrices horizontally}
        \PY{k+kn}{import} \PY{n+nn}{plotly}
        \PY{k+kn}{import} \PY{n+nn}{plotly}\PY{n+nn}{.}\PY{n+nn}{figure\PYZus{}factory} \PY{k}{as} \PY{n+nn}{ff}
        \PY{k+kn}{from} \PY{n+nn}{plotly}\PY{n+nn}{.}\PY{n+nn}{graph\PYZus{}objs} \PY{k}{import} \PY{n}{Scatter}\PY{p}{,} \PY{n}{Layout}
        
        \PY{n}{plotly}\PY{o}{.}\PY{n}{offline}\PY{o}{.}\PY{n}{init\PYZus{}notebook\PYZus{}mode}\PY{p}{(}\PY{n}{connected}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
        \PY{n}{warnings}\PY{o}{.}\PY{n}{filterwarnings}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ignore}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[nltk\_data] Downloading package stopwords to
[nltk\_data]     C:\textbackslash{}Users\textbackslash{}Manoj\textbackslash{}AppData\textbackslash{}Roaming\textbackslash{}nltk\_data{\ldots}
[nltk\_data]   Package stopwords is already up-to-date!

    \end{Verbatim}

    
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}2}]:} \PY{c+c1}{\PYZsh{}json file as input}
        \PY{n}{data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}json}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tops\PYZus{}fashion.json}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}4}]:} \PY{n+nb}{print} \PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Number of data points : }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{data}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PYZbs{}
               \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Number of features/variables:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{data}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Number of data points :  183138 Number of features/variables: 19

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}5}]:} \PY{n}{data}\PY{o}{.}\PY{n}{columns} \PY{c+c1}{\PYZsh{} prints column\PYZhy{}names or feature\PYZhy{}names.}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}5}]:} Index(['asin', 'author', 'availability', 'availability\_type', 'brand', 'color',
               'editorial\_reivew', 'editorial\_review', 'formatted\_price',
               'large\_image\_url', 'manufacturer', 'medium\_image\_url', 'model',
               'product\_type\_name', 'publisher', 'reviews', 'sku', 'small\_image\_url',
               'title'],
              dtype='object')
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}6}]:} \PY{n}{data}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}6}]:}          asin author                         availability availability\_type  \textbackslash{}
        0  B016I2TS4W   None                                 None              None   
        1  B01N49AI08   None                                 None              None   
        2  B01JDPCOHO   None                                 None              None   
        3  B01N19U5H5   None                                 None              None   
        4  B004GSI2OS   None  Usually ships in 6-10 business days               now   
        
                  brand              color editorial\_reivew  \textbackslash{}
        0         FNC7C               None              NaN   
        1  FIG Clothing               None              NaN   
        2  FIG Clothing               None              NaN   
        3       Focal18               None              NaN   
        4   FeatherLite  Onyx Black/ Stone              NaN   
        
                                            editorial\_review formatted\_price  \textbackslash{}
        0  Minions Como Superheroes Ironman Women's O Nec{\ldots}            None   
        1  Sizing runs on the small side. FIG® recommends{\ldots}            None   
        2  Sizing runs on the small side. FIG® recommends{\ldots}            None   
        3  100\% Brand New \& Fashion<br> Quantity: 1 Piece{\ldots}            None   
        4                                                             \$26.26   
        
                                             large\_image\_url manufacturer  \textbackslash{}
        0  https://images-na.ssl-images-amazon.com/images{\ldots}         None   
        1  https://images-na.ssl-images-amazon.com/images{\ldots}         None   
        2  https://images-na.ssl-images-amazon.com/images{\ldots}         None   
        3  https://images-na.ssl-images-amazon.com/images{\ldots}         None   
        4  https://images-na.ssl-images-amazon.com/images{\ldots}         None   
        
                                            medium\_image\_url model product\_type\_name  \textbackslash{}
        0  https://images-na.ssl-images-amazon.com/images{\ldots}  None             SHIRT   
        1  https://images-na.ssl-images-amazon.com/images{\ldots}  None             SHIRT   
        2  https://images-na.ssl-images-amazon.com/images{\ldots}  None             SHIRT   
        3  https://images-na.ssl-images-amazon.com/images{\ldots}  None             SHIRT   
        4  https://images-na.ssl-images-amazon.com/images{\ldots}  None             SHIRT   
        
          publisher                                            reviews   sku  \textbackslash{}
        0      None  [False, https://www.amazon.com/reviews/iframe?{\ldots}  None   
        1      None  [False, https://www.amazon.com/reviews/iframe?{\ldots}  None   
        2      None  [False, https://www.amazon.com/reviews/iframe?{\ldots}  None   
        3      None  [True, https://www.amazon.com/reviews/iframe?a{\ldots}  None   
        4      None  [False, https://www.amazon.com/reviews/iframe?{\ldots}  None   
        
                                             small\_image\_url  \textbackslash{}
        0  https://images-na.ssl-images-amazon.com/images{\ldots}   
        1  https://images-na.ssl-images-amazon.com/images{\ldots}   
        2  https://images-na.ssl-images-amazon.com/images{\ldots}   
        3  https://images-na.ssl-images-amazon.com/images{\ldots}   
        4  https://images-na.ssl-images-amazon.com/images{\ldots}   
        
                                                       title  
        0  Minions Como Superheroes Ironman Long Sleeve R{\ldots}  
        1                      FIG Clothing Womens Izo Tunic  
        2                        FIG Clothing Womens Won Top  
        3  Focal18 Sailor Collar Bubble Sleeve Blouse Shi{\ldots}  
        4  Featherlite Ladies' Long Sleeve Stain Resistan{\ldots}  
\end{Verbatim}
            
    Of these 19 features, we will be using only 6 features in this workshop.
1. asin ( Amazon standard identification number) 2. brand ( brand to
which the product belongs to ) 3. color ( Color information of apparel )
4. product\_type\_name (type of the apperal, ex: SHIRT/TSHIRT ) 5.
medium\_image\_url ( url of the image ) 6. title (title of the product.)
7. formatted\_price (price of the product)

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}26}]:} \PY{n}{data} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{asin}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{brand}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{color}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{medium\PYZus{}image\PYZus{}url}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{product\PYZus{}type\PYZus{}name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{title}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{formatted\PYZus{}price}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}27}]:} \PY{n}{data}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)} \PY{c+c1}{\PYZsh{} prints the top rows in the table.}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}27}]:}          asin         brand              color  \textbackslash{}
         0  B016I2TS4W         FNC7C               None   
         1  B01N49AI08  FIG Clothing               None   
         2  B01JDPCOHO  FIG Clothing               None   
         3  B01N19U5H5       Focal18               None   
         4  B004GSI2OS   FeatherLite  Onyx Black/ Stone   
         
                                             medium\_image\_url product\_type\_name  \textbackslash{}
         0  https://images-na.ssl-images-amazon.com/images{\ldots}             SHIRT   
         1  https://images-na.ssl-images-amazon.com/images{\ldots}             SHIRT   
         2  https://images-na.ssl-images-amazon.com/images{\ldots}             SHIRT   
         3  https://images-na.ssl-images-amazon.com/images{\ldots}             SHIRT   
         4  https://images-na.ssl-images-amazon.com/images{\ldots}             SHIRT   
         
                                                        title formatted\_price  
         0  Minions Como Superheroes Ironman Long Sleeve R{\ldots}            None  
         1                      FIG Clothing Womens Izo Tunic            None  
         2                        FIG Clothing Womens Won Top            None  
         3  Focal18 Sailor Collar Bubble Sleeve Blouse Shi{\ldots}            None  
         4  Featherlite Ladies' Long Sleeve Stain Resistan{\ldots}          \$26.26  
\end{Verbatim}
            
    \paragraph{Basic stats for the feature:
product\_type\_name}\label{basic-stats-for-the-feature-product_type_name}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}9}]:} \PY{n+nb}{print}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{product\PYZus{}type\PYZus{}name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{p}{)}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{} 91.62\PYZpc{} (167794/183138) of the products are shirts}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
count     183138
unique        72
top        SHIRT
freq      167794
Name: product\_type\_name, dtype: object

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}10}]:} \PY{c+c1}{\PYZsh{} names of different product types}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{product\PYZus{}type\PYZus{}name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
['SHIRT' 'SWEATER' 'APPAREL' 'OUTDOOR\_RECREATION\_PRODUCT'
 'BOOKS\_1973\_AND\_LATER' 'PANTS' 'HAT' 'SPORTING\_GOODS' 'DRESS' 'UNDERWEAR'
 'SKIRT' 'OUTERWEAR' 'BRA' 'ACCESSORY' 'ART\_SUPPLIES' 'SLEEPWEAR'
 'ORCA\_SHIRT' 'HANDBAG' 'PET\_SUPPLIES' 'SHOES' 'KITCHEN' 'ADULT\_COSTUME'
 'HOME\_BED\_AND\_BATH' 'MISC\_OTHER' 'BLAZER' 'HEALTH\_PERSONAL\_CARE'
 'TOYS\_AND\_GAMES' 'SWIMWEAR' 'CONSUMER\_ELECTRONICS' 'SHORTS' 'HOME'
 'AUTO\_PART' 'OFFICE\_PRODUCTS' 'ETHNIC\_WEAR' 'BEAUTY'
 'INSTRUMENT\_PARTS\_AND\_ACCESSORIES' 'POWERSPORTS\_PROTECTIVE\_GEAR' 'SHIRTS'
 'ABIS\_APPAREL' 'AUTO\_ACCESSORY' 'NONAPPARELMISC' 'TOOLS' 'BABY\_PRODUCT'
 'SOCKSHOSIERY' 'POWERSPORTS\_RIDING\_SHIRT' 'EYEWEAR' 'SUIT'
 'OUTDOOR\_LIVING' 'POWERSPORTS\_RIDING\_JACKET' 'HARDWARE' 'SAFETY\_SUPPLY'
 'ABIS\_DVD' 'VIDEO\_DVD' 'GOLF\_CLUB' 'MUSIC\_POPULAR\_VINYL'
 'HOME\_FURNITURE\_AND\_DECOR' 'TABLET\_COMPUTER' 'GUILD\_ACCESSORIES'
 'ABIS\_SPORTS' 'ART\_AND\_CRAFT\_SUPPLY' 'BAG' 'MECHANICAL\_COMPONENTS'
 'SOUND\_AND\_RECORDING\_EQUIPMENT' 'COMPUTER\_COMPONENT' 'JEWELRY'
 'BUILDING\_MATERIAL' 'LUGGAGE' 'BABY\_COSTUME' 'POWERSPORTS\_VEHICLE\_PART'
 'PROFESSIONAL\_HEALTHCARE' 'SEEDS\_AND\_PLANTS' 'WIRELESS\_ACCESSORY']

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}11}]:} \PY{c+c1}{\PYZsh{} find the 10 most frequent product\PYZus{}type\PYZus{}names.}
         \PY{n}{product\PYZus{}type\PYZus{}count} \PY{o}{=} \PY{n}{Counter}\PY{p}{(}\PY{n+nb}{list}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{product\PYZus{}type\PYZus{}name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}
         \PY{n}{product\PYZus{}type\PYZus{}count}\PY{o}{.}\PY{n}{most\PYZus{}common}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}11}]:} [('SHIRT', 167794),
          ('APPAREL', 3549),
          ('BOOKS\_1973\_AND\_LATER', 3336),
          ('DRESS', 1584),
          ('SPORTING\_GOODS', 1281),
          ('SWEATER', 837),
          ('OUTERWEAR', 796),
          ('OUTDOOR\_RECREATION\_PRODUCT', 729),
          ('ACCESSORY', 636),
          ('UNDERWEAR', 425)]
\end{Verbatim}
            
    \paragraph{Basic stats for the feature:
brand}\label{basic-stats-for-the-feature-brand}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}12}]:} \PY{n+nb}{print}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{brand}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{p}{)}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} 183138 \PYZhy{} 182987 = 151 missing values.}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
count     182987
unique     10577
top         Zago
freq         223
Name: brand, dtype: object

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}13}]:} \PY{n}{brand\PYZus{}count} \PY{o}{=} \PY{n}{Counter}\PY{p}{(}\PY{n+nb}{list}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{brand}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}
         \PY{n}{brand\PYZus{}count}\PY{o}{.}\PY{n}{most\PYZus{}common}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}13}]:} [('Zago', 223),
          ('XQS', 222),
          ('Yayun', 215),
          ('YUNY', 198),
          ('XiaoTianXin-women clothes', 193),
          ('Generic', 192),
          ('Boohoo', 190),
          ('Alion', 188),
          ('Abetteric', 187),
          ('TheMogan', 187)]
\end{Verbatim}
            
    \paragraph{Basic stats for the feature:
color}\label{basic-stats-for-the-feature-color}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}14}]:} \PY{n+nb}{print}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{color}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
count     64956
unique     7380
top       Black
freq      13207
Name: color, dtype: object

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}15}]:} \PY{n}{color\PYZus{}count} \PY{o}{=} \PY{n}{Counter}\PY{p}{(}\PY{n+nb}{list}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{color}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}
         \PY{n}{color\PYZus{}count}\PY{o}{.}\PY{n}{most\PYZus{}common}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}15}]:} [(None, 118182),
          ('Black', 13207),
          ('White', 8616),
          ('Blue', 3570),
          ('Red', 2289),
          ('Pink', 1842),
          ('Grey', 1499),
          ('*', 1388),
          ('Green', 1258),
          ('Multi', 1203)]
\end{Verbatim}
            
    \paragraph{Basic stats for the feature:
formatted\_price}\label{basic-stats-for-the-feature-formatted_price}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}16}]:}  \PY{n+nb}{print}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{formatted\PYZus{}price}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
count      28395
unique      3135
top       \$19.99
freq         945
Name: formatted\_price, dtype: object

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}17}]:} \PY{n}{price\PYZus{}count} \PY{o}{=} \PY{n}{Counter}\PY{p}{(}\PY{n+nb}{list}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{formatted\PYZus{}price}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}
         \PY{n}{price\PYZus{}count}\PY{o}{.}\PY{n}{most\PYZus{}common}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}17}]:} [(None, 154743),
          ('\$19.99', 945),
          ('\$9.99', 749),
          ('\$9.50', 601),
          ('\$14.99', 472),
          ('\$7.50', 463),
          ('\$24.99', 414),
          ('\$29.99', 370),
          ('\$8.99', 343),
          ('\$9.01', 336)]
\end{Verbatim}
            
    \paragraph{Basic stats for the feature:
title}\label{basic-stats-for-the-feature-title}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}18}]:} \PY{n+nb}{print}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{title}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
count                                                183138
unique                                               175985
top       Nakoda Cotton Self Print Straight Kurti For Women
freq                                                     77
Name: title, dtype: object

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}17}]:} \PY{n}{data}\PY{o}{.}\PY{n}{to\PYZus{}pickle}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pickels/180k\PYZus{}apparel\PYZus{}data}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    Basically Pickles are used to save the data and reuse them in further
process thereby reducing the total time taken. This results in
increasing efficiency of the program.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}18}]:} \PY{c+c1}{\PYZsh{} Removing the products that don\PYZsq{}t have price information.}
         \PY{n}{data} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{o}{\PYZti{}}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{formatted\PYZus{}price}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{isnull}\PY{p}{(}\PY{p}{)}\PY{p}{]}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Number of data points After eliminating price=NULL :}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{data}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Number of data points After eliminating price=NULL : 28395

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}19}]:} \PY{c+c1}{\PYZsh{} Removing the products that don\PYZsq{}t have color information.}
         \PY{n}{data} \PY{o}{=}\PY{n}{data}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{o}{\PYZti{}}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{color}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{isnull}\PY{p}{(}\PY{p}{)}\PY{p}{]}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Number of data points After eliminating color=NULL :}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{data}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Number of data points After eliminating color=NULL : 28385

    \end{Verbatim}

    \paragraph{We brought down the number of data points from 183K to
28K.}\label{we-brought-down-the-number-of-data-points-from-183k-to-28k.}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}20}]:} \PY{n}{data}\PY{o}{.}\PY{n}{to\PYZus{}pickle}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pickels/28k\PYZus{}apparel\PYZus{}data}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \subsubsection{Remove near duplicate
items}\label{remove-near-duplicate-items}

    \paragraph{Remove duplicates : Part 1}\label{remove-duplicates-part-1}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}17}]:} \PY{c+c1}{\PYZsh{} read data from pickle file from previous stage}
         \PY{n}{data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}pickle}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pickels/28k\PYZus{}apparel\PYZus{}data}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}18}]:} \PY{n}{data}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}18}]:}           asin                        brand              color  \textbackslash{}
         4   B004GSI2OS                  FeatherLite  Onyx Black/ Stone   
         6   B012YX2ZPI  HX-Kingdom Fashion T-shirts              White   
         11  B001LOUGE4                 Fitness Etc.              Black   
         15  B003BSRPB0                  FeatherLite              White   
         21  B014ICEDNA                        FNC7C             Purple   
         
                                              medium\_image\_url product\_type\_name  \textbackslash{}
         4   https://images-na.ssl-images-amazon.com/images{\ldots}             SHIRT   
         6   https://images-na.ssl-images-amazon.com/images{\ldots}             SHIRT   
         11  https://images-na.ssl-images-amazon.com/images{\ldots}             SHIRT   
         15  https://images-na.ssl-images-amazon.com/images{\ldots}             SHIRT   
         21  https://images-na.ssl-images-amazon.com/images{\ldots}             SHIRT   
         
                                                         title formatted\_price  
         4   Featherlite Ladies' Long Sleeve Stain Resistan{\ldots}          \$26.26  
         6   Women's Unique 100\% Cotton T - Special Olympic{\ldots}           \$9.99  
         11             Ladies Cotton Tank 2x1 Ribbed Tank Top          \$11.99  
         15  FeatherLite Ladies' Moisture Free Mesh Sport S{\ldots}          \$20.54  
         21  Supernatural Chibis Sam Dean And Castiel Short{\ldots}           \$7.50  
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}19}]:} \PY{c+c1}{\PYZsh{} Remove all products with very few words in title}
         \PY{n}{data\PYZus{}sorted} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{title}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{n+nb}{len}\PY{p}{(}\PY{n}{x}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{o}{\PYZgt{}}\PY{l+m+mi}{4}\PY{p}{)}\PY{p}{]}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{After removal of products with short description:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{data\PYZus{}sorted}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
After removal of products with short description: 27949

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}20}]:} \PY{c+c1}{\PYZsh{} Sort the whole data based on title  }
         \PY{n}{data\PYZus{}sorted}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{title}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{ascending}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
         \PY{n}{data\PYZus{}sorted}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}20}]:}               asin     brand        color  \textbackslash{}
         61973   B06Y1KZ2WB    Éclair   Black/Pink   
         133820  B010RV33VE  xiaoming         Pink   
         81461   B01DDSDLNS  xiaoming        White   
         75995   B00X5LYO9Y  xiaoming  Red Anchors   
         151570  B00WPJG35K  xiaoming        White   
         
                                                  medium\_image\_url product\_type\_name  \textbackslash{}
         61973   https://images-na.ssl-images-amazon.com/images{\ldots}             SHIRT   
         133820  https://images-na.ssl-images-amazon.com/images{\ldots}             SHIRT   
         81461   https://images-na.ssl-images-amazon.com/images{\ldots}             SHIRT   
         75995   https://images-na.ssl-images-amazon.com/images{\ldots}             SHIRT   
         151570  https://images-na.ssl-images-amazon.com/images{\ldots}             SHIRT   
         
                                                             title formatted\_price  
         61973   Éclair Women's Printed Thin Strap Blouse Black{\ldots}          \$24.99  
         133820  xiaoming Womens Sleeveless Loose Long T-shirts{\ldots}          \$18.19  
         81461   xiaoming Women's White Long Sleeve Single Brea{\ldots}          \$21.58  
         75995   xiaoming Stripes Tank Patch/Bear Sleeve Anchor{\ldots}          \$15.91  
         151570  xiaoming Sleeve Sheer Loose Tassel Kimono Woma{\ldots}          \$14.32  
\end{Verbatim}
            
    \paragraph{Some examples of duplicate titles that differ only in the
last few
words.}\label{some-examples-of-duplicate-titles-that-differ-only-in-the-last-few-words.}

    

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}21}]:} \PY{n}{indices} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{k}{for} \PY{n}{i}\PY{p}{,}\PY{n}{row} \PY{o+ow}{in} \PY{n}{data\PYZus{}sorted}\PY{o}{.}\PY{n}{iterrows}\PY{p}{(}\PY{p}{)}\PY{p}{:}
             \PY{n}{indices}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}22}]:} \PY{k+kn}{import} \PY{n+nn}{itertools}
         \PY{n}{stage1\PYZus{}dedupe\PYZus{}asins} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{i} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{j} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{num\PYZus{}data\PYZus{}points} \PY{o}{=} \PY{n}{data\PYZus{}sorted}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
         \PY{k}{while} \PY{n}{i} \PY{o}{\PYZlt{}} \PY{n}{num\PYZus{}data\PYZus{}points} \PY{o+ow}{and} \PY{n}{j} \PY{o}{\PYZlt{}} \PY{n}{num\PYZus{}data\PYZus{}points}\PY{p}{:}
             
             \PY{n}{previous\PYZus{}i} \PY{o}{=} \PY{n}{i}
         
             \PY{c+c1}{\PYZsh{} store the list of words of ith string in a, ex: a = [\PYZsq{}tokidoki\PYZsq{}, \PYZsq{}The\PYZsq{}, \PYZsq{}Queen\PYZsq{}, \PYZsq{}of\PYZsq{}, \PYZsq{}Diamonds\PYZsq{}, \PYZsq{}Women\PYZsq{}s\PYZsq{}, \PYZsq{}Shirt\PYZsq{}, \PYZsq{}X\PYZhy{}Large\PYZsq{}]}
             \PY{n}{a} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{title}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{indices}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{p}{)}
         
             \PY{c+c1}{\PYZsh{} search for the similar products sequentially }
             \PY{n}{j} \PY{o}{=} \PY{n}{i}\PY{o}{+}\PY{l+m+mi}{1}
             \PY{k}{while} \PY{n}{j} \PY{o}{\PYZlt{}} \PY{n}{num\PYZus{}data\PYZus{}points}\PY{p}{:}
         
                 \PY{c+c1}{\PYZsh{} store the list of words of jth string in b, ex: b = [\PYZsq{}tokidoki\PYZsq{}, \PYZsq{}The\PYZsq{}, \PYZsq{}Queen\PYZsq{}, \PYZsq{}of\PYZsq{}, \PYZsq{}Diamonds\PYZsq{}, \PYZsq{}Women\PYZsq{}s\PYZsq{}, \PYZsq{}Shirt\PYZsq{}, \PYZsq{}Small\PYZsq{}]}
                 \PY{n}{b} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{title}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{indices}\PY{p}{[}\PY{n}{j}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{p}{)}
         
                 \PY{c+c1}{\PYZsh{} store the maximum length of two strings}
                 \PY{n}{length} \PY{o}{=} \PY{n+nb}{max}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{a}\PY{p}{)}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{b}\PY{p}{)}\PY{p}{)}
         
                 \PY{c+c1}{\PYZsh{} count is used to store the number of words that are matched in both strings}
                 \PY{n}{count}  \PY{o}{=} \PY{l+m+mi}{0}
         
                 \PY{c+c1}{\PYZsh{} itertools.zip\PYZus{}longest(a,b): This will map the corresponding words in both strings, it will append None in case of unequal strings}
                 \PY{c+c1}{\PYZsh{} Example: a =[\PYZsq{}a\PYZsq{}, \PYZsq{}b\PYZsq{}, \PYZsq{}c\PYZsq{}, \PYZsq{}d\PYZsq{}]}
                 \PY{c+c1}{\PYZsh{} b = [\PYZsq{}a\PYZsq{}, \PYZsq{}b\PYZsq{}, \PYZsq{}d\PYZsq{}]}
                 \PY{c+c1}{\PYZsh{} itertools.zip\PYZus{}longest(a,b): will give [(\PYZsq{}a\PYZsq{},\PYZsq{}a\PYZsq{}), (\PYZsq{}b\PYZsq{},\PYZsq{}b\PYZsq{}), (\PYZsq{}c\PYZsq{},\PYZsq{}d\PYZsq{}), (\PYZsq{}d\PYZsq{}, None)]}
                 \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n}{itertools}\PY{o}{.}\PY{n}{zip\PYZus{}longest}\PY{p}{(}\PY{n}{a}\PY{p}{,}\PY{n}{b}\PY{p}{)}\PY{p}{:} 
                     \PY{k}{if} \PY{p}{(}\PY{n}{k}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{==} \PY{n}{k}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                         \PY{n}{count} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
         
                 \PY{c+c1}{\PYZsh{} If the number of words in which both strings differ are \PYZgt{} 2 , we are considering it as those two apperals are different}
                 \PY{c+c1}{\PYZsh{} If the number of words in which both strings differ are \PYZlt{} 2 , we are considering it as those two apperals are same, hence we are ignoring them}
                 \PY{k}{if} \PY{p}{(}\PY{n}{length} \PY{o}{\PYZhy{}} \PY{n}{count}\PY{p}{)} \PY{o}{\PYZgt{}} \PY{l+m+mi}{2}\PY{p}{:} \PY{c+c1}{\PYZsh{} number of words in which both sentences differ}
                     \PY{c+c1}{\PYZsh{} if both strings are differ by more than 2 words we include the 1st string index}
                     \PY{n}{stage1\PYZus{}dedupe\PYZus{}asins}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{data\PYZus{}sorted}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{asin}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{indices}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]}\PY{p}{)}
         
                     \PY{c+c1}{\PYZsh{} if the comparision between num\PYZus{}data\PYZus{}points, num\PYZus{}data\PYZus{}points\PYZhy{}1 strings and they differ in more than 2 words we include both}
                     \PY{k}{if} \PY{n}{j} \PY{o}{==} \PY{n}{num\PYZus{}data\PYZus{}points}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{:} \PY{n}{stage1\PYZus{}dedupe\PYZus{}asins}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{data\PYZus{}sorted}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{asin}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{indices}\PY{p}{[}\PY{n}{j}\PY{p}{]}\PY{p}{]}\PY{p}{)}
         
                     \PY{c+c1}{\PYZsh{} start searching for similar apperals corresponding 2nd string}
                     \PY{n}{i} \PY{o}{=} \PY{n}{j}
                     \PY{k}{break}
                 \PY{k}{else}\PY{p}{:}
                     \PY{n}{j} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
             \PY{k}{if} \PY{n}{previous\PYZus{}i} \PY{o}{==} \PY{n}{i}\PY{p}{:}
                 \PY{k}{break}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}29}]:} \PY{n}{data} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{asin}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{isin}\PY{p}{(}\PY{n}{stage1\PYZus{}dedupe\PYZus{}asins}\PY{p}{)}\PY{p}{]}
\end{Verbatim}


    \paragraph{We removed the dupliactes which differ only at the
end.}\label{we-removed-the-dupliactes-which-differ-only-at-the-end.}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}30}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Number of data points : }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{data}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Number of data points :  17593

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}31}]:} \PY{n}{data}\PY{o}{.}\PY{n}{to\PYZus{}pickle}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pickels/17k\PYZus{}apperal\PYZus{}data}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \paragraph{Remove duplicates : Part 2}\label{remove-duplicates-part-2}

    

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}32}]:} \PY{n}{data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}pickle}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pickels/17k\PYZus{}apperal\PYZus{}data}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}67}]:} \PY{c+c1}{\PYZsh{} This code snippet takes more time.O(n\PYZca{}2)}
         
         \PY{n}{indices} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{k}{for} \PY{n}{i}\PY{p}{,}\PY{n}{row} \PY{o+ow}{in} \PY{n}{data}\PY{o}{.}\PY{n}{iterrows}\PY{p}{(}\PY{p}{)}\PY{p}{:}
             \PY{n}{indices}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{)}
         
         \PY{n}{stage2\PYZus{}dedupe\PYZus{}asins} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{k}{while} \PY{n+nb}{len}\PY{p}{(}\PY{n}{indices}\PY{p}{)}\PY{o}{!=}\PY{l+m+mi}{0}\PY{p}{:}
             \PY{n}{i} \PY{o}{=} \PY{n}{indices}\PY{o}{.}\PY{n}{pop}\PY{p}{(}\PY{p}{)}
             \PY{n}{stage2\PYZus{}dedupe\PYZus{}asins}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{asin}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
             \PY{c+c1}{\PYZsh{} consider the first apperal\PYZsq{}s title}
             \PY{n}{a} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{title}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{p}{)}
             \PY{c+c1}{\PYZsh{} store the list of words of ith string in a, ex: a = [\PYZsq{}tokidoki\PYZsq{}, \PYZsq{}The\PYZsq{}, \PYZsq{}Queen\PYZsq{}, \PYZsq{}of\PYZsq{}, \PYZsq{}Diamonds\PYZsq{}, \PYZsq{}Women\PYZsq{}s\PYZsq{}, \PYZsq{}Shirt\PYZsq{}, \PYZsq{}X\PYZhy{}Large\PYZsq{}]}
             \PY{k}{for} \PY{n}{j} \PY{o+ow}{in} \PY{n}{indices}\PY{p}{:}
                 
                 \PY{n}{b} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{title}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{j}\PY{p}{]}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{p}{)}
                 \PY{c+c1}{\PYZsh{} store the list of words of jth string in b, ex: b = [\PYZsq{}tokidoki\PYZsq{}, \PYZsq{}The\PYZsq{}, \PYZsq{}Queen\PYZsq{}, \PYZsq{}of\PYZsq{}, \PYZsq{}Diamonds\PYZsq{}, \PYZsq{}Women\PYZsq{}s\PYZsq{}, \PYZsq{}Shirt\PYZsq{}, \PYZsq{}X\PYZhy{}Large\PYZsq{}]}
                 
                 \PY{n}{length} \PY{o}{=} \PY{n+nb}{max}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{a}\PY{p}{)}\PY{p}{,}\PY{n+nb}{len}\PY{p}{(}\PY{n}{a}\PY{p}{)}\PY{p}{)}
                 
                 \PY{c+c1}{\PYZsh{} count is used to store the number of words that are matched in both strings}
                 \PY{n}{count}  \PY{o}{=} \PY{l+m+mi}{0}
         
                 \PY{c+c1}{\PYZsh{} itertools.zip\PYZus{}longest(a,b): will map the corresponding words in both strings, it will appened None in case of unequal strings}
                 \PY{c+c1}{\PYZsh{} example: a =[\PYZsq{}a\PYZsq{}, \PYZsq{}b\PYZsq{}, \PYZsq{}c\PYZsq{}, \PYZsq{}d\PYZsq{}]}
                 \PY{c+c1}{\PYZsh{} b = [\PYZsq{}a\PYZsq{}, \PYZsq{}b\PYZsq{}, \PYZsq{}d\PYZsq{}]}
                 \PY{c+c1}{\PYZsh{} itertools.zip\PYZus{}longest(a,b): will give [(\PYZsq{}a\PYZsq{},\PYZsq{}a\PYZsq{}), (\PYZsq{}b\PYZsq{},\PYZsq{}b\PYZsq{}), (\PYZsq{}c\PYZsq{},\PYZsq{}d\PYZsq{}), (\PYZsq{}d\PYZsq{}, None)]}
                 \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n}{itertools}\PY{o}{.}\PY{n}{zip\PYZus{}longest}\PY{p}{(}\PY{n}{a}\PY{p}{,}\PY{n}{b}\PY{p}{)}\PY{p}{:} 
                     \PY{k}{if} \PY{p}{(}\PY{n}{k}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{==}\PY{n}{k}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                         \PY{n}{count} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
         
                 \PY{c+c1}{\PYZsh{} if the number of words in which both strings differ are \PYZlt{} 3 , we are considering it as those two apperals are same, hence we are ignoring them}
                 \PY{k}{if} \PY{p}{(}\PY{n}{length} \PY{o}{\PYZhy{}} \PY{n}{count}\PY{p}{)} \PY{o}{\PYZlt{}} \PY{l+m+mi}{3}\PY{p}{:}
                     \PY{n}{indices}\PY{o}{.}\PY{n}{remove}\PY{p}{(}\PY{n}{j}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]

        ---------------------------------------------------------------------------

        KeyboardInterrupt                         Traceback (most recent call last)

        <ipython-input-67-28de7efad93f> in <module>()
         19         \# store the list of words of jth string in b, ex: b = ['tokidoki', 'The', 'Queen', 'of', 'Diamonds', 'Women's', 'Shirt', 'X-Large']
         20 
    ---> 21         length = max(len(a),len(a))
         22 
         23         \# count is used to store the number of words that are matched in both strings
    

        KeyboardInterrupt: 

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}36}]:} \PY{c+c1}{\PYZsh{} from whole previous products we will consider only }
         \PY{c+c1}{\PYZsh{} the products that are found in previous cell }
         \PY{n}{data} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{asin}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{isin}\PY{p}{(}\PY{n}{stage2\PYZus{}dedupe\PYZus{}asins}\PY{p}{)}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]

        ---------------------------------------------------------------------------

        NameError                                 Traceback (most recent call last)

        <ipython-input-36-c232ba252b57> in <module>()
          1 \# from whole previous products we will consider only
          2 \# the products that are found in previous cell
    ----> 3 data = data.loc[data['asin'].isin(stage2\_dedupe\_asins)]
    

        NameError: name 'stage2\_dedupe\_asins' is not defined

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Number of data points after stage two of dedupe: }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{data}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
        \PY{c+c1}{\PYZsh{} from 17k apperals we reduced to 16k apperals}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}33}]:} \PY{n}{data}\PY{o}{.}\PY{n}{to\PYZus{}pickle}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pickels/16k\PYZus{}apperal\PYZus{}data}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} Storing these products in a pickle file}
         \PY{c+c1}{\PYZsh{} candidates who wants to download these files instead }
         \PY{c+c1}{\PYZsh{} of 180K they can download and use them from the Google Drive folder.}
\end{Verbatim}


    \section{Text pre-processing}\label{text-pre-processing}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}19}]:} \PY{n}{data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}pickle}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pickels/16k\PYZus{}apperal\PYZus{}data}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}20}]:} \PY{c+c1}{\PYZsh{} we use the list of stop words that are downloaded from nltk lib.}
         \PY{n}{stop\PYZus{}words} \PY{o}{=} \PY{n+nb}{set}\PY{p}{(}\PY{n}{stopwords}\PY{o}{.}\PY{n}{words}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{english}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print} \PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{list of stop words:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{stop\PYZus{}words}\PY{p}{)}
         
         \PY{k}{def} \PY{n+nf}{nlp\PYZus{}preprocessing}\PY{p}{(}\PY{n}{total\PYZus{}text}\PY{p}{,} \PY{n}{index}\PY{p}{,} \PY{n}{column}\PY{p}{)}\PY{p}{:}
             \PY{k}{if} \PY{n+nb}{type}\PY{p}{(}\PY{n}{total\PYZus{}text}\PY{p}{)} \PY{o+ow}{is} \PY{o+ow}{not} \PY{n+nb}{int}\PY{p}{:}
                 \PY{n}{string} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdq{}}
                 \PY{k}{for} \PY{n}{words} \PY{o+ow}{in} \PY{n}{total\PYZus{}text}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{p}{)}\PY{p}{:}
                     \PY{c+c1}{\PYZsh{} removing special chars like \PYZsq{}\PYZdq{}\PYZsh{}\PYZdl{}@!\PYZpc{}\PYZca{}\PYZam{}*()\PYZus{}+\PYZhy{}\PYZti{}?\PYZgt{}\PYZlt{} .}
                     \PY{n}{word} \PY{o}{=} \PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{e} \PY{k}{for} \PY{n}{e} \PY{o+ow}{in} \PY{n}{words} \PY{k}{if} \PY{n}{e}\PY{o}{.}\PY{n}{isalnum}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{)}
                     \PY{c+c1}{\PYZsh{} Conver all letters to lower\PYZhy{}case}
                     \PY{n}{word} \PY{o}{=} \PY{n}{word}\PY{o}{.}\PY{n}{lower}\PY{p}{(}\PY{p}{)}
                     \PY{c+c1}{\PYZsh{} stop\PYZhy{}word removal}
                     \PY{k}{if} \PY{o+ow}{not} \PY{n}{word} \PY{o+ow}{in} \PY{n}{stop\PYZus{}words}\PY{p}{:}
                         \PY{n}{string} \PY{o}{+}\PY{o}{=} \PY{n}{word} \PY{o}{+} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ }\PY{l+s+s2}{\PYZdq{}}
                 \PY{n}{data}\PY{p}{[}\PY{n}{column}\PY{p}{]}\PY{p}{[}\PY{n}{index}\PY{p}{]} \PY{o}{=} \PY{n}{string}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
list of stop words: \{'do', 'both', 'isn', 'you', "you've", 'while', 'by', "it's", 'through', 'its', 'for', 'then', 'is', "wouldn't", 'there', 'll', "shouldn't", "aren't", 'into', 'couldn', 'or', 'them', 'down', "that'll", "don't", 'didn', 'wasn', "won't", 'of', 'than', "didn't", 'these', 'at', 'are', 'how', 'yourself', 'been', 'few', 'very', 'm', 'all', "mustn't", 'ourselves', 'have', 'again', 'with', 'they', "hadn't", 'up', 'when', 'some', 'don', 'o', 'ain', 'ma', "isn't", 'any', 'above', 't', 'mightn', 'now', "couldn't", 'were', "weren't", 'why', 'where', "should've", 'aren', 'doesn', 'won', 'who', 'needn', 'but', "mightn't", 'as', 'not', "hasn't", 'does', 'just', 'him', 'out', 'it', 'theirs', "doesn't", 'he', 'should', 'yourselves', 'having', 'too', 'myself', 'an', 'during', 'which', 'yours', 'this', 'wouldn', 'once', 'no', 'more', 'such', 'so', 'other', 'to', 'i', 'before', 'here', 'herself', 'under', 'over', "needn't", 'be', 'd', 'was', 'himself', 'hadn', 'between', 'and', "you're", 'the', 'itself', 'hers', 'in', 'his', 'had', 'further', 'what', 'nor', 'am', 'on', 'your', 'most', 'can', 're', 'weren', 'did', "wasn't", "haven't", 'will', 'if', "shan't", 'below', 'mustn', 'whom', 'y', 'only', 'themselves', 'hasn', 'shan', 'doing', 'own', 's', 'me', 'same', "you'd", 'each', 'from', 'haven', 'we', 've', 'because', 'against', 'has', 'being', 'those', 'our', 'her', 'shouldn', 'about', 'off', 'ours', 'their', 'a', "you'll", 'after', 'my', "she's", 'that', 'until', 'she'\}

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}21}]:} \PY{n}{start\PYZus{}time} \PY{o}{=} \PY{n}{time}\PY{o}{.}\PY{n}{clock}\PY{p}{(}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} we take each title and we text\PYZhy{}preprocess it.}
         \PY{k}{for} \PY{n}{index}\PY{p}{,} \PY{n}{row} \PY{o+ow}{in} \PY{n}{data}\PY{o}{.}\PY{n}{iterrows}\PY{p}{(}\PY{p}{)}\PY{p}{:}
             \PY{n}{nlp\PYZus{}preprocessing}\PY{p}{(}\PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{title}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{index}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{title}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} we print the time it took to preprocess whole titles }
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{time}\PY{o}{.}\PY{n}{clock}\PY{p}{(}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{n}{start\PYZus{}time}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{seconds}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
4.5266462 seconds

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}26}]:} \PY{n}{data}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}26}]:}           asin                        brand              color  \textbackslash{}
         4   B004GSI2OS                  FeatherLite  Onyx Black/ Stone   
         6   B012YX2ZPI  HX-Kingdom Fashion T-shirts              White   
         15  B003BSRPB0                  FeatherLite              White   
         27  B014ICEJ1Q                        FNC7C             Purple   
         46  B01NACPBG2                 Fifth Degree              Black   
         
                                              medium\_image\_url product\_type\_name  \textbackslash{}
         4   https://images-na.ssl-images-amazon.com/images{\ldots}             SHIRT   
         6   https://images-na.ssl-images-amazon.com/images{\ldots}             SHIRT   
         15  https://images-na.ssl-images-amazon.com/images{\ldots}             SHIRT   
         27  https://images-na.ssl-images-amazon.com/images{\ldots}             SHIRT   
         46  https://images-na.ssl-images-amazon.com/images{\ldots}             SHIRT   
         
                                                         title formatted\_price  
         4   featherlite ladies long sleeve stain resistant{\ldots}          \$26.26  
         6   womens unique 100 cotton  special olympics wor{\ldots}           \$9.99  
         15  featherlite ladies moisture free mesh sport sh{\ldots}          \$20.54  
         27  supernatural chibis sam dean castiel neck tshi{\ldots}           \$7.39  
         46  fifth degree womens gold foil graphic tees jun{\ldots}           \$6.95  
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}38}]:} \PY{n}{data}\PY{o}{.}\PY{n}{to\PYZus{}pickle}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pickels/16k\PYZus{}apperal\PYZus{}data\PYZus{}preprocessed}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \subsection{Stemming}\label{stemming}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}27}]:} \PY{k+kn}{from} \PY{n+nn}{nltk}\PY{n+nn}{.}\PY{n+nn}{stem}\PY{n+nn}{.}\PY{n+nn}{porter} \PY{k}{import} \PY{o}{*}
         \PY{n}{stemmer} \PY{o}{=} \PY{n}{PorterStemmer}\PY{p}{(}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{stemmer}\PY{o}{.}\PY{n}{stem}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{arguing}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{stemmer}\PY{o}{.}\PY{n}{stem}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{fishing}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
argu
fish

    \end{Verbatim}

    \section{Text based product
similarity}\label{text-based-product-similarity}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}5}]:} \PY{n}{data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}pickle}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pickels/16k\PYZus{}apperal\PYZus{}data\PYZus{}preprocessed}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{data}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}5}]:}           asin                        brand              color  \textbackslash{}
        4   B004GSI2OS                  FeatherLite  Onyx Black/ Stone   
        6   B012YX2ZPI  HX-Kingdom Fashion T-shirts              White   
        15  B003BSRPB0                  FeatherLite              White   
        27  B014ICEJ1Q                        FNC7C             Purple   
        46  B01NACPBG2                 Fifth Degree              Black   
        
                                             medium\_image\_url product\_type\_name  \textbackslash{}
        4   https://images-na.ssl-images-amazon.com/images{\ldots}             SHIRT   
        6   https://images-na.ssl-images-amazon.com/images{\ldots}             SHIRT   
        15  https://images-na.ssl-images-amazon.com/images{\ldots}             SHIRT   
        27  https://images-na.ssl-images-amazon.com/images{\ldots}             SHIRT   
        46  https://images-na.ssl-images-amazon.com/images{\ldots}             SHIRT   
        
                                                        title formatted\_price  
        4   featherlite ladies long sleeve stain resistant{\ldots}          \$26.26  
        6   womens unique 100 cotton  special olympics wor{\ldots}           \$9.99  
        15  featherlite ladies moisture free mesh sport sh{\ldots}          \$20.54  
        27  supernatural chibis sam dean castiel neck tshi{\ldots}           \$7.39  
        46  fifth degree womens gold foil graphic tees jun{\ldots}           \$6.95  
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}50}]:} \PY{n}{data}\PY{o}{.}\PY{n}{to\PYZus{}csv}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{16k.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}6}]:} \PY{c+c1}{\PYZsh{}Utility functions that will be used in upcoming code snippets.}
        
        \PY{c+c1}{\PYZsh{}Display an image}
        \PY{k}{def} \PY{n+nf}{display\PYZus{}img}\PY{p}{(}\PY{n}{url}\PY{p}{,}\PY{n}{ax}\PY{p}{,}\PY{n}{fig}\PY{p}{)}\PY{p}{:}
            \PY{c+c1}{\PYZsh{} we get the url of the apparel and download it}
            \PY{n}{response} \PY{o}{=} \PY{n}{requests}\PY{o}{.}\PY{n}{get}\PY{p}{(}\PY{n}{url}\PY{p}{)}
            \PY{n}{img} \PY{o}{=} \PY{n}{Image}\PY{o}{.}\PY{n}{open}\PY{p}{(}\PY{n}{BytesIO}\PY{p}{(}\PY{n}{response}\PY{o}{.}\PY{n}{content}\PY{p}{)}\PY{p}{)}
            \PY{c+c1}{\PYZsh{} we will display it in notebook }
            \PY{n}{plt}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{img}\PY{p}{)}
          
        \PY{c+c1}{\PYZsh{}plotting code to understand the algorithm\PYZsq{}s decision.}
        
        \PY{k}{def} \PY{n+nf}{plot\PYZus{}heatmap}\PY{p}{(}\PY{n}{keys}\PY{p}{,} \PY{n}{values}\PY{p}{,} \PY{n}{labels}\PY{p}{,} \PY{n}{url}\PY{p}{,} \PY{n}{text}\PY{p}{)}\PY{p}{:}
                \PY{c+c1}{\PYZsh{} keys: list of words of recommended title}
                \PY{c+c1}{\PYZsh{} values: len(values) ==  len(keys), values(i) represents the occurence of the word keys(i)}
                \PY{c+c1}{\PYZsh{} labels: len(labels) == len(keys), the values of labels depends on the model we are using}
                        \PY{c+c1}{\PYZsh{} if model == \PYZsq{}bag of words\PYZsq{}: labels(i) = values(i)}
                        \PY{c+c1}{\PYZsh{} if model == \PYZsq{}tfidf weighted bag of words\PYZsq{}:labels(i) = tfidf(keys(i))}
                        \PY{c+c1}{\PYZsh{} if model == \PYZsq{}idf weighted bag of words\PYZsq{}:labels(i) = idf(keys(i))}
                \PY{c+c1}{\PYZsh{} url : apparel\PYZsq{}s url}
                \PY{c+c1}{\PYZsh{} we will divide the whole figure into two parts}
                \PY{n}{gs} \PY{o}{=} \PY{n}{gridspec}\PY{o}{.}\PY{n}{GridSpec}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{,} \PY{n}{width\PYZus{}ratios}\PY{o}{=}\PY{p}{[}\PY{l+m+mi}{4}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{height\PYZus{}ratios}\PY{o}{=}\PY{p}{[}\PY{l+m+mi}{4}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)} 
                \PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{25}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{)}\PY{p}{)}
                
                \PY{c+c1}{\PYZsh{} 1st, ploting heat map that represents the count of commonly ocurred words in title2}
                \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{n}{gs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
                \PY{c+c1}{\PYZsh{} it displays a cell in white color if the word is intersection(list of words of title1 and list of words of title2), in black if not}
                \PY{n}{ax} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{heatmap}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{n}{values}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n}{annot}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{n}{labels}\PY{p}{]}\PY{p}{)}\PY{p}{)}
                \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xticklabels}\PY{p}{(}\PY{n}{keys}\PY{p}{)} \PY{c+c1}{\PYZsh{} set that axis labels as the words of title}
                \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{n}{text}\PY{p}{)} \PY{c+c1}{\PYZsh{} apparel title}
                
                \PY{c+c1}{\PYZsh{} 2nd, plotting image of the the apparel}
                \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{n}{gs}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
                \PY{c+c1}{\PYZsh{} we don\PYZsq{}t want any grid lines for image and no labels on x\PYZhy{}axis and y\PYZhy{}axis}
                \PY{n}{ax}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{k+kc}{False}\PY{p}{)}
                \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xticks}\PY{p}{(}\PY{p}{[}\PY{p}{]}\PY{p}{)}
                \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}yticks}\PY{p}{(}\PY{p}{[}\PY{p}{]}\PY{p}{)}
                
                \PY{c+c1}{\PYZsh{} we call dispaly\PYZus{}img based with paramete url}
                \PY{n}{display\PYZus{}img}\PY{p}{(}\PY{n}{url}\PY{p}{,} \PY{n}{ax}\PY{p}{,} \PY{n}{fig}\PY{p}{)}
                
                \PY{c+c1}{\PYZsh{} displays combine figure ( heat map and image together)}
                \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
            
        \PY{k}{def} \PY{n+nf}{plot\PYZus{}heatmap\PYZus{}image}\PY{p}{(}\PY{n}{doc\PYZus{}id}\PY{p}{,} \PY{n}{vec1}\PY{p}{,} \PY{n}{vec2}\PY{p}{,} \PY{n}{url}\PY{p}{,} \PY{n}{text}\PY{p}{,} \PY{n}{model}\PY{p}{)}\PY{p}{:}
        
            \PY{c+c1}{\PYZsh{} doc\PYZus{}id : index of the title1}
            \PY{c+c1}{\PYZsh{} vec1 : input apparels\PYZsq{}s vector, it is of a dict type \PYZob{}word:count\PYZcb{}}
            \PY{c+c1}{\PYZsh{} vec2 : recommended apparels\PYZsq{}s vector, it is of a dict type \PYZob{}word:count\PYZcb{}}
            \PY{c+c1}{\PYZsh{} url : apparels image url}
            \PY{c+c1}{\PYZsh{} text: title of recomonded apparel (used to keep title of image)}
            \PY{c+c1}{\PYZsh{} model, it can be any of the models, }
                \PY{c+c1}{\PYZsh{} 1. bag\PYZus{}of\PYZus{}words}
                \PY{c+c1}{\PYZsh{} 2. tfidf}
                \PY{c+c1}{\PYZsh{} 3. idf}
        
            \PY{c+c1}{\PYZsh{} we find the common words in both titles, because these only words contribute to the distance between two title vec\PYZsq{}s}
            \PY{n}{intersection} \PY{o}{=} \PY{n+nb}{set}\PY{p}{(}\PY{n}{vec1}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{)} \PY{o}{\PYZam{}} \PY{n+nb}{set}\PY{p}{(}\PY{n}{vec2}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{)} 
        
            \PY{c+c1}{\PYZsh{} we set the values of non intersecting words to zero, this is just to show the difference in heatmap}
            \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{vec2}\PY{p}{:}
                \PY{k}{if} \PY{n}{i} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{intersection}\PY{p}{:}
                    \PY{n}{vec2}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{=}\PY{l+m+mi}{0}
        
            \PY{c+c1}{\PYZsh{} for labeling heatmap, keys contains list of all words in title2}
            \PY{n}{keys} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n}{vec2}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{)}
            \PY{c+c1}{\PYZsh{}  if ith word in intersection(lis of words of title1 and list of words of title2): values(i)=count of that word in title2 else values(i)=0 }
            \PY{n}{values} \PY{o}{=} \PY{p}{[}\PY{n}{vec2}\PY{p}{[}\PY{n}{x}\PY{p}{]} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{vec2}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{]}
            
            \PY{c+c1}{\PYZsh{} labels: len(labels) == len(keys), the values of labels depends on the model we are using}
                \PY{c+c1}{\PYZsh{} if model == \PYZsq{}bag of words\PYZsq{}: labels(i) = values(i)}
                \PY{c+c1}{\PYZsh{} if model == \PYZsq{}tfidf weighted bag of words\PYZsq{}:labels(i) = tfidf(keys(i))}
                \PY{c+c1}{\PYZsh{} if model == \PYZsq{}idf weighted bag of words\PYZsq{}:labels(i) = idf(keys(i))}
        
            \PY{k}{if} \PY{n}{model} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bag\PYZus{}of\PYZus{}words}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                \PY{n}{labels} \PY{o}{=} \PY{n}{values}
            \PY{k}{elif} \PY{n}{model} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tfidf}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                \PY{n}{labels} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{vec2}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{:}
                    \PY{c+c1}{\PYZsh{} tfidf\PYZus{}title\PYZus{}vectorizer.vocabulary\PYZus{} it contains all the words in the corpus}
                    \PY{c+c1}{\PYZsh{} tfidf\PYZus{}title\PYZus{}features[doc\PYZus{}id, index\PYZus{}of\PYZus{}word\PYZus{}in\PYZus{}corpus] will give the tfidf value of word in given document (doc\PYZus{}id)}
                    \PY{k}{if} \PY{n}{x} \PY{o+ow}{in}  \PY{n}{tfidf\PYZus{}title\PYZus{}vectorizer}\PY{o}{.}\PY{n}{vocabulary\PYZus{}}\PY{p}{:}
                        \PY{n}{labels}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{tfidf\PYZus{}title\PYZus{}features}\PY{p}{[}\PY{n}{doc\PYZus{}id}\PY{p}{,} \PY{n}{tfidf\PYZus{}title\PYZus{}vectorizer}\PY{o}{.}\PY{n}{vocabulary\PYZus{}}\PY{p}{[}\PY{n}{x}\PY{p}{]}\PY{p}{]}\PY{p}{)}
                    \PY{k}{else}\PY{p}{:}
                        \PY{n}{labels}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}
            \PY{k}{elif} \PY{n}{model} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{idf}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                \PY{n}{labels} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{vec2}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{:}
                    \PY{c+c1}{\PYZsh{} idf\PYZus{}title\PYZus{}vectorizer.vocabulary\PYZus{} it contains all the words in the corpus}
                    \PY{c+c1}{\PYZsh{} idf\PYZus{}title\PYZus{}features[doc\PYZus{}id, index\PYZus{}of\PYZus{}word\PYZus{}in\PYZus{}corpus] will give the idf value of word in given document (doc\PYZus{}id)}
                    \PY{k}{if} \PY{n}{x} \PY{o+ow}{in}  \PY{n}{idf\PYZus{}title\PYZus{}vectorizer}\PY{o}{.}\PY{n}{vocabulary\PYZus{}}\PY{p}{:}
                        \PY{n}{labels}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{idf\PYZus{}title\PYZus{}features}\PY{p}{[}\PY{n}{doc\PYZus{}id}\PY{p}{,} \PY{n}{idf\PYZus{}title\PYZus{}vectorizer}\PY{o}{.}\PY{n}{vocabulary\PYZus{}}\PY{p}{[}\PY{n}{x}\PY{p}{]}\PY{p}{]}\PY{p}{)}
                    \PY{k}{else}\PY{p}{:}
                        \PY{n}{labels}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}
        
            \PY{n}{plot\PYZus{}heatmap}\PY{p}{(}\PY{n}{keys}\PY{p}{,} \PY{n}{values}\PY{p}{,} \PY{n}{labels}\PY{p}{,} \PY{n}{url}\PY{p}{,} \PY{n}{text}\PY{p}{)}
        
        
        \PY{c+c1}{\PYZsh{} This function gets a list of words along with the frequency of each }
        \PY{c+c1}{\PYZsh{} word given \PYZdq{}text\PYZdq{}}
        \PY{k}{def} \PY{n+nf}{text\PYZus{}to\PYZus{}vector}\PY{p}{(}\PY{n}{text}\PY{p}{)}\PY{p}{:}
            \PY{n}{word} \PY{o}{=} \PY{n}{re}\PY{o}{.}\PY{n}{compile}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{w+}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
            \PY{n}{words} \PY{o}{=} \PY{n}{word}\PY{o}{.}\PY{n}{findall}\PY{p}{(}\PY{n}{text}\PY{p}{)}\PY{c+c1}{\PYZsh{} splits all words}
            \PY{k}{return} \PY{n}{Counter}\PY{p}{(}\PY{n}{words}\PY{p}{)} \PY{c+c1}{\PYZsh{} Counter counts the occurence of each word in list, it returns dict type object \PYZob{}word1:count\PYZcb{}}
        
        
        
        \PY{k}{def} \PY{n+nf}{get\PYZus{}result}\PY{p}{(}\PY{n}{doc\PYZus{}id}\PY{p}{,} \PY{n}{content\PYZus{}a}\PY{p}{,} \PY{n}{content\PYZus{}b}\PY{p}{,} \PY{n}{url}\PY{p}{,} \PY{n}{model}\PY{p}{)}\PY{p}{:}
            \PY{n}{text1} \PY{o}{=} \PY{n}{content\PYZus{}a}
            \PY{n}{text2} \PY{o}{=} \PY{n}{content\PYZus{}b}
            
            \PY{c+c1}{\PYZsh{} vector1 = dict\PYZob{}word11:\PYZsh{}count, word12:\PYZsh{}count, etc.\PYZcb{}}
            \PY{n}{vector1} \PY{o}{=} \PY{n}{text\PYZus{}to\PYZus{}vector}\PY{p}{(}\PY{n}{text1}\PY{p}{)}
        
            \PY{c+c1}{\PYZsh{} vector1 = dict\PYZob{}word21:\PYZsh{}count, word22:\PYZsh{}count, etc.\PYZcb{}}
            \PY{n}{vector2} \PY{o}{=} \PY{n}{text\PYZus{}to\PYZus{}vector}\PY{p}{(}\PY{n}{text2}\PY{p}{)}
        
            \PY{n}{plot\PYZus{}heatmap\PYZus{}image}\PY{p}{(}\PY{n}{doc\PYZus{}id}\PY{p}{,} \PY{n}{vector1}\PY{p}{,} \PY{n}{vector2}\PY{p}{,} \PY{n}{url}\PY{p}{,} \PY{n}{text2}\PY{p}{,} \PY{n}{model}\PY{p}{)}
\end{Verbatim}


    \subsection{{[}8.2{]} Bag of Words (BoW) on product
titles.}\label{bag-of-words-bow-on-product-titles.}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}7}]:} \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{feature\PYZus{}extraction}\PY{n+nn}{.}\PY{n+nn}{text} \PY{k}{import} \PY{n}{CountVectorizer}
        \PY{n}{title\PYZus{}vectorizer} \PY{o}{=} \PY{n}{CountVectorizer}\PY{p}{(}\PY{p}{)}
        \PY{n}{title\PYZus{}features}   \PY{o}{=} \PY{n}{title\PYZus{}vectorizer}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{title}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
        \PY{n}{title\PYZus{}features}\PY{o}{.}\PY{n}{get\PYZus{}shape}\PY{p}{(}\PY{p}{)} \PY{c+c1}{\PYZsh{} get number of rows and columns in feature matrix.}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}7}]:} (16042, 12609)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}8}]:} \PY{k}{def} \PY{n+nf}{bag\PYZus{}of\PYZus{}words\PYZus{}model}\PY{p}{(}\PY{n}{doc\PYZus{}id}\PY{p}{,} \PY{n}{num\PYZus{}results}\PY{p}{)}\PY{p}{:}
            \PY{c+c1}{\PYZsh{} doc\PYZus{}id: apparel\PYZsq{}s id in given corpus}
            
            \PY{c+c1}{\PYZsh{} pairwise\PYZus{}dist with cosine similarity}
            \PY{n}{pairwise\PYZus{}dist} \PY{o}{=} \PY{n}{pairwise\PYZus{}distances}\PY{p}{(}\PY{n}{title\PYZus{}features}\PY{p}{,}\PY{n}{title\PYZus{}features}\PY{p}{[}\PY{n}{doc\PYZus{}id}\PY{p}{]}\PY{p}{)}
            
            \PY{c+c1}{\PYZsh{} np.argsort will return indices of the smallest distances}
            \PY{n}{indices} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{argsort}\PY{p}{(}\PY{n}{pairwise\PYZus{}dist}\PY{o}{.}\PY{n}{flatten}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{num\PYZus{}results}\PY{p}{]}
            \PY{c+c1}{\PYZsh{}pdists will store the smallest distances}
            \PY{n}{pdists}  \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sort}\PY{p}{(}\PY{n}{pairwise\PYZus{}dist}\PY{o}{.}\PY{n}{flatten}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{num\PYZus{}results}\PY{p}{]}
            \PY{n}{df\PYZus{}indices} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n}{data}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{n}{indices}\PY{p}{]}\PY{p}{)}
            
            \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{n+nb}{len}\PY{p}{(}\PY{n}{indices}\PY{p}{)}\PY{p}{)}\PY{p}{:}
                \PY{c+c1}{\PYZsh{} we will pass 1. doc\PYZus{}id, 2. title1, 3. title2, url, model}
                \PY{n}{get\PYZus{}result}\PY{p}{(}\PY{n}{indices}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{,}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{title}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{df\PYZus{}indices}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{title}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{df\PYZus{}indices}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{medium\PYZus{}image\PYZus{}url}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{df\PYZus{}indices}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bag\PYZus{}of\PYZus{}words}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ASIN :}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{asin}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{df\PYZus{}indices}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]}\PY{p}{)}
                \PY{n+nb}{print} \PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Brand:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{brand}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{df\PYZus{}indices}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]}\PY{p}{)}
                \PY{n+nb}{print} \PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Title:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{title}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{df\PYZus{}indices}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]}\PY{p}{)}
                \PY{n+nb}{print} \PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Euclidean similarity with the query image :}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{pdists}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
                \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{=}\PY{l+s+s1}{\PYZsq{}}\PY{o}{*}\PY{l+m+mi}{60}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{}call the bag\PYZhy{}of\PYZhy{}words model for a product to get similar products.}
        \PY{n}{bag\PYZus{}of\PYZus{}words\PYZus{}model}\PY{p}{(}\PY{l+m+mi}{12566}\PY{p}{,} \PY{l+m+mi}{20}\PY{p}{)} \PY{c+c1}{\PYZsh{} change the index if you want to.}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_65_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00JXQB5FQ
Brand: Si Row
Title: burnt umber tiger tshirt zebra stripes xl  xxl 
Euclidean similarity with the query image : 0.0
============================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_65_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00JXQASS6
Brand: Si Row
Title: pink tiger tshirt zebra stripes xl  xxl 
Euclidean similarity with the query image : 1.7320508075688772
============================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_65_4.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00JXQCWTO
Brand: Si Row
Title: brown  white tiger tshirt tiger stripes xl  xxl 
Euclidean similarity with the query image : 2.449489742783178
============================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_65_6.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00JXQCUIC
Brand: Si Row
Title: yellow tiger tshirt tiger stripes  l 
Euclidean similarity with the query image : 2.6457513110645907
============================================================

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]

        ---------------------------------------------------------------------------

        OSError                                   Traceback (most recent call last)

        \textasciitilde{}\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}urllib3\textbackslash{}connectionpool.py in urlopen(self, method, url, body, headers, retries, redirect, assert\_same\_host, timeout, pool\_timeout, release\_conn, chunked, body\_pos, **response\_kw)
        600                                                   body=body, headers=headers,
    --> 601                                                   chunked=chunked)
        602 
    

        \textasciitilde{}\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}urllib3\textbackslash{}connectionpool.py in \_make\_request(self, conn, method, url, timeout, chunked, **httplib\_request\_kw)
        386                     \# otherwise it looks like a programming error was the cause.
    --> 387                     six.raise\_from(e, None)
        388         except (SocketTimeout, BaseSSLError, SocketError) as e:
    

        \textasciitilde{}\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}urllib3\textbackslash{}packages\textbackslash{}six.py in raise\_from(value, from\_value)
    

        \textasciitilde{}\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}urllib3\textbackslash{}connectionpool.py in \_make\_request(self, conn, method, url, timeout, chunked, **httplib\_request\_kw)
        382                 try:
    --> 383                     httplib\_response = conn.getresponse()
        384                 except Exception as e:
    

        \textasciitilde{}\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}http\textbackslash{}client.py in getresponse(self)
       1330             try:
    -> 1331                 response.begin()
       1332             except ConnectionError:
    

        \textasciitilde{}\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}http\textbackslash{}client.py in begin(self)
        296         while True:
    --> 297             version, status, reason = self.\_read\_status()
        298             if status != CONTINUE:
    

        \textasciitilde{}\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}http\textbackslash{}client.py in \_read\_status(self)
        257     def \_read\_status(self):
    --> 258         line = str(self.fp.readline(\_MAXLINE + 1), "iso-8859-1")
        259         if len(line) > \_MAXLINE:
    

        \textasciitilde{}\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}socket.py in readinto(self, b)
        585             try:
    --> 586                 return self.\_sock.recv\_into(b)
        587             except timeout:
    

        \textasciitilde{}\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}urllib3\textbackslash{}contrib\textbackslash{}pyopenssl.py in recv\_into(self, *args, **kwargs)
        284             else:
    --> 285                 raise SocketError(str(e))
        286         except OpenSSL.SSL.ZeroReturnError as e:
    

        OSError: (10054, 'WSAECONNRESET')

        
    During handling of the above exception, another exception occurred:
    

        ProtocolError                             Traceback (most recent call last)

        \textasciitilde{}\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}requests\textbackslash{}adapters.py in send(self, request, stream, timeout, verify, cert, proxies)
        439                     retries=self.max\_retries,
    --> 440                     timeout=timeout
        441                 )
    

        \textasciitilde{}\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}urllib3\textbackslash{}connectionpool.py in urlopen(self, method, url, body, headers, retries, redirect, assert\_same\_host, timeout, pool\_timeout, release\_conn, chunked, body\_pos, **response\_kw)
        638             retries = retries.increment(method, url, error=e, \_pool=self,
    --> 639                                         \_stacktrace=sys.exc\_info()[2])
        640             retries.sleep()
    

        \textasciitilde{}\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}urllib3\textbackslash{}util\textbackslash{}retry.py in increment(self, method, url, response, error, \_pool, \_stacktrace)
        356             if read is False or not self.\_is\_method\_retryable(method):
    --> 357                 raise six.reraise(type(error), error, \_stacktrace)
        358             elif read is not None:
    

        \textasciitilde{}\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}urllib3\textbackslash{}packages\textbackslash{}six.py in reraise(tp, value, tb)
        684         if value.\_\_traceback\_\_ is not tb:
    --> 685             raise value.with\_traceback(tb)
        686         raise value
    

        \textasciitilde{}\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}urllib3\textbackslash{}connectionpool.py in urlopen(self, method, url, body, headers, retries, redirect, assert\_same\_host, timeout, pool\_timeout, release\_conn, chunked, body\_pos, **response\_kw)
        600                                                   body=body, headers=headers,
    --> 601                                                   chunked=chunked)
        602 
    

        \textasciitilde{}\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}urllib3\textbackslash{}connectionpool.py in \_make\_request(self, conn, method, url, timeout, chunked, **httplib\_request\_kw)
        386                     \# otherwise it looks like a programming error was the cause.
    --> 387                     six.raise\_from(e, None)
        388         except (SocketTimeout, BaseSSLError, SocketError) as e:
    

        \textasciitilde{}\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}urllib3\textbackslash{}packages\textbackslash{}six.py in raise\_from(value, from\_value)
    

        \textasciitilde{}\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}urllib3\textbackslash{}connectionpool.py in \_make\_request(self, conn, method, url, timeout, chunked, **httplib\_request\_kw)
        382                 try:
    --> 383                     httplib\_response = conn.getresponse()
        384                 except Exception as e:
    

        \textasciitilde{}\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}http\textbackslash{}client.py in getresponse(self)
       1330             try:
    -> 1331                 response.begin()
       1332             except ConnectionError:
    

        \textasciitilde{}\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}http\textbackslash{}client.py in begin(self)
        296         while True:
    --> 297             version, status, reason = self.\_read\_status()
        298             if status != CONTINUE:
    

        \textasciitilde{}\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}http\textbackslash{}client.py in \_read\_status(self)
        257     def \_read\_status(self):
    --> 258         line = str(self.fp.readline(\_MAXLINE + 1), "iso-8859-1")
        259         if len(line) > \_MAXLINE:
    

        \textasciitilde{}\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}socket.py in readinto(self, b)
        585             try:
    --> 586                 return self.\_sock.recv\_into(b)
        587             except timeout:
    

        \textasciitilde{}\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}urllib3\textbackslash{}contrib\textbackslash{}pyopenssl.py in recv\_into(self, *args, **kwargs)
        284             else:
    --> 285                 raise SocketError(str(e))
        286         except OpenSSL.SSL.ZeroReturnError as e:
    

        ProtocolError: ('Connection aborted.', OSError("(10054, 'WSAECONNRESET')",))

        
    During handling of the above exception, another exception occurred:
    

        ConnectionError                           Traceback (most recent call last)

        <ipython-input-8-3e2736d7761a> in <module>()
         21 
         22 \#call the bag-of-words model for a product to get similar products.
    ---> 23 bag\_of\_words\_model(12566, 20) \# change the index if you want to.
    

        <ipython-input-8-3e2736d7761a> in bag\_of\_words\_model(doc\_id, num\_results)
         13     for i in range(0,len(indices)):
         14         \# we will pass 1. doc\_id, 2. title1, 3. title2, url, model
    ---> 15         get\_result(indices[i],data['title'].loc[df\_indices[0]], data['title'].loc[df\_indices[i]], data['medium\_image\_url'].loc[df\_indices[i]], 'bag\_of\_words')
         16         print('ASIN :',data['asin'].loc[df\_indices[i]])
         17         print ('Brand:', data['brand'].loc[df\_indices[i]])
    

        <ipython-input-6-180706890159> in get\_result(doc\_id, content\_a, content\_b, url, model)
        116     vector2 = text\_to\_vector(text2)
        117 
    --> 118     plot\_heatmap\_image(doc\_id, vector1, vector2, url, text2, model)
    

        <ipython-input-6-180706890159> in plot\_heatmap\_image(doc\_id, vec1, vec2, url, text, model)
         94                 labels.append(0)
         95 
    ---> 96     plot\_heatmap(keys, values, labels, url, text)
         97 
         98 
    

        <ipython-input-6-180706890159> in plot\_heatmap(keys, values, labels, url, text)
         38 
         39         \# we call dispaly\_img based with paramete url
    ---> 40         display\_img(url, ax, fig)
         41 
         42         \# displays combine figure ( heat map and image together)
    

        <ipython-input-6-180706890159> in display\_img(url, ax, fig)
          4 def display\_img(url,ax,fig):
          5     \# we get the url of the apparel and download it
    ----> 6     response = requests.get(url)
          7     img = Image.open(BytesIO(response.content))
          8     \# we will display it in notebook
    

        \textasciitilde{}\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}requests\textbackslash{}api.py in get(url, params, **kwargs)
         70 
         71     kwargs.setdefault('allow\_redirects', True)
    ---> 72     return request('get', url, params=params, **kwargs)
         73 
         74 
    

        \textasciitilde{}\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}requests\textbackslash{}api.py in request(method, url, **kwargs)
         56     \# cases, and look like a memory leak in others.
         57     with sessions.Session() as session:
    ---> 58         return session.request(method=method, url=url, **kwargs)
         59 
         60 
    

        \textasciitilde{}\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}requests\textbackslash{}sessions.py in request(self, method, url, params, data, headers, cookies, files, auth, timeout, allow\_redirects, proxies, hooks, stream, verify, cert, json)
        506         \}
        507         send\_kwargs.update(settings)
    --> 508         resp = self.send(prep, **send\_kwargs)
        509 
        510         return resp
    

        \textasciitilde{}\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}requests\textbackslash{}sessions.py in send(self, request, **kwargs)
        616 
        617         \# Send the request
    --> 618         r = adapter.send(request, **kwargs)
        619 
        620         \# Total elapsed time of the request (approximately)
    

        \textasciitilde{}\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}requests\textbackslash{}adapters.py in send(self, request, stream, timeout, verify, cert, proxies)
        488 
        489         except (ProtocolError, socket.error) as err:
    --> 490             raise ConnectionError(err, request=request)
        491 
        492         except MaxRetryError as e:
    

        ConnectionError: ('Connection aborted.', OSError("(10054, 'WSAECONNRESET')",))

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_65_9.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsection{TF-IDF based product
similarity}\label{tf-idf-based-product-similarity}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}10}]:} \PY{n}{tfidf\PYZus{}title\PYZus{}vectorizer} \PY{o}{=} \PY{n}{TfidfVectorizer}\PY{p}{(}\PY{n}{min\PYZus{}df} \PY{o}{=} \PY{l+m+mi}{0}\PY{p}{)}
         \PY{n}{tfidf\PYZus{}title\PYZus{}features} \PY{o}{=} \PY{n}{tfidf\PYZus{}title\PYZus{}vectorizer}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{title}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} CountVectorizer().fit\PYZus{}transform(courpus) returns the a sparse matrix of dimensions }
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}11}]:} \PY{k}{def} \PY{n+nf}{tfidf\PYZus{}model}\PY{p}{(}\PY{n}{doc\PYZus{}id}\PY{p}{,} \PY{n}{num\PYZus{}results}\PY{p}{)}\PY{p}{:}
             \PY{c+c1}{\PYZsh{} doc\PYZus{}id: apparel\PYZsq{}s id in given corpus}
             
             \PY{c+c1}{\PYZsh{} pairwise\PYZus{}dist with cosine similarity}
             \PY{n}{pairwise\PYZus{}dist} \PY{o}{=} \PY{n}{pairwise\PYZus{}distances}\PY{p}{(}\PY{n}{tfidf\PYZus{}title\PYZus{}features}\PY{p}{,}\PY{n}{tfidf\PYZus{}title\PYZus{}features}\PY{p}{[}\PY{n}{doc\PYZus{}id}\PY{p}{]}\PY{p}{)}
         
             \PY{c+c1}{\PYZsh{} np.argsort will return indices of smallest distances}
             \PY{n}{indices} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{argsort}\PY{p}{(}\PY{n}{pairwise\PYZus{}dist}\PY{o}{.}\PY{n}{flatten}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{num\PYZus{}results}\PY{p}{]}
             \PY{c+c1}{\PYZsh{}pdists will store the smallest distances}
             \PY{n}{pdists}  \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sort}\PY{p}{(}\PY{n}{pairwise\PYZus{}dist}\PY{o}{.}\PY{n}{flatten}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{num\PYZus{}results}\PY{p}{]}
         
             \PY{n}{df\PYZus{}indices} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n}{data}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{n}{indices}\PY{p}{]}\PY{p}{)}
         
             \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{n+nb}{len}\PY{p}{(}\PY{n}{indices}\PY{p}{)}\PY{p}{)}\PY{p}{:}
                 \PY{c+c1}{\PYZsh{} we will pass 1. doc\PYZus{}id, 2. title1, 3. title2, url, model}
                 \PY{n}{get\PYZus{}result}\PY{p}{(}\PY{n}{indices}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{,} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{title}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{df\PYZus{}indices}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{title}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{df\PYZus{}indices}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{medium\PYZus{}image\PYZus{}url}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{df\PYZus{}indices}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tfidf}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                 \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ASIN :}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{asin}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{df\PYZus{}indices}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]}\PY{p}{)}
                 \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{BRAND :}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{brand}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{df\PYZus{}indices}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]}\PY{p}{)}
                 \PY{n+nb}{print} \PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Eucliden distance from the given image :}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{pdists}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
                 \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{=}\PY{l+s+s1}{\PYZsq{}}\PY{o}{*}\PY{l+m+mi}{125}\PY{p}{)}
         \PY{n}{tfidf\PYZus{}model}\PY{p}{(}\PY{l+m+mi}{12566}\PY{p}{,} \PY{l+m+mi}{20}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_68_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00JXQB5FQ
BRAND : Si Row
Eucliden distance from the given image : 0.0
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_68_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00JXQASS6
BRAND : Si Row
Eucliden distance from the given image : 0.7536331912451361
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_68_4.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00JXQCWTO
BRAND : Si Row
Eucliden distance from the given image : 0.9357643943769645
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_68_6.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00JXQAFZ2
BRAND : Si Row
Eucliden distance from the given image : 0.9586153524200749
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_68_8.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00JXQCUIC
BRAND : Si Row
Eucliden distance from the given image : 1.000074961446881
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_68_10.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00JXQAO94
BRAND : Si Row
Eucliden distance from the given image : 1.023215552457452
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_68_12.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00JXQAUWA
BRAND : Si Row
Eucliden distance from the given image : 1.031991846303421
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_68_14.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B06XSCVFT5
BRAND : Studio M
Eucliden distance from the given image : 1.2106843670424716
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_68_16.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B06Y2GTYPM
BRAND : No Boundaries
Eucliden distance from the given image : 1.212168381072083
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_68_18.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B012VQLT6Y
BRAND : KM T-shirt
Eucliden distance from the given image : 1.219790640280982
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_68_20.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B06Y1VN8WQ
BRAND : Black Swan
Eucliden distance from the given image : 1.2206849659998316
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_68_22.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00Z6HEXWI
BRAND : Black Temptation
Eucliden distance from the given image : 1.221281392120943
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_68_24.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B074TR12BH
BRAND : Ultra Flirt
Eucliden distance from the given image : 1.2313364094597743
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_68_26.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B072R2JXKW
BRAND : WHAT ON EARTH
Eucliden distance from the given image : 1.2318451972624518
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_68_28.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B074T8ZYGX
BRAND : MKP Crop Top
Eucliden distance from the given image : 1.2340607457359425
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_68_30.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B071ZDF6T2
BRAND : Mossimo
Eucliden distance from the given image : 1.2352785577664824
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_68_32.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B01K0H02OG
BRAND : Tultex
Eucliden distance from the given image : 1.236457298812782
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_68_34.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00H8A6ZLI
BRAND : Vivian's Fashions
Eucliden distance from the given image : 1.24996155052848
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_68_36.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B010NN9RXO
BRAND : YICHUN
Eucliden distance from the given image : 1.25354614208561
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_68_38.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B06XBY5QXL
BRAND : Liz Claiborne
Eucliden distance from the given image : 1.2538832938357722
=============================================================================================================================

    \end{Verbatim}

    \subsection{IDF based product
similarity}\label{idf-based-product-similarity}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}12}]:} \PY{n}{idf\PYZus{}title\PYZus{}vectorizer} \PY{o}{=} \PY{n}{CountVectorizer}\PY{p}{(}\PY{p}{)}
         \PY{n}{idf\PYZus{}title\PYZus{}features} \PY{o}{=} \PY{n}{idf\PYZus{}title\PYZus{}vectorizer}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{title}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}13}]:} \PY{k}{def} \PY{n+nf}{n\PYZus{}containing}\PY{p}{(}\PY{n}{word}\PY{p}{)}\PY{p}{:}
             \PY{k}{return} \PY{n+nb}{sum}\PY{p}{(}\PY{l+m+mi}{1} \PY{k}{for} \PY{n}{blob} \PY{o+ow}{in} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{title}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{k}{if} \PY{n}{word} \PY{o+ow}{in} \PY{n}{blob}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{p}{)}\PY{p}{)}
         
         \PY{k}{def} \PY{n+nf}{idf}\PY{p}{(}\PY{n}{word}\PY{p}{)}\PY{p}{:}
             \PY{k}{return} \PY{n}{math}\PY{o}{.}\PY{n}{log}\PY{p}{(}\PY{n}{data}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{/} \PY{p}{(}\PY{n}{n\PYZus{}containing}\PY{p}{(}\PY{n}{word}\PY{p}{)}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}15}]:} \PY{c+c1}{\PYZsh{} we need to convert the values into float}
         \PY{n}{idf\PYZus{}title\PYZus{}features}  \PY{o}{=} \PY{n}{idf\PYZus{}title\PYZus{}features}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{float}\PY{p}{)}
         
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{idf\PYZus{}title\PYZus{}vectorizer}\PY{o}{.}\PY{n}{vocabulary\PYZus{}}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{:}
             \PY{c+c1}{\PYZsh{} for every word in whole corpus we will find its idf value}
             \PY{n}{idf\PYZus{}val} \PY{o}{=} \PY{n}{idf}\PY{p}{(}\PY{n}{i}\PY{p}{)}
             \PY{k}{for} \PY{n}{j} \PY{o+ow}{in} \PY{n}{idf\PYZus{}title\PYZus{}features}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{n}{idf\PYZus{}title\PYZus{}vectorizer}\PY{o}{.}\PY{n}{vocabulary\PYZus{}}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{nonzero}\PY{p}{(}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{:}
                 \PY{n}{idf\PYZus{}title\PYZus{}features}\PY{p}{[}\PY{n}{j}\PY{p}{,}\PY{n}{idf\PYZus{}title\PYZus{}vectorizer}\PY{o}{.}\PY{n}{vocabulary\PYZus{}}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]} \PY{o}{=} \PY{n}{idf\PYZus{}val}
                 
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}16}]:} \PY{k}{def} \PY{n+nf}{idf\PYZus{}model}\PY{p}{(}\PY{n}{doc\PYZus{}id}\PY{p}{,} \PY{n}{num\PYZus{}results}\PY{p}{)}\PY{p}{:}
             \PY{c+c1}{\PYZsh{} doc\PYZus{}id: apparel\PYZsq{}s id in given corpus}
             
             \PY{c+c1}{\PYZsh{}  pairwise\PYZus{}dist with cosine similarity}
             \PY{n}{pairwise\PYZus{}dist} \PY{o}{=} \PY{n}{pairwise\PYZus{}distances}\PY{p}{(}\PY{n}{idf\PYZus{}title\PYZus{}features}\PY{p}{,}\PY{n}{idf\PYZus{}title\PYZus{}features}\PY{p}{[}\PY{n}{doc\PYZus{}id}\PY{p}{]}\PY{p}{)}
         
             \PY{c+c1}{\PYZsh{} np.argsort will return indices of  smallest distances}
             \PY{n}{indices} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{argsort}\PY{p}{(}\PY{n}{pairwise\PYZus{}dist}\PY{o}{.}\PY{n}{flatten}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{num\PYZus{}results}\PY{p}{]}
             \PY{c+c1}{\PYZsh{}pdists will store the smallest distances}
             \PY{n}{pdists}  \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sort}\PY{p}{(}\PY{n}{pairwise\PYZus{}dist}\PY{o}{.}\PY{n}{flatten}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{num\PYZus{}results}\PY{p}{]}
         
             \PY{c+c1}{\PYZsh{}data frame indices of the smallest distace\PYZsq{}s}
             \PY{n}{df\PYZus{}indices} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n}{data}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{n}{indices}\PY{p}{]}\PY{p}{)}
         
             \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{n+nb}{len}\PY{p}{(}\PY{n}{indices}\PY{p}{)}\PY{p}{)}\PY{p}{:}
                 \PY{n}{get\PYZus{}result}\PY{p}{(}\PY{n}{indices}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{,}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{title}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{df\PYZus{}indices}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{title}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{df\PYZus{}indices}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{medium\PYZus{}image\PYZus{}url}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{df\PYZus{}indices}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{idf}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                 \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ASIN :}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{asin}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{df\PYZus{}indices}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]}\PY{p}{)}
                 \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Brand :}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{brand}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{df\PYZus{}indices}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]}\PY{p}{)}
                 \PY{n+nb}{print} \PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{euclidean distance from the given image :}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{pdists}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
                 \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{=}\PY{l+s+s1}{\PYZsq{}}\PY{o}{*}\PY{l+m+mi}{125}\PY{p}{)}
         
                 
                 
         \PY{n}{idf\PYZus{}model}\PY{p}{(}\PY{l+m+mi}{12566}\PY{p}{,}\PY{l+m+mi}{20}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_73_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00JXQB5FQ
Brand : Si Row
euclidean distance from the given image : 0.0
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_73_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00JXQASS6
Brand : Si Row
euclidean distance from the given image : 12.20507131122177
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_73_4.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00JXQCWTO
Brand : Si Row
euclidean distance from the given image : 14.468362685603465
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_73_6.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00JXQAFZ2
Brand : Si Row
euclidean distance from the given image : 14.486832924778964
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_73_8.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00JXQAO94
Brand : Si Row
euclidean distance from the given image : 14.833392966672909
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_73_10.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00JXQCUIC
Brand : Si Row
euclidean distance from the given image : 14.898744516719225
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_73_12.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00JXQAUWA
Brand : Si Row
euclidean distance from the given image : 15.224458287343769
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_73_14.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B074T8ZYGX
Brand : MKP Crop Top
euclidean distance from the given image : 17.080812955631995
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_73_16.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00KF2N5PU
Brand : Vietsbay
euclidean distance from the given image : 17.090168125645416
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_73_18.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00JPOZ9GM
Brand : Sofra
euclidean distance from the given image : 17.153215337562703
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_73_20.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B074T9KG9Q
Brand : Rain
euclidean distance from the given image : 17.33671523874989
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_73_22.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00H8A6ZLI
Brand : Vivian's Fashions
euclidean distance from the given image : 17.410075941001253
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_73_24.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B074G5G5RK
Brand : ERMANNO SCERVINO
euclidean distance from the given image : 17.539921335459557
=============================================================================================================================

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]

        ---------------------------------------------------------------------------

        SysCallError                              Traceback (most recent call last)

        \textasciitilde{}\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}urllib3\textbackslash{}contrib\textbackslash{}pyopenssl.py in wrap\_socket(self, sock, server\_side, do\_handshake\_on\_connect, suppress\_ragged\_eofs, server\_hostname)
        440             try:
    --> 441                 cnx.do\_handshake()
        442             except OpenSSL.SSL.WantReadError:
    

        \textasciitilde{}\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}OpenSSL\textbackslash{}SSL.py in do\_handshake(self)
       1906         result = \_lib.SSL\_do\_handshake(self.\_ssl)
    -> 1907         self.\_raise\_ssl\_error(self.\_ssl, result)
       1908 
    

        \textasciitilde{}\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}OpenSSL\textbackslash{}SSL.py in \_raise\_ssl\_error(self, ssl, result)
       1630                     if errno != 0:
    -> 1631                         raise SysCallError(errno, errorcode.get(errno))
       1632                 raise SysCallError(-1, "Unexpected EOF")
    

        SysCallError: (10051, 'WSAENETUNREACH')

        
    During handling of the above exception, another exception occurred:
    

        SSLError                                  Traceback (most recent call last)

        \textasciitilde{}\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}urllib3\textbackslash{}connectionpool.py in urlopen(self, method, url, body, headers, retries, redirect, assert\_same\_host, timeout, pool\_timeout, release\_conn, chunked, body\_pos, **response\_kw)
        600                                                   body=body, headers=headers,
    --> 601                                                   chunked=chunked)
        602 
    

        \textasciitilde{}\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}urllib3\textbackslash{}connectionpool.py in \_make\_request(self, conn, method, url, timeout, chunked, **httplib\_request\_kw)
        345         try:
    --> 346             self.\_validate\_conn(conn)
        347         except (SocketTimeout, BaseSSLError) as e:
    

        \textasciitilde{}\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}urllib3\textbackslash{}connectionpool.py in \_validate\_conn(self, conn)
        849         if not getattr(conn, 'sock', None):  \# AppEngine might not have  `.sock`
    --> 850             conn.connect()
        851 
    

        \textasciitilde{}\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}urllib3\textbackslash{}connection.py in connect(self)
        325             server\_hostname=hostname,
    --> 326             ssl\_context=context)
        327 
    

        \textasciitilde{}\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}urllib3\textbackslash{}util\textbackslash{}ssl\_.py in ssl\_wrap\_socket(sock, keyfile, certfile, cert\_reqs, ca\_certs, server\_hostname, ssl\_version, ciphers, ssl\_context, ca\_cert\_dir)
        328     if HAS\_SNI:  \# Platform-specific: OpenSSL with enabled SNI
    --> 329         return context.wrap\_socket(sock, server\_hostname=server\_hostname)
        330 
    

        \textasciitilde{}\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}urllib3\textbackslash{}contrib\textbackslash{}pyopenssl.py in wrap\_socket(self, sock, server\_side, do\_handshake\_on\_connect, suppress\_ragged\_eofs, server\_hostname)
        447             except OpenSSL.SSL.Error as e:
    --> 448                 raise ssl.SSLError('bad handshake: \%r' \% e)
        449             break
    

        SSLError: ("bad handshake: SysCallError(10051, 'WSAENETUNREACH')",)

        
    During handling of the above exception, another exception occurred:
    

        MaxRetryError                             Traceback (most recent call last)

        \textasciitilde{}\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}requests\textbackslash{}adapters.py in send(self, request, stream, timeout, verify, cert, proxies)
        439                     retries=self.max\_retries,
    --> 440                     timeout=timeout
        441                 )
    

        \textasciitilde{}\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}urllib3\textbackslash{}connectionpool.py in urlopen(self, method, url, body, headers, retries, redirect, assert\_same\_host, timeout, pool\_timeout, release\_conn, chunked, body\_pos, **response\_kw)
        638             retries = retries.increment(method, url, error=e, \_pool=self,
    --> 639                                         \_stacktrace=sys.exc\_info()[2])
        640             retries.sleep()
    

        \textasciitilde{}\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}urllib3\textbackslash{}util\textbackslash{}retry.py in increment(self, method, url, response, error, \_pool, \_stacktrace)
        387         if new\_retry.is\_exhausted():
    --> 388             raise MaxRetryError(\_pool, url, error or ResponseError(cause))
        389 
    

        MaxRetryError: HTTPSConnectionPool(host='images-na.ssl-images-amazon.com', port=443): Max retries exceeded with url: /images/I/41xG4P296RL.\_SL160\_.jpg (Caused by SSLError(SSLError("bad handshake: SysCallError(10051, 'WSAENETUNREACH')",),))

        
    During handling of the above exception, another exception occurred:
    

        SSLError                                  Traceback (most recent call last)

        <ipython-input-16-ac6e976eb997> in <module>()
         22 
         23 
    ---> 24 idf\_model(12566,20)
    

        <ipython-input-16-ac6e976eb997> in idf\_model(doc\_id, num\_results)
         14 
         15     for i in range(0,len(indices)):
    ---> 16         get\_result(indices[i],data['title'].loc[df\_indices[0]], data['title'].loc[df\_indices[i]], data['medium\_image\_url'].loc[df\_indices[i]], 'idf')
         17         print('ASIN :',data['asin'].loc[df\_indices[i]])
         18         print('Brand :',data['brand'].loc[df\_indices[i]])
    

        <ipython-input-6-180706890159> in get\_result(doc\_id, content\_a, content\_b, url, model)
        116     vector2 = text\_to\_vector(text2)
        117 
    --> 118     plot\_heatmap\_image(doc\_id, vector1, vector2, url, text2, model)
    

        <ipython-input-6-180706890159> in plot\_heatmap\_image(doc\_id, vec1, vec2, url, text, model)
         94                 labels.append(0)
         95 
    ---> 96     plot\_heatmap(keys, values, labels, url, text)
         97 
         98 
    

        <ipython-input-6-180706890159> in plot\_heatmap(keys, values, labels, url, text)
         38 
         39         \# we call dispaly\_img based with paramete url
    ---> 40         display\_img(url, ax, fig)
         41 
         42         \# displays combine figure ( heat map and image together)
    

        <ipython-input-6-180706890159> in display\_img(url, ax, fig)
          4 def display\_img(url,ax,fig):
          5     \# we get the url of the apparel and download it
    ----> 6     response = requests.get(url)
          7     img = Image.open(BytesIO(response.content))
          8     \# we will display it in notebook
    

        \textasciitilde{}\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}requests\textbackslash{}api.py in get(url, params, **kwargs)
         70 
         71     kwargs.setdefault('allow\_redirects', True)
    ---> 72     return request('get', url, params=params, **kwargs)
         73 
         74 
    

        \textasciitilde{}\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}requests\textbackslash{}api.py in request(method, url, **kwargs)
         56     \# cases, and look like a memory leak in others.
         57     with sessions.Session() as session:
    ---> 58         return session.request(method=method, url=url, **kwargs)
         59 
         60 
    

        \textasciitilde{}\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}requests\textbackslash{}sessions.py in request(self, method, url, params, data, headers, cookies, files, auth, timeout, allow\_redirects, proxies, hooks, stream, verify, cert, json)
        506         \}
        507         send\_kwargs.update(settings)
    --> 508         resp = self.send(prep, **send\_kwargs)
        509 
        510         return resp
    

        \textasciitilde{}\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}requests\textbackslash{}sessions.py in send(self, request, **kwargs)
        616 
        617         \# Send the request
    --> 618         r = adapter.send(request, **kwargs)
        619 
        620         \# Total elapsed time of the request (approximately)
    

        \textasciitilde{}\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}requests\textbackslash{}adapters.py in send(self, request, stream, timeout, verify, cert, proxies)
        504             if isinstance(e.reason, \_SSLError):
        505                 \# This branch is for urllib3 v1.22 and later.
    --> 506                 raise SSLError(e, request=request)
        507 
        508             raise ConnectionError(e, request=request)
    

        SSLError: HTTPSConnectionPool(host='images-na.ssl-images-amazon.com', port=443): Max retries exceeded with url: /images/I/41xG4P296RL.\_SL160\_.jpg (Caused by SSLError(SSLError("bad handshake: SysCallError(10051, 'WSAENETUNREACH')",),))

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_73_27.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \section{Text Semantics based product
similarity}\label{text-semantics-based-product-similarity}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}17}]:} \PY{k+kn}{from} \PY{n+nn}{gensim}\PY{n+nn}{.}\PY{n+nn}{models} \PY{k}{import} \PY{n}{Word2Vec}
         \PY{k+kn}{from} \PY{n+nn}{gensim}\PY{n+nn}{.}\PY{n+nn}{models} \PY{k}{import} \PY{n}{KeyedVectors}
         \PY{k+kn}{import} \PY{n+nn}{pickle}
         
         \PY{k}{with} \PY{n+nb}{open}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{word2vec\PYZus{}model}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rb}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{k}{as} \PY{n}{handle}\PY{p}{:}
             \PY{n}{model} \PY{o}{=} \PY{n}{pickle}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{n}{handle}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}18}]:} \PY{c+c1}{\PYZsh{} Utility functions}
         
         \PY{k}{def} \PY{n+nf}{get\PYZus{}word\PYZus{}vec}\PY{p}{(}\PY{n}{sentence}\PY{p}{,} \PY{n}{doc\PYZus{}id}\PY{p}{,} \PY{n}{m\PYZus{}name}\PY{p}{)}\PY{p}{:}
             \PY{c+c1}{\PYZsh{} sentence : title of the apparel}
             \PY{c+c1}{\PYZsh{} doc\PYZus{}id: document id in our corpus}
             \PY{c+c1}{\PYZsh{} m\PYZus{}name: model information it will take two values}
                 \PY{c+c1}{\PYZsh{} if  m\PYZus{}name == \PYZsq{}avg\PYZsq{}, we will append the model[i], w2v representation of word i}
                 \PY{c+c1}{\PYZsh{} if m\PYZus{}name == \PYZsq{}weighted\PYZsq{}, we will multiply each w2v[word] with the idf(word)}
             \PY{n}{vec} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{sentence}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{p}{)}\PY{p}{:}
                 \PY{k}{if} \PY{n}{i} \PY{o+ow}{in} \PY{n}{vocab}\PY{p}{:}
                     \PY{k}{if} \PY{n}{m\PYZus{}name} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{weighted}\PY{l+s+s1}{\PYZsq{}} \PY{o+ow}{and} \PY{n}{i} \PY{o+ow}{in}  \PY{n}{idf\PYZus{}title\PYZus{}vectorizer}\PY{o}{.}\PY{n}{vocabulary\PYZus{}}\PY{p}{:}
                         \PY{n}{vec}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{idf\PYZus{}title\PYZus{}features}\PY{p}{[}\PY{n}{doc\PYZus{}id}\PY{p}{,} \PY{n}{idf\PYZus{}title\PYZus{}vectorizer}\PY{o}{.}\PY{n}{vocabulary\PYZus{}}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]} \PY{o}{*} \PY{n}{model}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
                     \PY{k}{elif} \PY{n}{m\PYZus{}name} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{avg}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                         \PY{n}{vec}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{model}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
                 \PY{k}{else}\PY{p}{:}
                     \PY{c+c1}{\PYZsh{} if the word in our corpus is not there in the google word2vec corpus, we are just ignoring it}
                     \PY{n}{vec}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{n}{shape}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{300}\PY{p}{,}\PY{p}{)}\PY{p}{)}\PY{p}{)}
             \PY{k}{return}  \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{vec}\PY{p}{)}
         
         \PY{k}{def} \PY{n+nf}{get\PYZus{}distance}\PY{p}{(}\PY{n}{vec1}\PY{p}{,} \PY{n}{vec2}\PY{p}{)}\PY{p}{:}
             \PY{n}{final\PYZus{}dist} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{vec1}\PY{p}{:}
                 \PY{n}{dist} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                 \PY{k}{for} \PY{n}{j} \PY{o+ow}{in} \PY{n}{vec2}\PY{p}{:}
                     \PY{c+c1}{\PYZsh{} np.linalg.norm(i\PYZhy{}j) will result the euclidean distance between vectors i, j}
                     \PY{n}{dist}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{linalg}\PY{o}{.}\PY{n}{norm}\PY{p}{(}\PY{n}{i}\PY{o}{\PYZhy{}}\PY{n}{j}\PY{p}{)}\PY{p}{)}
                 \PY{n}{final\PYZus{}dist}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{dist}\PY{p}{)}\PY{p}{)}
             \PY{c+c1}{\PYZsh{} final\PYZus{}dist[i,j] = euclidean distance between vectors i, j}
             \PY{k}{return} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{final\PYZus{}dist}\PY{p}{)}
         
         
         \PY{k}{def} \PY{n+nf}{heat\PYZus{}map\PYZus{}w2v}\PY{p}{(}\PY{n}{sentence1}\PY{p}{,} \PY{n}{sentence2}\PY{p}{,} \PY{n}{url}\PY{p}{,} \PY{n}{doc\PYZus{}id1}\PY{p}{,} \PY{n}{doc\PYZus{}id2}\PY{p}{,} \PY{n}{model}\PY{p}{)}\PY{p}{:}
             \PY{c+c1}{\PYZsh{} sentance1 : title1, input apparel}
             \PY{c+c1}{\PYZsh{} sentance2 : title2, recommended apparel}
             \PY{c+c1}{\PYZsh{} url: apparel image url}
             \PY{c+c1}{\PYZsh{} doc\PYZus{}id1: document id of input apparel}
             \PY{c+c1}{\PYZsh{} doc\PYZus{}id2: document id of recommended apparel}
             \PY{c+c1}{\PYZsh{} model: it can have two values, 1. avg 2. weighted}
             
             \PY{c+c1}{\PYZsh{}s1\PYZus{}vec = np.array(\PYZsh{}number\PYZus{}of\PYZus{}words\PYZus{}title1 * 300), each row is a vector(weighted/avg) of length 300 corresponds to each word in give title}
             \PY{n}{s1\PYZus{}vec} \PY{o}{=} \PY{n}{get\PYZus{}word\PYZus{}vec}\PY{p}{(}\PY{n}{sentence1}\PY{p}{,} \PY{n}{doc\PYZus{}id1}\PY{p}{,} \PY{n}{model}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}s2\PYZus{}vec = np.array(\PYZsh{}number\PYZus{}of\PYZus{}words\PYZus{}title1 * 300), each row is a vector(weighted/avg) of length 300 corresponds to each word in give title}
             \PY{n}{s2\PYZus{}vec} \PY{o}{=} \PY{n}{get\PYZus{}word\PYZus{}vec}\PY{p}{(}\PY{n}{sentence2}\PY{p}{,} \PY{n}{doc\PYZus{}id2}\PY{p}{,} \PY{n}{model}\PY{p}{)}
         
             \PY{c+c1}{\PYZsh{} s1\PYZus{}s2\PYZus{}dist = np.array(\PYZsh{}number of words in title1 * \PYZsh{}number of words in title2)}
             \PY{c+c1}{\PYZsh{} s1\PYZus{}s2\PYZus{}dist[i,j] = euclidean distance between words i, j}
             \PY{n}{s1\PYZus{}s2\PYZus{}dist} \PY{o}{=} \PY{n}{get\PYZus{}distance}\PY{p}{(}\PY{n}{s1\PYZus{}vec}\PY{p}{,} \PY{n}{s2\PYZus{}vec}\PY{p}{)}
         
             
             
             \PY{c+c1}{\PYZsh{} devide whole figure into 2 parts 1st part displays heatmap 2nd part displays image of apparel}
             \PY{n}{gs} \PY{o}{=} \PY{n}{gridspec}\PY{o}{.}\PY{n}{GridSpec}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{,} \PY{n}{width\PYZus{}ratios}\PY{o}{=}\PY{p}{[}\PY{l+m+mi}{4}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,}\PY{n}{height\PYZus{}ratios}\PY{o}{=}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)} 
             \PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{15}\PY{p}{,}\PY{l+m+mi}{15}\PY{p}{)}\PY{p}{)}
             
             \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{n}{gs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
             \PY{c+c1}{\PYZsh{} ploting the heap map based on the pairwise distances}
             \PY{n}{ax} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{heatmap}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{round}\PY{p}{(}\PY{n}{s1\PYZus{}s2\PYZus{}dist}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{)}\PY{p}{,} \PY{n}{annot}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
             \PY{c+c1}{\PYZsh{} set the x axis labels as recommended apparels title}
             \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xticklabels}\PY{p}{(}\PY{n}{sentence2}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{p}{)}\PY{p}{)}
             \PY{c+c1}{\PYZsh{} set the y axis labels as input apparels title}
             \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}yticklabels}\PY{p}{(}\PY{n}{sentence1}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{p}{)}\PY{p}{)}
             \PY{c+c1}{\PYZsh{} set title as recommended apparels title}
             \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{n}{sentence2}\PY{p}{)}
             
             \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{n}{gs}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
             \PY{c+c1}{\PYZsh{} we remove all grids and axis labels for image}
             \PY{n}{ax}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{k+kc}{False}\PY{p}{)}
             \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xticks}\PY{p}{(}\PY{p}{[}\PY{p}{]}\PY{p}{)}
             \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}yticks}\PY{p}{(}\PY{p}{[}\PY{p}{]}\PY{p}{)}
             \PY{n}{display\PYZus{}img}\PY{p}{(}\PY{n}{url}\PY{p}{,} \PY{n}{ax}\PY{p}{,} \PY{n}{fig}\PY{p}{)}
             
             \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}19}]:} \PY{c+c1}{\PYZsh{} vocab = stores all the words that are there in google w2v model}
         \PY{c+c1}{\PYZsh{} vocab = model.wv.vocab.keys() \PYZsh{} if you are using Google word2Vec}
         
         \PY{n}{vocab} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} this function will add the vectors of each word and returns the avg vector of given sentance}
         \PY{k}{def} \PY{n+nf}{build\PYZus{}avg\PYZus{}vec}\PY{p}{(}\PY{n}{sentence}\PY{p}{,} \PY{n}{num\PYZus{}features}\PY{p}{,} \PY{n}{doc\PYZus{}id}\PY{p}{,} \PY{n}{m\PYZus{}name}\PY{p}{)}\PY{p}{:}
             \PY{c+c1}{\PYZsh{} sentace: its title of the apparel}
             \PY{c+c1}{\PYZsh{} num\PYZus{}features: the lenght of word2vec vector, its values = 300}
             \PY{c+c1}{\PYZsh{} m\PYZus{}name: model information it will take two values}
                 \PY{c+c1}{\PYZsh{} if  m\PYZus{}name == \PYZsq{}avg\PYZsq{}, we will append the model[i], w2v representation of word i}
                 \PY{c+c1}{\PYZsh{} if m\PYZus{}name == \PYZsq{}weighted\PYZsq{}, we will multiply each w2v[word] with the idf(word)}
         
             \PY{n}{featureVec} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{n}{num\PYZus{}features}\PY{p}{,}\PY{p}{)}\PY{p}{,} \PY{n}{dtype}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{float32}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
             \PY{c+c1}{\PYZsh{} we will intialize a vector of size 300 with all zeros}
             \PY{c+c1}{\PYZsh{} we add each word2vec(wordi) to this fetureVec}
             \PY{n}{nwords} \PY{o}{=} \PY{l+m+mi}{0}
             
             \PY{k}{for} \PY{n}{word} \PY{o+ow}{in} \PY{n}{sentence}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{p}{)}\PY{p}{:}
                 \PY{n}{nwords} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                 \PY{k}{if} \PY{n}{word} \PY{o+ow}{in} \PY{n}{vocab}\PY{p}{:}
                     \PY{k}{if} \PY{n}{m\PYZus{}name} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{weighted}\PY{l+s+s1}{\PYZsq{}} \PY{o+ow}{and} \PY{n}{word} \PY{o+ow}{in}  \PY{n}{idf\PYZus{}title\PYZus{}vectorizer}\PY{o}{.}\PY{n}{vocabulary\PYZus{}}\PY{p}{:}
                         \PY{n}{featureVec} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{featureVec}\PY{p}{,} \PY{n}{idf\PYZus{}title\PYZus{}features}\PY{p}{[}\PY{n}{doc\PYZus{}id}\PY{p}{,} \PY{n}{idf\PYZus{}title\PYZus{}vectorizer}\PY{o}{.}\PY{n}{vocabulary\PYZus{}}\PY{p}{[}\PY{n}{word}\PY{p}{]}\PY{p}{]} \PY{o}{*} \PY{n}{model}\PY{p}{[}\PY{n}{word}\PY{p}{]}\PY{p}{)}
                     \PY{k}{elif} \PY{n}{m\PYZus{}name} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{avg}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                         \PY{n}{featureVec} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{featureVec}\PY{p}{,} \PY{n}{model}\PY{p}{[}\PY{n}{word}\PY{p}{]}\PY{p}{)}
             \PY{k}{if}\PY{p}{(}\PY{n}{nwords}\PY{o}{\PYZgt{}}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{:}
                 \PY{n}{featureVec} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{divide}\PY{p}{(}\PY{n}{featureVec}\PY{p}{,} \PY{n}{nwords}\PY{p}{)}
             \PY{c+c1}{\PYZsh{} returns the avg vector of given sentance, its of shape (1, 300)}
             \PY{k}{return} \PY{n}{featureVec}
\end{Verbatim}


    \subsubsection{Average Word2Vec product
similarity.}\label{average-word2vec-product-similarity.}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}20}]:} \PY{n}{doc\PYZus{}id} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{w2v\PYZus{}title} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{c+c1}{\PYZsh{} for every title we build a avg vector representation}
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{title}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{:}
             \PY{n}{w2v\PYZus{}title}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{build\PYZus{}avg\PYZus{}vec}\PY{p}{(}\PY{n}{i}\PY{p}{,} \PY{l+m+mi}{300}\PY{p}{,} \PY{n}{doc\PYZus{}id}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{avg}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
             \PY{n}{doc\PYZus{}id} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
         \PY{n}{w2v\PYZus{}title} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{w2v\PYZus{}title}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}21}]:} \PY{k}{def} \PY{n+nf}{avg\PYZus{}w2v\PYZus{}model}\PY{p}{(}\PY{n}{doc\PYZus{}id}\PY{p}{,} \PY{n}{num\PYZus{}results}\PY{p}{)}\PY{p}{:}
             \PY{c+c1}{\PYZsh{} doc\PYZus{}id: apparel\PYZsq{}s id in given corpus}
             
             \PY{n}{pairwise\PYZus{}dist} \PY{o}{=} \PY{n}{pairwise\PYZus{}distances}\PY{p}{(}\PY{n}{w2v\PYZus{}title}\PY{p}{,} \PY{n}{w2v\PYZus{}title}\PY{p}{[}\PY{n}{doc\PYZus{}id}\PY{p}{]}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
         
             \PY{c+c1}{\PYZsh{} np.argsort will return indices of  smallest distances}
             \PY{n}{indices} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{argsort}\PY{p}{(}\PY{n}{pairwise\PYZus{}dist}\PY{o}{.}\PY{n}{flatten}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{num\PYZus{}results}\PY{p}{]}
             \PY{c+c1}{\PYZsh{}pdists will store the  smallest distances}
             \PY{n}{pdists}  \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sort}\PY{p}{(}\PY{n}{pairwise\PYZus{}dist}\PY{o}{.}\PY{n}{flatten}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{num\PYZus{}results}\PY{p}{]}
         
             \PY{c+c1}{\PYZsh{}data frame indices of the smallest distace\PYZsq{}s}
             \PY{n}{df\PYZus{}indices} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n}{data}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{n}{indices}\PY{p}{]}\PY{p}{)}
             
             \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{indices}\PY{p}{)}\PY{p}{)}\PY{p}{:}
                 \PY{n}{heat\PYZus{}map\PYZus{}w2v}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{title}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{df\PYZus{}indices}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{]}\PY{p}{,}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{title}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{df\PYZus{}indices}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{medium\PYZus{}image\PYZus{}url}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{df\PYZus{}indices}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{n}{indices}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{indices}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{avg}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                 \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ASIN :}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{asin}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{df\PYZus{}indices}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]}\PY{p}{)}
                 \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{BRAND :}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{brand}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{df\PYZus{}indices}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]}\PY{p}{)}
                 \PY{n+nb}{print} \PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{euclidean distance from given input image :}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{pdists}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
                 \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{=}\PY{l+s+s1}{\PYZsq{}}\PY{o}{*}\PY{l+m+mi}{125}\PY{p}{)}
         
                 
         \PY{n}{avg\PYZus{}w2v\PYZus{}model}\PY{p}{(}\PY{l+m+mi}{12566}\PY{p}{,} \PY{l+m+mi}{20}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_80_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00JXQB5FQ
BRAND : Si Row
euclidean distance from given input image : 0.00069053395
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_80_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00JXQASS6
BRAND : Si Row
euclidean distance from given input image : 0.5891932
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_80_4.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00JXQCWTO
BRAND : Si Row
euclidean distance from given input image : 0.7003439
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_80_6.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00JXQAFZ2
BRAND : Si Row
euclidean distance from given input image : 0.8928398
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_80_8.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00JXQCUIC
BRAND : Si Row
euclidean distance from given input image : 0.95601267
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_80_10.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B073R5Q8HD
BRAND : Colosseum
euclidean distance from given input image : 1.0229691
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_80_12.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B06XBY5QXL
BRAND : Liz Claiborne
euclidean distance from given input image : 1.0669324
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_80_14.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B01L8L73M2
BRAND : Hotgirl4 Raglan Design
euclidean distance from given input image : 1.0731405
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_80_16.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B01EJS5H06
BRAND : Vansty
euclidean distance from given input image : 1.075719
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_80_18.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B01BO1XRK8
BRAND : Le Bos
euclidean distance from given input image : 1.0839964
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_80_20.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B072R2JXKW
BRAND : WHAT ON EARTH
euclidean distance from given input image : 1.0842218
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_80_22.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B074MJRGW6
BRAND : Two by Vince Camuto
euclidean distance from given input image : 1.0895038
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_80_24.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00JXQCFRS
BRAND : Si Row
euclidean distance from given input image : 1.0900588
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_80_26.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B01I53HU6K
BRAND : ouxiuli
euclidean distance from given input image : 1.0920112
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_80_28.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B0711NGTQM
BRAND : THILFIGER RTW
euclidean distance from given input image : 1.0923418
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_80_30.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B01EFSLO8Y
BRAND : Vansty
euclidean distance from given input image : 1.0934006
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_80_32.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B0716TVWQ4
BRAND : THILFIGER RTW
euclidean distance from given input image : 1.0942026
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_80_34.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B0716MVPGV
BRAND : V.Secret
euclidean distance from given input image : 1.0948305
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_80_36.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B016OPN4OI
BRAND : TIKE Fashions
euclidean distance from given input image : 1.0951275
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_80_38.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B018WDJCUA
BRAND : INC - International Concepts Woman
euclidean distance from given input image : 1.0966892
=============================================================================================================================

    \end{Verbatim}

    \subsubsection{IDF weighted Word2Vec for product
similarity}\label{idf-weighted-word2vec-for-product-similarity}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}22}]:} \PY{n}{doc\PYZus{}id} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{w2v\PYZus{}title\PYZus{}weight} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{c+c1}{\PYZsh{} for every title we build a weighted vector representation}
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{title}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{:}
             \PY{n}{w2v\PYZus{}title\PYZus{}weight}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{build\PYZus{}avg\PYZus{}vec}\PY{p}{(}\PY{n}{i}\PY{p}{,} \PY{l+m+mi}{300}\PY{p}{,} \PY{n}{doc\PYZus{}id}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{weighted}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
             \PY{n}{doc\PYZus{}id} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
         \PY{n}{w2v\PYZus{}title\PYZus{}weight} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{w2v\PYZus{}title\PYZus{}weight}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}23}]:} \PY{k}{def} \PY{n+nf}{weighted\PYZus{}w2v\PYZus{}model}\PY{p}{(}\PY{n}{doc\PYZus{}id}\PY{p}{,} \PY{n}{num\PYZus{}results}\PY{p}{)}\PY{p}{:}
             \PY{c+c1}{\PYZsh{} doc\PYZus{}id: apparel\PYZsq{}s id in given corpus}
             
             \PY{c+c1}{\PYZsh{} pairwise\PYZus{}dist with cosine similarity}
             \PY{n}{pairwise\PYZus{}dist} \PY{o}{=} \PY{n}{pairwise\PYZus{}distances}\PY{p}{(}\PY{n}{w2v\PYZus{}title\PYZus{}weight}\PY{p}{,} \PY{n}{w2v\PYZus{}title\PYZus{}weight}\PY{p}{[}\PY{n}{doc\PYZus{}id}\PY{p}{]}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
         
             \PY{c+c1}{\PYZsh{} np.argsort will return indices of smallest distances}
             \PY{n}{indices} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{argsort}\PY{p}{(}\PY{n}{pairwise\PYZus{}dist}\PY{o}{.}\PY{n}{flatten}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{num\PYZus{}results}\PY{p}{]}
             \PY{c+c1}{\PYZsh{}pdists will store the smallest distances}
             \PY{n}{pdists}  \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sort}\PY{p}{(}\PY{n}{pairwise\PYZus{}dist}\PY{o}{.}\PY{n}{flatten}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{num\PYZus{}results}\PY{p}{]}
         
             \PY{c+c1}{\PYZsh{}data frame indices of the smallest distace\PYZsq{}s}
             \PY{n}{df\PYZus{}indices} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n}{data}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{n}{indices}\PY{p}{]}\PY{p}{)}
             
             \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{indices}\PY{p}{)}\PY{p}{)}\PY{p}{:}
                 \PY{n}{heat\PYZus{}map\PYZus{}w2v}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{title}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{df\PYZus{}indices}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{]}\PY{p}{,}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{title}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{df\PYZus{}indices}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{medium\PYZus{}image\PYZus{}url}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{df\PYZus{}indices}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{n}{indices}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{indices}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{weighted}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                 \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ASIN :}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{asin}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{df\PYZus{}indices}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]}\PY{p}{)}
                 \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Brand :}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{brand}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{df\PYZus{}indices}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]}\PY{p}{)}
                 \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{euclidean distance from input :}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{pdists}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
                 \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{=}\PY{l+s+s1}{\PYZsq{}}\PY{o}{*}\PY{l+m+mi}{125}\PY{p}{)}
         
         \PY{n}{weighted\PYZus{}w2v\PYZus{}model}\PY{p}{(}\PY{l+m+mi}{12566}\PY{p}{,} \PY{l+m+mi}{20}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_83_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00JXQB5FQ
Brand : Si Row
euclidean distance from input : 0.00390625
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_83_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00JXQASS6
Brand : Si Row
euclidean distance from input : 4.0638885
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_83_4.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00JXQCWTO
Brand : Si Row
euclidean distance from input : 4.770942
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_83_6.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00JXQAFZ2
Brand : Si Row
euclidean distance from input : 5.360161
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_83_8.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00JXQAUWA
Brand : Si Row
euclidean distance from input : 5.6895237
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_83_10.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00JXQAO94
Brand : Si Row
euclidean distance from input : 5.6930213
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_83_12.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00JXQCUIC
Brand : Si Row
euclidean distance from input : 5.8934426
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_83_14.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B015H41F6G
Brand : KINGDE
euclidean distance from input : 6.13299
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_83_16.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B073R5Q8HD
Brand : Colosseum
euclidean distance from input : 6.2567067
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_83_18.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B074P8MD22
Brand : Edista
euclidean distance from input : 6.3922043
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_83_20.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00C0I3U3E
Brand : Stanzino
euclidean distance from input : 6.414901
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_83_22.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B073R4ZM7Y
Brand : Colosseum
euclidean distance from input : 6.45096
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_83_24.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B01C6ORLDQ
Brand : 1 Mad Fit
euclidean distance from input : 6.4634094
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_83_26.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B06XBY5QXL
Brand : Liz Claiborne
euclidean distance from input : 6.5392237
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_83_28.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B071YF3WDD
Brand : Merona
euclidean distance from input : 6.575504
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_83_30.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00H8A6ZLI
Brand : Vivian's Fashions
euclidean distance from input : 6.6382155
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_83_32.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00Z6HEXWI
Brand : Black Temptation
euclidean distance from input : 6.660737
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_83_34.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00ILGH5OY
Brand : Ralph Lauren Active
euclidean distance from input : 6.6839056
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_83_36.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B06Y1VN8WQ
Brand : Black Swan
euclidean distance from input : 6.7057643
=============================================================================================================================

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_83_38.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00KSNTY7Y
Brand : Anna-Kaci
euclidean distance from input : 6.706125
=============================================================================================================================

    \end{Verbatim}

    \subsubsection{Weighted similarity using brand and
color.}\label{weighted-similarity-using-brand-and-color.}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}24}]:} \PY{c+c1}{\PYZsh{} some of the brand values are empty. }
         \PY{c+c1}{\PYZsh{} Need to replace Null with string \PYZdq{}NULL\PYZdq{}}
         \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{brand}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{fillna}\PY{p}{(}\PY{n}{value}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Not given}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True} \PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} replace spaces with hypen}
         \PY{n}{brands} \PY{o}{=} \PY{p}{[}\PY{n}{x}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZhy{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{brand}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{]}
         \PY{n}{types} \PY{o}{=} \PY{p}{[}\PY{n}{x}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZhy{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{product\PYZus{}type\PYZus{}name}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{]}
         \PY{n}{colors} \PY{o}{=} \PY{p}{[}\PY{n}{x}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZhy{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{color}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{]}
         
         \PY{n}{brand\PYZus{}vectorizer} \PY{o}{=} \PY{n}{CountVectorizer}\PY{p}{(}\PY{p}{)}
         \PY{n}{brand\PYZus{}features} \PY{o}{=} \PY{n}{brand\PYZus{}vectorizer}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{brands}\PY{p}{)}
         
         \PY{n}{type\PYZus{}vectorizer} \PY{o}{=} \PY{n}{CountVectorizer}\PY{p}{(}\PY{p}{)}
         \PY{n}{type\PYZus{}features} \PY{o}{=} \PY{n}{type\PYZus{}vectorizer}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{types}\PY{p}{)}
         
         \PY{n}{color\PYZus{}vectorizer} \PY{o}{=} \PY{n}{CountVectorizer}\PY{p}{(}\PY{p}{)}
         \PY{n}{color\PYZus{}features} \PY{o}{=} \PY{n}{color\PYZus{}vectorizer}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{colors}\PY{p}{)}
         
         \PY{n}{extra\PYZus{}features} \PY{o}{=} \PY{n}{hstack}\PY{p}{(}\PY{p}{(}\PY{n}{brand\PYZus{}features}\PY{p}{,} \PY{n}{type\PYZus{}features}\PY{p}{,} \PY{n}{color\PYZus{}features}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{tocsr}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}25}]:} \PY{k}{def} \PY{n+nf}{heat\PYZus{}map\PYZus{}w2v\PYZus{}brand}\PY{p}{(}\PY{n}{sentance1}\PY{p}{,} \PY{n}{sentance2}\PY{p}{,} \PY{n}{url}\PY{p}{,} \PY{n}{doc\PYZus{}id1}\PY{p}{,} \PY{n}{doc\PYZus{}id2}\PY{p}{,} \PY{n}{df\PYZus{}id1}\PY{p}{,} \PY{n}{df\PYZus{}id2}\PY{p}{,} \PY{n}{model}\PY{p}{)}\PY{p}{:}
             
             \PY{c+c1}{\PYZsh{} sentance1 : title1, input apparel}
             \PY{c+c1}{\PYZsh{} sentance2 : title2, recommended apparel}
             \PY{c+c1}{\PYZsh{} url: apparel image url}
             \PY{c+c1}{\PYZsh{} doc\PYZus{}id1: document id of input apparel}
             \PY{c+c1}{\PYZsh{} doc\PYZus{}id2: document id of recommended apparel}
             \PY{c+c1}{\PYZsh{} df\PYZus{}id1: index of document1 in the data frame}
             \PY{c+c1}{\PYZsh{} df\PYZus{}id2: index of document2 in the data frame}
             \PY{c+c1}{\PYZsh{} model: it can have two values, 1. avg 2. weighted}
             
             \PY{c+c1}{\PYZsh{}s1\PYZus{}vec = np.array(\PYZsh{}number\PYZus{}of\PYZus{}words\PYZus{}title1 * 300), each row is a vector(weighted/avg) of length 300 corresponds to each word in give title}
             \PY{n}{s1\PYZus{}vec} \PY{o}{=} \PY{n}{get\PYZus{}word\PYZus{}vec}\PY{p}{(}\PY{n}{sentance1}\PY{p}{,} \PY{n}{doc\PYZus{}id1}\PY{p}{,} \PY{n}{model}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}s2\PYZus{}vec = np.array(\PYZsh{}number\PYZus{}of\PYZus{}words\PYZus{}title2 * 300), each row is a vector(weighted/avg) of length 300 corresponds to each word in give title}
             \PY{n}{s2\PYZus{}vec} \PY{o}{=} \PY{n}{get\PYZus{}word\PYZus{}vec}\PY{p}{(}\PY{n}{sentance2}\PY{p}{,} \PY{n}{doc\PYZus{}id2}\PY{p}{,} \PY{n}{model}\PY{p}{)}
             
             \PY{c+c1}{\PYZsh{} s1\PYZus{}s2\PYZus{}dist = np.array(\PYZsh{}number of words in title1 * \PYZsh{}number of words in title2)}
             \PY{c+c1}{\PYZsh{} s1\PYZus{}s2\PYZus{}dist[i,j] = euclidean distance between words i, j}
             \PY{n}{s1\PYZus{}s2\PYZus{}dist} \PY{o}{=} \PY{n}{get\PYZus{}distance}\PY{p}{(}\PY{n}{s1\PYZus{}vec}\PY{p}{,} \PY{n}{s2\PYZus{}vec}\PY{p}{)}
            
             \PY{n}{data\PYZus{}matrix} \PY{o}{=} \PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Asin}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Brand}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Color}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Product type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                        \PY{p}{[}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{asin}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{df\PYZus{}id1}\PY{p}{]}\PY{p}{,}\PY{n}{brands}\PY{p}{[}\PY{n}{doc\PYZus{}id1}\PY{p}{]}\PY{p}{,} \PY{n}{colors}\PY{p}{[}\PY{n}{doc\PYZus{}id1}\PY{p}{]}\PY{p}{,} \PY{n}{types}\PY{p}{[}\PY{n}{doc\PYZus{}id1}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{c+c1}{\PYZsh{} input apparel\PYZsq{}s features}
                        \PY{p}{[}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{asin}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{df\PYZus{}id2}\PY{p}{]}\PY{p}{,}\PY{n}{brands}\PY{p}{[}\PY{n}{doc\PYZus{}id2}\PY{p}{]}\PY{p}{,} \PY{n}{colors}\PY{p}{[}\PY{n}{doc\PYZus{}id2}\PY{p}{]}\PY{p}{,} \PY{n}{types}\PY{p}{[}\PY{n}{doc\PYZus{}id2}\PY{p}{]}\PY{p}{]}\PY{p}{]} \PY{c+c1}{\PYZsh{} recommonded apparel\PYZsq{}s features}
             
             \PY{n}{colorscale} \PY{o}{=} \PY{p}{[}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}1d004d}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{p}{[}\PY{o}{.}\PY{l+m+mi}{5}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}f2e5ff}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}f2e5d1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]} \PY{c+c1}{\PYZsh{} to color the headings of each column }
             
             \PY{c+c1}{\PYZsh{} we create a table with the data\PYZus{}matrix}
             \PY{n}{table} \PY{o}{=} \PY{n}{ff}\PY{o}{.}\PY{n}{create\PYZus{}table}\PY{p}{(}\PY{n}{data\PYZus{}matrix}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{colorscale}\PY{o}{=}\PY{n}{colorscale}\PY{p}{)}
             \PY{c+c1}{\PYZsh{} plot it with plotly}
             \PY{n}{plotly}\PY{o}{.}\PY{n}{offline}\PY{o}{.}\PY{n}{iplot}\PY{p}{(}\PY{n}{table}\PY{p}{,} \PY{n}{filename}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{simple\PYZus{}table}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             
             \PY{c+c1}{\PYZsh{} devide whole figure space into 25 * 1:10 grids}
             \PY{n}{gs} \PY{o}{=} \PY{n}{gridspec}\PY{o}{.}\PY{n}{GridSpec}\PY{p}{(}\PY{l+m+mi}{25}\PY{p}{,} \PY{l+m+mi}{15}\PY{p}{)}
             \PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{25}\PY{p}{,}\PY{l+m+mi}{5}\PY{p}{)}\PY{p}{)}
             
             \PY{c+c1}{\PYZsh{} in first 25*10 grids we plot heatmap}
             \PY{n}{ax1} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{n}{gs}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{5}\PY{p}{]}\PY{p}{)}
             \PY{c+c1}{\PYZsh{} ploting the heap map based on the pairwise distances}
             \PY{n}{ax1} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{heatmap}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{round}\PY{p}{(}\PY{n}{s1\PYZus{}s2\PYZus{}dist}\PY{p}{,}\PY{l+m+mi}{6}\PY{p}{)}\PY{p}{,} \PY{n}{annot}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
             \PY{c+c1}{\PYZsh{} set the x axis labels as recommended apparels title}
             \PY{n}{ax1}\PY{o}{.}\PY{n}{set\PYZus{}xticklabels}\PY{p}{(}\PY{n}{sentance2}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{p}{)}\PY{p}{)}
             \PY{c+c1}{\PYZsh{} set the y axis labels as input apparels title}
             \PY{n}{ax1}\PY{o}{.}\PY{n}{set\PYZus{}yticklabels}\PY{p}{(}\PY{n}{sentance1}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{p}{)}\PY{p}{)}
             \PY{c+c1}{\PYZsh{} set title as recommended apparels title}
             \PY{n}{ax1}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{n}{sentance2}\PY{p}{)}
         
             \PY{c+c1}{\PYZsh{} in last 25 * 10:15 grids we display image}
             \PY{n}{ax2} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{n}{gs}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{:}\PY{l+m+mi}{16}\PY{p}{]}\PY{p}{)}
             \PY{c+c1}{\PYZsh{} we dont display grid lins and axis labels to images}
             \PY{n}{ax2}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{k+kc}{False}\PY{p}{)}
             \PY{n}{ax2}\PY{o}{.}\PY{n}{set\PYZus{}xticks}\PY{p}{(}\PY{p}{[}\PY{p}{]}\PY{p}{)}
             \PY{n}{ax2}\PY{o}{.}\PY{n}{set\PYZus{}yticks}\PY{p}{(}\PY{p}{[}\PY{p}{]}\PY{p}{)}
             
             \PY{c+c1}{\PYZsh{} pass the url it display it}
             \PY{n}{display\PYZus{}img}\PY{p}{(}\PY{n}{url}\PY{p}{,} \PY{n}{ax2}\PY{p}{,} \PY{n}{fig}\PY{p}{)}
             
             \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}26}]:} \PY{k}{def} \PY{n+nf}{idf\PYZus{}w2v\PYZus{}brand}\PY{p}{(}\PY{n}{doc\PYZus{}id}\PY{p}{,} \PY{n}{w1}\PY{p}{,} \PY{n}{w2}\PY{p}{,} \PY{n}{num\PYZus{}results}\PY{p}{)}\PY{p}{:}
             \PY{c+c1}{\PYZsh{} doc\PYZus{}id: apparel\PYZsq{}s id in given corpus}
             \PY{c+c1}{\PYZsh{} w1: weight for  w2v features}
             \PY{c+c1}{\PYZsh{} w2: weight for brand and color features}
         
             \PY{c+c1}{\PYZsh{} pairwise\PYZus{}dist with cosine similarity}
             \PY{n}{idf\PYZus{}w2v\PYZus{}dist}  \PY{o}{=} \PY{n}{pairwise\PYZus{}distances}\PY{p}{(}\PY{n}{w2v\PYZus{}title\PYZus{}weight}\PY{p}{,} \PY{n}{w2v\PYZus{}title\PYZus{}weight}\PY{p}{[}\PY{n}{doc\PYZus{}id}\PY{p}{]}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
             \PY{n}{ex\PYZus{}feat\PYZus{}dist} \PY{o}{=} \PY{n}{pairwise\PYZus{}distances}\PY{p}{(}\PY{n}{extra\PYZus{}features}\PY{p}{,} \PY{n}{extra\PYZus{}features}\PY{p}{[}\PY{n}{doc\PYZus{}id}\PY{p}{]}\PY{p}{)}
             \PY{n}{pairwise\PYZus{}dist}   \PY{o}{=} \PY{p}{(}\PY{n}{w1} \PY{o}{*} \PY{n}{idf\PYZus{}w2v\PYZus{}dist} \PY{o}{+}  \PY{n}{w2} \PY{o}{*} \PY{n}{ex\PYZus{}feat\PYZus{}dist}\PY{p}{)}\PY{o}{/}\PY{n+nb}{float}\PY{p}{(}\PY{n}{w1} \PY{o}{+} \PY{n}{w2}\PY{p}{)}
         
             \PY{c+c1}{\PYZsh{} np.argsort will return indices of  smallest distances}
             \PY{n}{indices} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{argsort}\PY{p}{(}\PY{n}{pairwise\PYZus{}dist}\PY{o}{.}\PY{n}{flatten}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{num\PYZus{}results}\PY{p}{]}
             \PY{c+c1}{\PYZsh{}pdists will store the smallest distances}
             \PY{n}{pdists}  \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sort}\PY{p}{(}\PY{n}{pairwise\PYZus{}dist}\PY{o}{.}\PY{n}{flatten}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{num\PYZus{}results}\PY{p}{]}
         
             \PY{c+c1}{\PYZsh{}data frame indices of the smallest distace\PYZsq{}s}
             \PY{n}{df\PYZus{}indices} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n}{data}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{n}{indices}\PY{p}{]}\PY{p}{)}
             
         
             \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{indices}\PY{p}{)}\PY{p}{)}\PY{p}{:}
                 \PY{n}{heat\PYZus{}map\PYZus{}w2v\PYZus{}brand}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{title}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{df\PYZus{}indices}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{]}\PY{p}{,}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{title}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{df\PYZus{}indices}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{medium\PYZus{}image\PYZus{}url}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{df\PYZus{}indices}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{n}{indices}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{indices}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{,}\PY{n}{df\PYZus{}indices}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{df\PYZus{}indices}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{weighted}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                 \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ASIN :}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{asin}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{df\PYZus{}indices}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]}\PY{p}{)}
                 \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Brand :}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{brand}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{df\PYZus{}indices}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]}\PY{p}{)}
                 \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{euclidean distance from input :}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{pdists}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
                 \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{=}\PY{l+s+s1}{\PYZsq{}}\PY{o}{*}\PY{l+m+mi}{125}\PY{p}{)}
         
         \PY{n}{idf\PYZus{}w2v\PYZus{}brand}\PY{p}{(}\PY{l+m+mi}{12566}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{,} \PY{l+m+mi}{20}\PY{p}{)}
\end{Verbatim}


    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_87_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00JXQB5FQ
Brand : Si Row
euclidean distance from input : 0.001953125
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_87_4.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00JXQCWTO
Brand : Si Row
euclidean distance from input : 2.385471153259277
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_87_7.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00JXQASS6
Brand : Si Row
euclidean distance from input : 2.739051056088891
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_87_10.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00JXQAFZ2
Brand : Si Row
euclidean distance from input : 3.387187195004907
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_87_13.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00JXQAUWA
Brand : Si Row
euclidean distance from input : 3.5518686296362545
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_87_16.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00JXQAO94
Brand : Si Row
euclidean distance from input : 3.5536174775976805
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_87_19.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00JXQCUIC
Brand : Si Row
euclidean distance from input : 3.653828048886743
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_87_22.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00JXQCFRS
Brand : Si Row
euclidean distance from input : 4.128811645688501
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_87_25.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00JXQC8L6
Brand : Si Row
euclidean distance from input : 4.203900146665063
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_87_28.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00JV63CW2
Brand : Si Row
euclidean distance from input : 4.286586761655298
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_87_31.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B015H41F6G
Brand : KINGDE
euclidean distance from input : 4.389370597243721
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_87_34.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00JXQBBMI
Brand : Si Row
euclidean distance from input : 4.397910309018579
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_87_37.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B073R5Q8HD
Brand : Colosseum
euclidean distance from input : 4.451228965163643
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_87_40.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B074P8MD22
Brand : Edista
euclidean distance from input : 4.518977797866279
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_87_43.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00JV63QQE
Brand : Si Row
euclidean distance from input : 4.529375076474634
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_87_46.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00C0I3U3E
Brand : Stanzino
euclidean distance from input : 4.530326140761788
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_87_49.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B01ER184O6
Brand : GuPoBoU168
euclidean distance from input : 4.546817024028215
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_87_52.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B073R4ZM7Y
Brand : Colosseum
euclidean distance from input : 4.548355544448311
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_87_55.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B071YF3WDD
Brand : Merona
euclidean distance from input : 4.610627425551827
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_87_58.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B01C6ORLDQ
Brand : 1 Mad Fit
euclidean distance from input : 4.645918274287157
=============================================================================================================================

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}27}]:} \PY{c+c1}{\PYZsh{} brand and color weight =50}
         \PY{c+c1}{\PYZsh{} title vector weight = 5}
         
         \PY{n}{idf\PYZus{}w2v\PYZus{}brand}\PY{p}{(}\PY{l+m+mi}{12566}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{,} \PY{l+m+mi}{50}\PY{p}{,} \PY{l+m+mi}{20}\PY{p}{)}
\end{Verbatim}


    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_88_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00JXQB5FQ
Brand : Si Row
euclidean distance from input : 0.0003551136363636364
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_88_4.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00JXQCWTO
Brand : Si Row
euclidean distance from input : 0.43372202786532316
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_88_7.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00JXQASS6
Brand : Si Row
euclidean distance from input : 1.655093106685058
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_88_10.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00JXQAFZ2
Brand : Si Row
euclidean distance from input : 1.7729360410334245
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_88_13.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00JXQAUWA
Brand : Si Row
euclidean distance from input : 1.8028781200573059
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_88_16.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00JXQAO94
Brand : Si Row
euclidean distance from input : 1.8031960924139288
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_88_19.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00JXQCUIC
Brand : Si Row
euclidean distance from input : 1.8214161962846673
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_88_22.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00JXQCFRS
Brand : Si Row
euclidean distance from input : 1.9077768502486234
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_88_25.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00JXQC8L6
Brand : Si Row
euclidean distance from input : 1.9214293049716347
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_88_28.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00JV63CW2
Brand : Si Row
euclidean distance from input : 1.9364632349698592
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_88_31.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00JXQBBMI
Brand : Si Row
euclidean distance from input : 1.9567038799450012
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_88_34.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00JV63QQE
Brand : Si Row
euclidean distance from input : 1.9806065649370113
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_88_37.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00JV63VC8
Brand : Si Row
euclidean distance from input : 2.0121855999157043
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_88_40.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00JXQAX2C
Brand : Si Row
euclidean distance from input : 2.013351787548872
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_88_43.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00JXQC0C8
Brand : Si Row
euclidean distance from input : 2.013883348273304
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_88_46.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00JXQABB0
Brand : Si Row
euclidean distance from input : 2.0367258248579985
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_88_49.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B01ER184O6
Brand : GuPoBoU168
euclidean distance from input : 2.6562041677776853
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_88_52.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B01LZ7BQ4H
Brand : WAYF
euclidean distance from input : 2.684906782301833
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_88_55.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B01KJUM6JI
Brand : YABINA
euclidean distance from input : 2.6858381926578345
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_88_58.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B01M06V4X1
Brand : WAYF
euclidean distance from input : 2.694761948650377
=============================================================================================================================

    \end{Verbatim}

    \section{{[}10.2{]} Keras and Tensorflow to extract
features}\label{keras-and-tensorflow-to-extract-features}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}75}]:} \PY{k+kn}{from} \PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{preprocessing}\PY{n+nn}{.}\PY{n+nn}{image} \PY{k}{import} \PY{n}{ImageDataGenerator}
         \PY{k+kn}{from} \PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{models} \PY{k}{import} \PY{n}{Sequential}
         \PY{k+kn}{from} \PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{layers} \PY{k}{import} \PY{n}{Dropout}\PY{p}{,} \PY{n}{Flatten}\PY{p}{,} \PY{n}{Dense}
         \PY{k+kn}{from} \PY{n+nn}{keras} \PY{k}{import} \PY{n}{applications}
         \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{pairwise\PYZus{}distances}
         \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
         \PY{k+kn}{import} \PY{n+nn}{requests}
         \PY{k+kn}{from} \PY{n+nn}{PIL} \PY{k}{import} \PY{n}{Image}
         \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
         \PY{k+kn}{import} \PY{n+nn}{pickle}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}58}]:} \PY{c+c1}{\PYZsh{} https://gist.github.com/fchollet/f35fbc80e066a49d65f1688a7e99f069}
         \PY{c+c1}{\PYZsh{} Code reference: https://blog.keras.io/building\PYZhy{}powerful\PYZhy{}image\PYZhy{}classification\PYZhy{}models\PYZhy{}using\PYZhy{}very\PYZhy{}little\PYZhy{}data.html}
         \PY{c+c1}{\PYZsh{}Takes lot of time to compute.}
         
         \PY{c+c1}{\PYZsh{} dimensions of our images.}
         \PY{n}{img\PYZus{}width}\PY{p}{,} \PY{n}{img\PYZus{}height} \PY{o}{=} \PY{l+m+mi}{224}\PY{p}{,} \PY{l+m+mi}{224}
         
         \PY{n}{top\PYZus{}model\PYZus{}weights\PYZus{}path} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bottleneck\PYZus{}fc\PYZus{}model.h5}\PY{l+s+s1}{\PYZsq{}}
         \PY{n}{train\PYZus{}data\PYZus{}dir} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{images2/}\PY{l+s+s1}{\PYZsq{}}
         \PY{n}{nb\PYZus{}train\PYZus{}samples} \PY{o}{=} \PY{l+m+mi}{16042}
         \PY{n}{epochs} \PY{o}{=} \PY{l+m+mi}{50}
         \PY{n}{batch\PYZus{}size} \PY{o}{=} \PY{l+m+mi}{1}
         
         
         \PY{k}{def} \PY{n+nf}{save\PYZus{}bottlebeck\PYZus{}features}\PY{p}{(}\PY{p}{)}\PY{p}{:}
             
             \PY{c+c1}{\PYZsh{}Function to compute VGG\PYZhy{}16 CNN for image feature extraction.}
             
             \PY{n}{asins} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{n}{datagen} \PY{o}{=} \PY{n}{ImageDataGenerator}\PY{p}{(}\PY{n}{rescale}\PY{o}{=}\PY{l+m+mf}{1.} \PY{o}{/} \PY{l+m+mi}{255}\PY{p}{)}
             
             \PY{c+c1}{\PYZsh{} build the VGG16 network}
             \PY{n}{model} \PY{o}{=} \PY{n}{applications}\PY{o}{.}\PY{n}{VGG16}\PY{p}{(}\PY{n}{include\PYZus{}top}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,} \PY{n}{weights}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{imagenet}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{generator} \PY{o}{=} \PY{n}{datagen}\PY{o}{.}\PY{n}{flow\PYZus{}from\PYZus{}directory}\PY{p}{(}
                 \PY{n}{train\PYZus{}data\PYZus{}dir}\PY{p}{,}
                 \PY{n}{target\PYZus{}size}\PY{o}{=}\PY{p}{(}\PY{n}{img\PYZus{}width}\PY{p}{,} \PY{n}{img\PYZus{}height}\PY{p}{)}\PY{p}{,}
                 \PY{n}{batch\PYZus{}size}\PY{o}{=}\PY{n}{batch\PYZus{}size}\PY{p}{,}
                 \PY{n}{class\PYZus{}mode}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,}
                 \PY{n}{shuffle}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
         
             \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{generator}\PY{o}{.}\PY{n}{filenames}\PY{p}{:}
                 \PY{n}{asins}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{5}\PY{p}{]}\PY{p}{)}
         
             \PY{n}{bottleneck\PYZus{}features\PYZus{}train} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict\PYZus{}generator}\PY{p}{(}\PY{n}{generator}\PY{p}{,} \PY{n}{nb\PYZus{}train\PYZus{}samples} \PY{o}{/}\PY{o}{/} \PY{n}{batch\PYZus{}size}\PY{p}{)}
             \PY{n}{bottleneck\PYZus{}features\PYZus{}train} \PY{o}{=} \PY{n}{bottleneck\PYZus{}features\PYZus{}train}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{16042}\PY{p}{,}\PY{l+m+mi}{25088}\PY{p}{)}\PY{p}{)}
             
             \PY{n}{np}\PY{o}{.}\PY{n}{save}\PY{p}{(}\PY{n+nb}{open}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{16k\PYZus{}data\PYZus{}cnn\PYZus{}features.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{wb}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,} \PY{n}{bottleneck\PYZus{}features\PYZus{}train}\PY{p}{)}
             \PY{n}{np}\PY{o}{.}\PY{n}{save}\PY{p}{(}\PY{n+nb}{open}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{16k\PYZus{}data\PYZus{}cnn\PYZus{}feature\PYZus{}asins.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{wb}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{asins}\PY{p}{)}\PY{p}{)}
             
         
         \PY{n}{save\PYZus{}bottlebeck\PYZus{}features}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Downloading data from https://github.com/fchollet/deep-learning-models/releases/download/v0.1/vgg16\_weights\_tf\_dim\_ordering\_tf\_kernels\_notop.h5
 3244032/58889256 [>{\ldots}] - ETA: 5:30
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]

        ---------------------------------------------------------------------------

        KeyboardInterrupt                         Traceback (most recent call last)

        <ipython-input-58-9a7e79d6cb61> in <module>()
         39 
         40 
    ---> 41 save\_bottlebeck\_features()
    

        <ipython-input-58-9a7e79d6cb61> in save\_bottlebeck\_features()
         21 
         22     \# build the VGG16 network
    ---> 23     model = applications.VGG16(include\_top=False, weights='imagenet')
         24     generator = datagen.flow\_from\_directory(
         25         train\_data\_dir,
    

        \textasciitilde{}\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}keras\textbackslash{}applications\textbackslash{}\_\_init\_\_.py in wrapper(*args, **kwargs)
         26             kwargs['models'] = models
         27             kwargs['utils'] = utils
    ---> 28         return base\_fun(*args, **kwargs)
         29 
         30     return wrapper
    

        \textasciitilde{}\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}keras\textbackslash{}applications\textbackslash{}vgg16.py in VGG16(*args, **kwargs)
          9 @keras\_modules\_injection
         10 def VGG16(*args, **kwargs):
    ---> 11     return vgg16.VGG16(*args, **kwargs)
         12 
         13 
    

        \textasciitilde{}\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}keras\_applications\textbackslash{}vgg16.py in VGG16(include\_top, weights, input\_tensor, input\_shape, pooling, classes, **kwargs)
        207                 WEIGHTS\_PATH\_NO\_TOP,
        208                 cache\_subdir='models',
    --> 209                 file\_hash='6d6bbae143d832006294945121d1f1fc')
        210         model.load\_weights(weights\_path)
        211         if backend.backend() == 'theano':
    

        \textasciitilde{}\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}keras\textbackslash{}utils\textbackslash{}data\_utils.py in get\_file(fname, origin, untar, md5\_hash, file\_hash, cache\_subdir, hash\_algorithm, extract, archive\_format, cache\_dir)
        220         try:
        221             try:
    --> 222                 urlretrieve(origin, fpath, dl\_progress)
        223             except HTTPError as e:
        224                 raise Exception(error\_msg.format(origin, e.code, e.msg))
    

        \textasciitilde{}\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}urllib\textbackslash{}request.py in urlretrieve(url, filename, reporthook, data)
        275 
        276             while True:
    --> 277                 block = fp.read(bs)
        278                 if not block:
        279                     break
    

        \textasciitilde{}\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}http\textbackslash{}client.py in read(self, amt)
        447             \# Amount is given, implement using readinto
        448             b = bytearray(amt)
    --> 449             n = self.readinto(b)
        450             return memoryview(b)[:n].tobytes()
        451         else:
    

        \textasciitilde{}\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}http\textbackslash{}client.py in readinto(self, b)
        491         \# connection, and the user is reading more bytes than will be provided
        492         \# (for example, reading in 1k chunks)
    --> 493         n = self.fp.readinto(b)
        494         if not n and b:
        495             \# Ideally, we would raise IncompleteRead if the content-length
    

        \textasciitilde{}\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}socket.py in readinto(self, b)
        584         while True:
        585             try:
    --> 586                 return self.\_sock.recv\_into(b)
        587             except timeout:
        588                 self.\_timeout\_occurred = True
    

        \textasciitilde{}\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}ssl.py in recv\_into(self, buffer, nbytes, flags)
       1007                   "non-zero flags not allowed in calls to recv\_into() on \%s" \%
       1008                   self.\_\_class\_\_)
    -> 1009             return self.read(nbytes, buffer)
       1010         else:
       1011             return socket.recv\_into(self, buffer, nbytes, flags)
    

        \textasciitilde{}\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}ssl.py in read(self, len, buffer)
        869             raise ValueError("Read on closed or unwrapped SSL socket.")
        870         try:
    --> 871             return self.\_sslobj.read(len, buffer)
        872         except SSLError as x:
        873             if x.args[0] == SSL\_ERROR\_EOF and self.suppress\_ragged\_eofs:
    

        \textasciitilde{}\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}ssl.py in read(self, len, buffer)
        629         """
        630         if buffer is not None:
    --> 631             v = self.\_sslobj.read(len, buffer)
        632         else:
        633             v = self.\_sslobj.read(len)
    

        KeyboardInterrupt: 

    \end{Verbatim}

    \section{Visual features based product
similarity.}\label{visual-features-based-product-similarity.}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}29}]:} \PY{n}{bottleneck\PYZus{}features\PYZus{}train} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{16k\PYZus{}data\PYZus{}cnn\PYZus{}features.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{asins} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{16k\PYZus{}data\PYZus{}cnn\PYZus{}feature\PYZus{}asins.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{asins} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n}{asins}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} load the original 16K dataset}
         \PY{n}{data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}pickle}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pickels/16k\PYZus{}apperal\PYZus{}data\PYZus{}preprocessed}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{df\PYZus{}asins} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{asin}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         
         
         \PY{k+kn}{from} \PY{n+nn}{IPython}\PY{n+nn}{.}\PY{n+nn}{display} \PY{k}{import} \PY{n}{display}\PY{p}{,} \PY{n}{Image}\PY{p}{,} \PY{n}{SVG}\PY{p}{,} \PY{n}{Math}\PY{p}{,} \PY{n}{YouTubeVideo}
         
         
         \PY{c+c1}{\PYZsh{}get similar products using CNN features (VGG\PYZhy{}16)}
         \PY{k}{def} \PY{n+nf}{get\PYZus{}similar\PYZus{}products\PYZus{}cnn}\PY{p}{(}\PY{n}{doc\PYZus{}id}\PY{p}{,} \PY{n}{num\PYZus{}results}\PY{p}{)}\PY{p}{:}
             \PY{n}{doc\PYZus{}id} \PY{o}{=} \PY{n}{asins}\PY{o}{.}\PY{n}{index}\PY{p}{(}\PY{n}{df\PYZus{}asins}\PY{p}{[}\PY{n}{doc\PYZus{}id}\PY{p}{]}\PY{p}{)}
             \PY{n}{pairwise\PYZus{}dist} \PY{o}{=} \PY{n}{pairwise\PYZus{}distances}\PY{p}{(}\PY{n}{bottleneck\PYZus{}features\PYZus{}train}\PY{p}{,} \PY{n}{bottleneck\PYZus{}features\PYZus{}train}\PY{p}{[}\PY{n}{doc\PYZus{}id}\PY{p}{]}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
         
             \PY{n}{indices} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{argsort}\PY{p}{(}\PY{n}{pairwise\PYZus{}dist}\PY{o}{.}\PY{n}{flatten}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{num\PYZus{}results}\PY{p}{]}
             \PY{n}{pdists}  \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sort}\PY{p}{(}\PY{n}{pairwise\PYZus{}dist}\PY{o}{.}\PY{n}{flatten}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{num\PYZus{}results}\PY{p}{]}
         
             \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{indices}\PY{p}{)}\PY{p}{)}\PY{p}{:}
                 \PY{n}{rows} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{medium\PYZus{}image\PYZus{}url}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{title}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{asin}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{==}\PY{n}{asins}\PY{p}{[}\PY{n}{indices}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]}\PY{p}{]}
                 \PY{k}{for} \PY{n}{indx}\PY{p}{,} \PY{n}{row} \PY{o+ow}{in} \PY{n}{rows}\PY{o}{.}\PY{n}{iterrows}\PY{p}{(}\PY{p}{)}\PY{p}{:}
                     \PY{n}{display}\PY{p}{(}\PY{n}{Image}\PY{p}{(}\PY{n}{url}\PY{o}{=}\PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{medium\PYZus{}image\PYZus{}url}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{embed}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}\PY{p}{)}
                     \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Product Title: }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{title}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
                     \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Euclidean Distance from input image:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{pdists}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
                     \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Amazon Url: www.amazon.com/dp/}\PY{l+s+s1}{\PYZsq{}}\PY{o}{+} \PY{n}{asins}\PY{p}{[}\PY{n}{indices}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]}\PY{p}{)}
         
         \PY{n}{get\PYZus{}similar\PYZus{}products\PYZus{}cnn}\PY{p}{(}\PY{l+m+mi}{12566}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_93_0.jpeg}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
Product Title:  burnt umber tiger tshirt zebra stripes xl  xxl 
Euclidean Distance from input image: 0.0625
Amazon Url: www.amazon.com/dp/B00JXQB5FQ

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_93_2.jpeg}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
Product Title:  pink tiger tshirt zebra stripes xl  xxl 
Euclidean Distance from input image: 30.050072
Amazon Url: www.amazon.com/dp/B00JXQASS6

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_93_4.jpeg}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
Product Title:  yellow tiger tshirt tiger stripes  l 
Euclidean Distance from input image: 41.261078
Amazon Url: www.amazon.com/dp/B00JXQCUIC

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_93_6.jpeg}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
Product Title:  brown  white tiger tshirt tiger stripes xl  xxl 
Euclidean Distance from input image: 44.000187
Amazon Url: www.amazon.com/dp/B00JXQCWTO

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_93_8.jpeg}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
Product Title:  kawaii pastel tops tees pink flower design 
Euclidean Distance from input image: 47.38251
Amazon Url: www.amazon.com/dp/B071FCWD97

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_93_10.jpeg}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
Product Title:  womens thin style tops tees pastel watermelon print 
Euclidean Distance from input image: 47.718403
Amazon Url: www.amazon.com/dp/B01JUNHBRM

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_93_12.jpeg}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
Product Title:  kawaii pastel tops tees baby blue flower design 
Euclidean Distance from input image: 47.9021
Amazon Url: www.amazon.com/dp/B071SBCY9W

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_93_14.jpeg}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
Product Title:  edv cheetah run purple multi xl 
Euclidean Distance from input image: 48.046516
Amazon Url: www.amazon.com/dp/B01CUPYBM0

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_93_16.jpeg}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
Product Title:  danskin womens vneck loose performance tee xsmall pink ombre 
Euclidean Distance from input image: 48.101917
Amazon Url: www.amazon.com/dp/B01F7PHXY8

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_93_18.jpeg}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
Product Title:  summer alpaca 3d pastel casual loose tops tee design 
Euclidean Distance from input image: 48.118877
Amazon Url: www.amazon.com/dp/B01I80A93G

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{k}{def} \PY{n+nf}{idf\PYZus{}w2v\PYZus{}brand}\PY{p}{(}\PY{n}{doc\PYZus{}id}\PY{p}{,} \PY{n}{w1}\PY{p}{,} \PY{n}{w2}\PY{p}{,} \PY{n}{num\PYZus{}results}\PY{p}{)}\PY{p}{:}
            \PY{c+c1}{\PYZsh{} doc\PYZus{}id: apparel\PYZsq{}s id in given corpus}
            \PY{c+c1}{\PYZsh{} w1: weight for  w2v features}
            \PY{c+c1}{\PYZsh{} w2: weight for brand and color features}
        
            \PY{c+c1}{\PYZsh{} pairwise\PYZus{}dist with cosine similarity}
            \PY{n}{idf\PYZus{}w2v\PYZus{}dist}  \PY{o}{=} \PY{n}{pairwise\PYZus{}distances}\PY{p}{(}\PY{n}{w2v\PYZus{}title\PYZus{}weight}\PY{p}{,} \PY{n}{w2v\PYZus{}title\PYZus{}weight}\PY{p}{[}\PY{n}{doc\PYZus{}id}\PY{p}{]}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
            \PY{n}{ex\PYZus{}feat\PYZus{}dist} \PY{o}{=} \PY{n}{pairwise\PYZus{}distances}\PY{p}{(}\PY{n}{extra\PYZus{}features}\PY{p}{,} \PY{n}{extra\PYZus{}features}\PY{p}{[}\PY{n}{doc\PYZus{}id}\PY{p}{]}\PY{p}{)}
            \PY{n}{pairwise\PYZus{}dist}   \PY{o}{=} \PY{p}{(}\PY{n}{w1} \PY{o}{*} \PY{n}{idf\PYZus{}w2v\PYZus{}dist} \PY{o}{+}  \PY{n}{w2} \PY{o}{*} \PY{n}{ex\PYZus{}feat\PYZus{}dist}\PY{p}{)}\PY{o}{/}\PY{n+nb}{float}\PY{p}{(}\PY{n}{w1} \PY{o}{+} \PY{n}{w2}\PY{p}{)}
        
            \PY{c+c1}{\PYZsh{} np.argsort will return indices of  smallest distances}
            \PY{n}{indices} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{argsort}\PY{p}{(}\PY{n}{pairwise\PYZus{}dist}\PY{o}{.}\PY{n}{flatten}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{num\PYZus{}results}\PY{p}{]}
            \PY{c+c1}{\PYZsh{}pdists will store the smallest distances}
            \PY{n}{pdists}  \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sort}\PY{p}{(}\PY{n}{pairwise\PYZus{}dist}\PY{o}{.}\PY{n}{flatten}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{num\PYZus{}results}\PY{p}{]}
        
            \PY{c+c1}{\PYZsh{}data frame indices of the smallest distace\PYZsq{}s}
            \PY{n}{df\PYZus{}indices} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n}{data}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{n}{indices}\PY{p}{]}\PY{p}{)}
            
        
            \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{indices}\PY{p}{)}\PY{p}{)}\PY{p}{:}
                \PY{n}{heat\PYZus{}map\PYZus{}w2v\PYZus{}brand}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{title}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{df\PYZus{}indices}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{]}\PY{p}{,}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{title}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{df\PYZus{}indices}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{medium\PYZus{}image\PYZus{}url}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{df\PYZus{}indices}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{n}{indices}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{indices}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{,}\PY{n}{df\PYZus{}indices}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{df\PYZus{}indices}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{weighted}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ASIN :}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{asin}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{df\PYZus{}indices}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]}\PY{p}{)}
                \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Brand :}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{brand}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{df\PYZus{}indices}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]}\PY{p}{)}
                \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{euclidean distance from input :}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{pdists}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
                \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{=}\PY{l+s+s1}{\PYZsq{}}\PY{o}{*}\PY{l+m+mi}{125}\PY{p}{)}
        
        \PY{n}{idf\PYZus{}w2v\PYZus{}brand}\PY{p}{(}\PY{l+m+mi}{12566}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{,} \PY{l+m+mi}{20}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}38}]:} \PY{k}{def} \PY{n+nf}{idf\PYZus{}w2v\PYZus{}brand}\PY{p}{(}\PY{n}{doc\PYZus{}id}\PY{p}{,} \PY{n}{w1}\PY{p}{,} \PY{n}{w2}\PY{p}{,}\PY{n}{w3}\PY{p}{,} \PY{n}{num\PYZus{}results}\PY{p}{)}\PY{p}{:}
             \PY{c+c1}{\PYZsh{} doc\PYZus{}id: apparel\PYZsq{}s id in given corpus}
             \PY{c+c1}{\PYZsh{} w1: weight for  w2v features}
             \PY{c+c1}{\PYZsh{} w2: weight for brand and color features}
         
             \PY{c+c1}{\PYZsh{} pairwise\PYZus{}dist with cosine similarity}
             \PY{n}{idf\PYZus{}w2v\PYZus{}dist}  \PY{o}{=} \PY{n}{pairwise\PYZus{}distances}\PY{p}{(}\PY{n}{w2v\PYZus{}title\PYZus{}weight}\PY{p}{,} \PY{n}{w2v\PYZus{}title\PYZus{}weight}\PY{p}{[}\PY{n}{doc\PYZus{}id}\PY{p}{]}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
             \PY{n}{ex\PYZus{}feat\PYZus{}dist} \PY{o}{=} \PY{n}{pairwise\PYZus{}distances}\PY{p}{(}\PY{n}{extra\PYZus{}features}\PY{p}{,} \PY{n}{extra\PYZus{}features}\PY{p}{[}\PY{n}{doc\PYZus{}id}\PY{p}{]}\PY{p}{)}
             \PY{n}{cnn\PYZus{}dist} \PY{o}{=} \PY{n}{pairwise\PYZus{}distances}\PY{p}{(}\PY{n}{bottleneck\PYZus{}features\PYZus{}train}\PY{p}{,} \PY{n}{bottleneck\PYZus{}features\PYZus{}train}\PY{p}{[}\PY{n}{doc\PYZus{}id}\PY{p}{]}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
             \PY{n}{pairwise\PYZus{}dist}   \PY{o}{=} \PY{p}{(}\PY{n}{w1} \PY{o}{*} \PY{n}{idf\PYZus{}w2v\PYZus{}dist} \PY{o}{+}  \PY{n}{w2} \PY{o}{*} \PY{n}{ex\PYZus{}feat\PYZus{}dist} \PY{o}{+} \PY{n}{w3}\PY{o}{*}\PY{n}{cnn\PYZus{}dist} \PY{p}{)}\PY{o}{/}\PY{n+nb}{float}\PY{p}{(}\PY{n}{w1} \PY{o}{+} \PY{n}{w2}\PY{o}{+}\PY{n}{w3}\PY{p}{)}
             \PY{c+c1}{\PYZsh{} np.argsort will return indices of  smallest distances}
             \PY{n}{indices} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{argsort}\PY{p}{(}\PY{n}{pairwise\PYZus{}dist}\PY{o}{.}\PY{n}{flatten}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{num\PYZus{}results}\PY{p}{]}
             \PY{c+c1}{\PYZsh{}pdists will store the smallest distances}
             \PY{n}{pdists}  \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sort}\PY{p}{(}\PY{n}{pairwise\PYZus{}dist}\PY{o}{.}\PY{n}{flatten}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{num\PYZus{}results}\PY{p}{]}
         
             \PY{c+c1}{\PYZsh{}data frame indices of the smallest distace\PYZsq{}s}
             \PY{n}{df\PYZus{}indices} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n}{data}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{n}{indices}\PY{p}{]}\PY{p}{)}
             
             
         
             \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{indices}\PY{p}{)}\PY{p}{)}\PY{p}{:}
                 \PY{n}{heat\PYZus{}map\PYZus{}w2v\PYZus{}brand}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{title}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{df\PYZus{}indices}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{]}\PY{p}{,}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{title}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{df\PYZus{}indices}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{medium\PYZus{}image\PYZus{}url}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{df\PYZus{}indices}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{n}{indices}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{indices}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{,}\PY{n}{df\PYZus{}indices}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{df\PYZus{}indices}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{weighted}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                 \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ASIN :}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{asin}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{df\PYZus{}indices}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]}\PY{p}{)}
                 \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Brand :}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{brand}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{df\PYZus{}indices}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]}\PY{p}{)}
                 \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{euclidean distance from input :}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{pdists}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
                 \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{=}\PY{l+s+s1}{\PYZsq{}}\PY{o}{*}\PY{l+m+mi}{125}\PY{p}{)}
         
         \PY{n}{idf\PYZus{}w2v\PYZus{}brand}\PY{p}{(}\PY{l+m+mi}{400}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{,}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{l+m+mi}{20}\PY{p}{)}
\end{Verbatim}


    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_95_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B074PZ2W58
Brand : ASTR
euclidean distance from input : 0.001488095238095238
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_95_4.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B074P98PVP
Brand : Hip
euclidean distance from input : 4.549541746039132
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_95_7.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B0722DJVQP
Brand : Kasper
euclidean distance from input : 4.556879043579102
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_95_10.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B074P8RKKB
Brand : Chloe K.
euclidean distance from input : 4.658889588855562
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_95_13.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B072FN7DT6
Brand : Chloe K.
euclidean distance from input : 4.749432972499302
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_95_16.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B074V9KSLK
Brand : Bobeau
euclidean distance from input : 4.760968526376511
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_95_19.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B01EDYY6AI
Brand : DSQUARED2
euclidean distance from input : 4.770145870562477
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_95_22.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B0754LXQZB
Brand : Bobeau
euclidean distance from input : 4.804865337725563
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_95_25.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B01MYEW2TZ
Brand : H By Bordeaux
euclidean distance from input : 4.834496138253594
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_95_28.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B072VHJD5F
Brand : Missguided
euclidean distance from input : 4.844362258911133
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_95_31.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B072LY3PJB
Brand : Harlowe \& Graham
euclidean distance from input : 4.902442030940655
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_95_34.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B074VB3LTP
Brand : Pleione
euclidean distance from input : 4.916205360775902
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_95_37.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B074SY1Y99
Brand : Pleione
euclidean distance from input : 4.943478720528739
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_95_40.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B01LXWSQP0
Brand : Bobeau
euclidean distance from input : 4.955143792288644
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_95_43.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B01GNNWE5G
Brand : Canserin
euclidean distance from input : 4.956669035584101
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_95_46.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B01M0P91TT
Brand : Pikolai
euclidean distance from input : 4.958743413289388
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_95_49.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B07214ZT1D
Brand : Alberto Makali
euclidean distance from input : 4.965711419048681
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_95_52.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B073S7JT2W
Brand : a\_line
euclidean distance from input : 4.972126097906203
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_95_55.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B074GT5WX4
Brand : Nanon
euclidean distance from input : 4.988931383405413
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_95_58.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B072MHBFTT
Brand : Alfani
euclidean distance from input : 4.996361868722098
=============================================================================================================================

    \end{Verbatim}

    \section{COLLABARATIVE}\label{collabarative}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}40}]:} \PY{c+c1}{\PYZsh{} \PYZpc{}matplotlib inline}
         \PY{n}{plt}\PY{o}{.}\PY{n}{style}\PY{o}{.}\PY{n}{use}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ggplot}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         
         \PY{k+kn}{import} \PY{n+nn}{sklearn}
         \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{decomposition} \PY{k}{import} \PY{n}{TruncatedSVD}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}41}]:} \PY{n}{amazon\PYZus{}ratings} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{16kcollab.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{amazon\PYZus{}ratings} \PY{o}{=} \PY{n}{amazon\PYZus{}ratings}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{p}{)}
         \PY{n}{amazon\PYZus{}ratings}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}41}]:}    Unnamed: 0          userid   productid  rating   timestamp
         0           0  A2G0LNLN79Q6HR  B004GSI2OS       4  1337990400
         1           1  A2R3K1KX09QBYP  B004GSI2OS       2  1361059200
         2           2   A19PBP93OF896  B004GSI2OS       1  1363824000
         3           3  A1P0IHU93EF9ZK  B004GSI2OS       4  1390435200
         4           4  A3Q6CTO56DJ8UZ  B004GSI2OS       4  1268697600
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}42}]:} \PY{n}{popular\PYZus{}products} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{amazon\PYZus{}ratings}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{productid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rating}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{count}\PY{p}{(}\PY{p}{)}\PY{p}{)}
         \PY{n}{most\PYZus{}popular} \PY{o}{=} \PY{n}{popular\PYZus{}products}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rating}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ascending}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
         \PY{n}{most\PYZus{}popular}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}42}]:}             rating
         productid         
         B01N0R90TU    2213
         B074TTD44L    2104
         B01KJ7RUO2    1756
         B001CEVA7U    1562
         B01074L6UG    1540
         B0725BZM87    1512
         B01F5B72YA    1489
         B01MZ77O2G    1486
         B019SQ52RC    1468
         B01KOSRSMU    1409
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}43}]:} \PY{n}{most\PYZus{}popular}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{30}\PY{p}{)}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{kind} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{bar}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}43}]:} <matplotlib.axes.\_subplots.AxesSubplot at 0x18620e98ef0>
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_100_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}44}]:} \PY{c+c1}{\PYZsh{} Subset of Amazon Ratings}
         
         \PY{n}{amazon\PYZus{}ratings1} \PY{o}{=} \PY{n}{amazon\PYZus{}ratings}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{100000}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}45}]:} \PY{n}{ratings\PYZus{}utility\PYZus{}matrix} \PY{o}{=} \PY{n}{amazon\PYZus{}ratings1}\PY{o}{.}\PY{n}{pivot\PYZus{}table}\PY{p}{(}\PY{n}{values}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rating}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{userid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{productid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fill\PYZus{}value}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
         \PY{n}{ratings\PYZus{}utility\PYZus{}matrix}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}45}]:} productid              B000M6W02I  B000M9R322  B000PZMLO8  B000RIAZEG  \textbackslash{}
         userid                                                                  
         A0010876CNE3ILIM9HV0            0           0           0           0   
         A002971836EL17MBMEJ9U           0           0           0           0   
         A00341903TT44QTIBXWZC           0           0           0           0   
         A00366922BEGNXRZDBHTE           0           0           0           0   
         A00618841YOLM01K79Z8P           0           0           0           0   
         
         productid              B000VA0K5O  B0014DLE5C  B0016N8OIA  B00198OFBW  \textbackslash{}
         userid                                                                  
         A0010876CNE3ILIM9HV0            0           0           0           0   
         A002971836EL17MBMEJ9U           0           0           0           0   
         A00341903TT44QTIBXWZC           0           0           0           0   
         A00366922BEGNXRZDBHTE           0           0           0           0   
         A00618841YOLM01K79Z8P           0           0           0           0   
         
         productid              B001BKN05U  B001JJFGDC     {\ldots}      B0759ZTKSN  \textbackslash{}
         userid                                            {\ldots}                   
         A0010876CNE3ILIM9HV0            0           0     {\ldots}               0   
         A002971836EL17MBMEJ9U           0           0     {\ldots}               0   
         A00341903TT44QTIBXWZC           0           0     {\ldots}               0   
         A00366922BEGNXRZDBHTE           0           0     {\ldots}               0   
         A00618841YOLM01K79Z8P           0           0     {\ldots}               0   
         
         productid              B075B1745P  B075B2KSBX  B075BK5JGZ  B075BMN7FP  \textbackslash{}
         userid                                                                  
         A0010876CNE3ILIM9HV0            0           0           0           0   
         A002971836EL17MBMEJ9U           0           0           0           0   
         A00341903TT44QTIBXWZC           0           0           0           0   
         A00366922BEGNXRZDBHTE           0           0           0           0   
         A00618841YOLM01K79Z8P           0           0           0           0   
         
         productid              B075BNFWYV  B075BNKX6Z  B075BP359P  B075BSMDY9  \textbackslash{}
         userid                                                                  
         A0010876CNE3ILIM9HV0            0           0           0           0   
         A002971836EL17MBMEJ9U           0           0           0           0   
         A00341903TT44QTIBXWZC           0           0           0           0   
         A00366922BEGNXRZDBHTE           0           0           0           0   
         A00618841YOLM01K79Z8P           0           0           0           0   
         
         productid              B075CG1KY3  
         userid                             
         A0010876CNE3ILIM9HV0            0  
         A002971836EL17MBMEJ9U           0  
         A00341903TT44QTIBXWZC           0  
         A00366922BEGNXRZDBHTE           0  
         A00618841YOLM01K79Z8P           0  
         
         [5 rows x 4060 columns]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}46}]:} \PY{n}{ratings\PYZus{}utility\PYZus{}matrix}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}46}]:} (95485, 4060)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}47}]:} \PY{n}{X} \PY{o}{=} \PY{n}{ratings\PYZus{}utility\PYZus{}matrix}\PY{o}{.}\PY{n}{T}
         \PY{n}{X}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}47}]:} userid      A0010876CNE3ILIM9HV0  A002971836EL17MBMEJ9U  \textbackslash{}
         productid                                                 
         B000M6W02I                   0.0                    0.0   
         B000M9R322                   0.0                    0.0   
         B000PZMLO8                   0.0                    0.0   
         B000RIAZEG                   0.0                    0.0   
         B000VA0K5O                   0.0                    0.0   
         
         userid      A00341903TT44QTIBXWZC  A00366922BEGNXRZDBHTE  \textbackslash{}
         productid                                                  
         B000M6W02I                    0.0                    0.0   
         B000M9R322                    0.0                    0.0   
         B000PZMLO8                    0.0                    0.0   
         B000RIAZEG                    0.0                    0.0   
         B000VA0K5O                    0.0                    0.0   
         
         userid      A00618841YOLM01K79Z8P  A00635603LUUJQPQWSJW1  \textbackslash{}
         productid                                                  
         B000M6W02I                    0.0                    0.0   
         B000M9R322                    0.0                    0.0   
         B000PZMLO8                    0.0                    0.0   
         B000RIAZEG                    0.0                    0.0   
         B000VA0K5O                    0.0                    0.0   
         
         userid      A006691321KQETNLF2AUR  A00678552PJMSLWDEUVT2  \textbackslash{}
         productid                                                  
         B000M6W02I                    0.0                    0.0   
         B000M9R322                    0.0                    0.0   
         B000PZMLO8                    0.0                    0.0   
         B000RIAZEG                    0.0                    0.0   
         B000VA0K5O                    0.0                    0.0   
         
         userid      A0096585SGN72YC4RMDV  A0096637H8A2HR1P2MRH      {\ldots}        \textbackslash{}
         productid                                                   {\ldots}         
         B000M6W02I                   0.0                   0.0      {\ldots}         
         B000M9R322                   0.0                   0.0      {\ldots}         
         B000PZMLO8                   0.0                   0.0      {\ldots}         
         B000RIAZEG                   0.0                   0.0      {\ldots}         
         B000VA0K5O                   0.0                   0.0      {\ldots}         
         
         userid      AZZJ3Z0NP2F2O  AZZLE0BWGUCMA  AZZM0MGLACRHJ  AZZMDW27MUJR6  \textbackslash{}
         productid                                                                
         B000M6W02I            0.0            0.0            0.0            0.0   
         B000M9R322            0.0            0.0            0.0            0.0   
         B000PZMLO8            0.0            0.0            0.0            0.0   
         B000RIAZEG            0.0            0.0            0.0            0.0   
         B000VA0K5O            0.0            0.0            0.0            0.0   
         
         userid      AZZO5BF7J2MQ3  AZZOCU3SC5UPL  AZZOVA4R01IJ  AZZPXOXHYXG0F  \textbackslash{}
         productid                                                               
         B000M6W02I            0.0            0.0           0.0            0.0   
         B000M9R322            0.0            0.0           0.0            0.0   
         B000PZMLO8            0.0            0.0           0.0            0.0   
         B000RIAZEG            0.0            0.0           0.0            0.0   
         B000VA0K5O            0.0            0.0           0.0            0.0   
         
         userid      AZZQWFXGO0A0L  AZZTOUKVTUMVM  
         productid                                 
         B000M6W02I            0.0            0.0  
         B000M9R322            0.0            0.0  
         B000PZMLO8            0.0            0.0  
         B000RIAZEG            0.0            0.0  
         B000VA0K5O            0.0            0.0  
         
         [5 rows x 95485 columns]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}48}]:} \PY{n}{X}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}48}]:} (4060, 95485)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}49}]:} \PY{n}{X1} \PY{o}{=} \PY{n}{X}
\end{Verbatim}


    \section{decomposition}\label{decomposition}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}50}]:} \PY{n}{SVD} \PY{o}{=} \PY{n}{TruncatedSVD}\PY{p}{(}\PY{n}{n\PYZus{}components}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}
         \PY{n}{decomposed\PYZus{}matrix} \PY{o}{=} \PY{n}{SVD}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{X}\PY{p}{)}
         \PY{n}{decomposed\PYZus{}matrix}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}50}]:} (4060, 10)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}51}]:} \PY{n}{correlation\PYZus{}matrix} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{corrcoef}\PY{p}{(}\PY{n}{decomposed\PYZus{}matrix}\PY{p}{)}
         \PY{n}{correlation\PYZus{}matrix}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}51}]:} (4060, 4060)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}91}]:} \PY{n}{X}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{l+m+mi}{99}\PY{p}{]}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}91}]:} 'B0085N3P2E'
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}53}]:} \PY{n}{i} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{B0085N3P2E}\PY{l+s+s2}{\PYZdq{}}
         
         \PY{n}{product\PYZus{}names} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n}{X}\PY{o}{.}\PY{n}{index}\PY{p}{)}
         \PY{n}{product\PYZus{}ID} \PY{o}{=} \PY{n}{product\PYZus{}names}\PY{o}{.}\PY{n}{index}\PY{p}{(}\PY{n}{i}\PY{p}{)}
         \PY{n}{product\PYZus{}ID}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}53}]:} 99
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}55}]:} \PY{n}{correlation\PYZus{}product\PYZus{}ID} \PY{o}{=} \PY{n}{correlation\PYZus{}matrix}\PY{p}{[}\PY{n}{product\PYZus{}ID}\PY{p}{]}
         \PY{n}{correlation\PYZus{}product\PYZus{}ID}\PY{o}{.}\PY{n}{shape}
         
         \PY{n+nb}{print}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{correlation\PYZus{}product\PYZus{}ID}\PY{p}{)}\PY{p}{)}
         \PY{n}{lst}\PY{o}{=}\PY{p}{[}\PY{p}{]}
         \PY{k}{for} \PY{n}{l} \PY{o+ow}{in} \PY{n}{correlation\PYZus{}product\PYZus{}ID}\PY{p}{:}
             \PY{k}{if} \PY{n}{l}\PY{o}{\PYZgt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{:}
                 \PY{n}{lst}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{[}\PY{n}{l}\PY{p}{]}\PY{p}{)}
         
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{lst}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{lst}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
4060
[[-0.18774722580225547], [0.05651221316921171], [-0.020358025451567004], [0.5904124623765654], [-0.700374302583991], [0.07924156583351291], [0.5569729162836251], [0.18790658975980845], [-0.2837233404038768], [0.18793906663192986], [0.18792355198065155], [-0.4006773614802193], [-0.1351745711335153], [-0.024853068297633688], [-0.5160568788301938], [0.6148361452540309], [0.19977691594121968], [0.11000681178008087], [-0.05467534020868124], [0.6716947606798953], [-0.5802099240663819], [-0.7305865889547914], [-0.9482805730664474], [-0.4043965138361654], [-0.24207330248657843], [-0.7802156108939244], [0.274736930882699], [0.36127360787538304], [-0.681492107985957], [0.10123794422569488], [0.7497954394251741], [0.8404748886010461], [-0.7265095236545378], [-0.12606446505919233], [-0.9166868536200447], [-0.378632088026105], [0.2633767044332258], [0.46835005665108226], [0.3158060176416574], [0.05343105595364066], [-0.3085190978220052], [0.2320636287344373], [0.6063887739613201], [0.5466546294836445], [0.42643148364357103], [-0.9660876430476968], [-0.027582301643982704], [0.5803409612657998], [-0.356691747068623], [0.7103952268815703], [-0.29128135472046557], [-0.7823723441640549], [0.45980936518592186], [0.016987092563974907], [-0.20762770699108815], [0.3324218572766481], [-0.34163952231236067], [0.7547135750536552], [0.15441076152838937], [-0.9584884108572821], [0.16485164746178663], [-0.7995889353269778], [-0.02968546177246061], [-0.5146717311012738], [0.03212823123018998], [0.16142948817119515], [-0.6292215417915059], [-0.06929734683036948], [-0.4139539120158235], [0.14081832678511438], [-0.0773539467692635], [-0.7321811600379434], [-0.21424701738885152], [-0.5104748269682421], [0.5727091608649867], [0.1336727494136964], [-0.733977270275401], [0.09742709190802396], [0.24055142717548586], [0.02646147226649607], [0.23826660956032203], [-0.491850141725512], [0.8235567843280431], [-0.4861637816006408], [0.5064489003212499], [0.641951291045906], [-0.14662427101130163], [-0.030678021693770898], [-0.35979482984305977], [0.1761728092146692], [-0.2242792985004628], [-0.24460599037267264], [0.3158476284695762], [0.016927293458201157], [0.9297040590477197], [0.8006843890448085], [-0.344519809356195], [-0.44831545424305197], [0.18789208600050236], [1.0], [-0.022089372488344108], [-0.5262362970965727], [0.6896406357661083], [-0.3045127163981641], [-0.1380831967138977], [0.7236474267207386], [0.6337562240933854], [-0.17190317413441175], [0.27902419950039176], [0.44151132545792665], [0.5813693159147034], [-0.6364393476107868], [0.27910968286299115], [0.9946317325328604], [-0.8669109125351041], [0.08491965919308087], [0.2663669745329144], [-0.2896122454815268], [-0.5113021452962546], [0.3644197614989855], [0.39395862771284523], [-0.18357340063348113], [-0.7403959121603934], [-0.13341302621502815], [-0.20335041482376523], [0.6505888611524101], [-0.2915860277288], [-0.7955098359214137], [-0.15665320996536075], [-0.2501668634844085], [0.18023168267696557], [0.08692122519459802], [0.184279320611621], [0.7861616260602506], [-0.2802656344354002], [-0.20309594087467098], [0.7666359454095506], [0.5117197913599096], [-0.32174567523543124], [-0.1969191723982053], [0.8097929301106728], [-0.18519898723601055], [0.770312131538857], [0.302625210387708], [0.7966424538863629], [0.17970161145342917], [0.9145124993254875], [0.28969924280873555], [-0.7552191873783284], [0.4317644760475283], [0.3357449784317476], [0.7738824554874618], [0.46326840842022693], [0.2790486688461502], [0.43261862255167344], [-0.18516744952608324], [-0.20195528032746005], [0.04646890388928115], [0.022044164199416235], [0.6047496654031361], [0.9158885497179728], [0.10526202423934519], [0.300052778222784], [0.3122306095466038], [0.7350401366559923], [0.5886451707264129], [0.5511844532920765], [-0.22043827224988774], [0.020198428830237997], [-0.2786993149948957], [0.8591181061912757], [0.44914422113436037], [0.08551523349146468], [0.1672169502122702], [-0.7149512040509131], [-0.20706785889042817], [0.1742216273262507], [0.22153354935395383], [-0.3480252330148529], [0.6752492016601004], [0.293745350634441], [0.31939900342014915], [-0.12527687812077073], [0.3584276885627327], [0.1113796894232346], [0.29207066119943725], [0.5401290273895637], [-0.6061515143239972], [-0.4461756214005338], [0.06757745353920419], [0.6791638865037366], [0.5055106484731607], [0.8348260506933171], [0.2403701721932441], [-0.16352560502524108], [0.15494070681626], [-0.2872840900664565], [-0.1724501978646891], [0.13868416975660244], [0.6535044227257226], [0.6465408937567936], [-0.7467329591537127], [0.38278852191252233], [0.8806914731374699], [0.710906726074097], [0.164694769181575], [-0.44477224354431105], [-0.06408461302746546], [0.10942936265052172], [-0.4298529171905601], [0.3591165306526045], [-0.6950487259510918], [0.247912643749775], [0.17988414303896152], [-0.27568810175806674], [0.3094774644038868], [0.07594503173151367], [0.5098472931926611], [-0.7743653472572352], [-0.07590598197533832], [0.1797024129896838], [0.25204175225104003], [0.6535463753190384], [0.11513664799158035], [-0.0952177440568291], [-0.7361473504620129], [0.12511962772235813], [0.7684018648845646], [-0.16271404904919617], [0.7074882245082571], [0.6671092937671015], [-0.10295191975213874], [0.2922594975893916], [0.1796938558493161], [-0.8079333394611974], [0.2263388071448991], [0.15489341308140098], [0.3418483965850497], [0.3514349944060502], [0.2520681797473042], [0.75624546924866], [-0.45569408882322576], [-0.21061326363505023], [-0.018249903378858564], [-0.6024642564253975], [0.6409487982797757], [-0.8944043747476026], [0.4981915717714822], [0.4512659878469194], [0.0035709238275577547], [-0.030748812428988324], [0.25465680150185277], [0.1796079366227305], [0.22540632347187567], [-0.5459863998098184], [-0.7172503225465738], [0.9156129370869412], [0.3728926658147901], [-0.47282040621711835], [0.3613496434333343], [-0.3603038976235596], [0.5654492873574507], [-0.7061473749451769], [-0.0069144391675275115], [-0.14652737407018093], [-0.21438469024586124], [-0.24870947496872478], [0.33301606817355267], [0.2015439062423923], [-0.025991973040566527], [-0.3958083895467793], [0.00518520497863548], [-0.06033379524063566], [-0.8727490260184753], [-0.4560579777018461], [-0.616757508904951], [-0.8133435004813759], [0.2585428661857518], [-0.5400538225842829], [-0.18048988208840538], [-0.1372133594713857], [0.159157884032607], [0.599280935215885], [0.10644595017047875], [-0.05702132606603636], [0.25477819312230965], [0.3685688905520157], [0.12582717220839043], [0.18799921227071978], [0.36838889164911054], [0.5979334340842459], [-0.4505728359382258], [0.23792170979728752], [-0.7413273259027866], [0.5211677060609395], [0.8924226416303875], [0.0037084492735008495], [0.3144958835017736], [-0.5621281839989388], [-0.7529249440571417], [-0.6833772782233479], [0.11706205873283573], [0.12987787019403388], [0.23031173842474068], [-0.30369827644372316], [0.7577553119960722], [0.22173020637921861], [0.347780059845799], [-0.04739716444048863], [0.08747583433715769], [0.8163900590056723], [0.4230335643772344], [0.8347619747943659], [0.46994273750560966], [-0.5055263100031175], [0.4374766969958129], [-0.7137405636603453], [-0.3888561324651214], [-0.6856383516775736], [0.6396674415024038], [-0.15037209992925682], [-0.13245526337771066], [-0.8572627665288534], [-0.14483479612751188], [0.39724834894890115], [0.4316580165961593], [0.5178797343979469], [0.14616075888263244], [0.6535149588660992], [-0.5044711493933941], [-0.008064295451596804], [-0.7177526118592767], [0.5933208602119394], [0.6507867498754736], [0.16429549073036467], [-0.5267194085086229], [-0.6733862380692843], [0.08315858247647519], [-0.275504149388356], [-0.8409582814474416], [0.3657524401191326], [0.24019175654585015], [-0.36442457319865357], [-0.8125938267123083], [0.1719328932959513], [0.8603284959601658], [-0.28213068887354437], [0.7682798293314851], [0.7068039965316327], [-0.6147140437224508], [-0.04449435886067856], [-0.5186195094359405], [0.3789247724019059], [-0.33989585662511457], [0.0871263253164725], [-0.10544758591378477], [-0.6714208626923523], [0.17969969256297522], [-0.6882514564058899], [0.5508178041800904], [0.2457556394484571], [0.42813339353286783], [0.1495726170371204], [0.5592491790685501], [0.18930230877033485], [0.2547143202340721], [0.32917258451514164], [0.3809307488484308], [0.2563193759596177], [0.1344896998792005], [0.19455892332155225], [0.17870858852100024], [0.08160674648181497], [0.6289391393889412], [-0.8380362043735925], [0.7901442833541246], [-0.6182170587215414], [0.4344702764805214], [0.12550502113924109], [-0.6932600994451368], [0.07450345380783122], [0.28711864428382955], [0.461549937516397], [0.10717632185394435], [-0.5278581684140027], [-0.024748176707448048], [0.03966749401778593], [0.18790054324213773], [0.1719359878007114], [0.3592324445111426], [-0.018412323154441468], [-0.5166077360632864], [-0.34846048643550076], [-0.5786676017422754], [0.7893955774668452], [0.7542496096294689], [-0.5855552094953339], [-0.6406667253579866], [-0.35801059656483697], [0.28552626136348613], [0.18585104302840028], [0.048429765918485294], [0.2064424682850903], [-0.7568213354803243], [0.08645337295066217], [0.6663273269092396], [0.17978169879538766], [-0.07711788663051297], [-0.3770583491446251], [-0.192611557955278], [0.35689622195680176], [-0.3940793636478851], [0.3423939512849011], [0.8722673567008933], [0.1650062309444713], [0.07132664638703103], [-0.7021746341103801], [-0.6486175782760056], [0.7480407526771181], [0.08027666903399662], [-0.9396872119752103], [-0.5338654730243277], [0.39127309506902425], [0.10981261114023765], [0.4474907347377129], [-0.5243160981079438], [-0.3241552329197946], [0.600741967462372], [0.282526955079745], [0.35541218921596623], [-0.4984387355590223], [0.15423603116305848], [0.6687566858000961], [-0.9214667473736043], [-0.1909528829211493], [0.592351492277851], [-0.4177009364053529], [0.28045551562434556], [0.42914422625589466], [0.18601917564976278], [0.5600498071629475], [0.3727112534335701], [-0.5715888184851529], [0.2377475878396218], [0.6278098820293103], [-0.1505883642084818], [0.20524319288937712], [0.4653776352303682], [0.256844901901945], [0.38978005947471833], [-0.03826744485301289], [0.4521540049908408], [0.2860029154908509], [0.021139784016369338], [0.017428425957554745], [-0.8358039350537563], [0.7348479573032757], [-0.31271979049471454], [-0.6587448626229588], [0.7369695234206844], [0.5079404680565398], [0.45113233652378143], [-0.34377120340130124], [0.3678026465650142], [0.6534480713130199], [-0.6201198782280735], [-0.6820617517365889], [0.7593247046887609], [-0.2817149482676104], [0.35914982921422145], [0.3268685929779592], [-0.14093700943625742], [0.18976006175282698], [0.4137124059079004], [0.54682647438241], [0.5149756600570748], [-0.4916448623620142], [0.5580863411711842], [0.379071848378504], [0.6680804788860348], [0.3403383247468479], [-0.5046757822314547], [-0.24707413920860818], [-0.03200022082468107], [-0.46791873787251653], [0.6863510244259089], [0.12272910920987835], [-0.9018351195479586], [0.5902626820194096], [-0.27093412125955363], [0.4244387765342041], [0.37423086809931994], [0.4149503122007466], [-0.8561875269978723], [-0.22699569967891214], [0.5656358246190993], [-0.6400654778255673], [-0.4946177212518928], [-0.5950613507512383], [-0.5696283181222673], [-0.4303486903659509], [-0.6882203934567641], [0.5009667507428042], [0.19292926940359068], [0.18092073389814603], [-0.1844540629527569], [0.45536385975063987], [-0.5173191805022253], [-0.4333368985396514], [0.520248863321044], [-0.7265580976502167], [-0.550783461070633], [-0.5649428229580294], [0.6555299529324495], [0.18842788418081236], [0.15124087824537083], [0.8689647827291496], [0.7973928092381294], [0.7361751860579626], [-0.5104730416026061], [0.5761827778572045], [-0.23125608751926024], [0.12327536640337161], [-0.49983713918384626], [-0.507778504929422], [0.27033170114013044], [-0.29700013787761187], [-0.5324468630685597], [0.3728949810923374], [0.11623954437429845], [0.23579588906738128], [-0.36466010332560433], [-0.47234218671477085], [-0.33611526096292643], [0.20306113870972295], [0.7384420171062375], [0.11175760202171878], [0.13706059762103534], [0.7088449969605977], [0.7671633214768361], [0.24005496539072602], [0.08492842671739169], [-0.44673229079829657], [0.2636591189200443], [0.3237091401065328], [0.4993709194751227], [-0.7565553207838872], [-0.5210378720076754], [0.05150846231095169], [0.7520333220870178], [0.5103603217148796], [-0.48450181680070803], [0.423322788794121], [-0.6555423146461072], [-0.16143021774973168], [0.290448806566474], [0.6591723013609956], [-0.6115754974859943], [0.22406052170768584], [0.3620636787645313], [0.35097401009490614], [-0.6721041134560629], [0.08785169129183097], [-0.5338187590947512], [0.8826847147881663], [-0.3733394075363199], [-0.18684678671531843], [0.19092525817569303], [0.2545033439171404], [0.5914992382803981], [0.18790364519786007], [-0.449621578651869], [-0.2423050618439107], [-0.7347534648272595], [-0.8376642674764369], [0.02329949949837804], [0.5076542679155828], [0.2563322974593958], [0.6397984956482006], [0.08821013981183472], [0.3729485498311384], [-0.4025483075805119], [0.22848644163635518], [0.8422239659125837], [0.4518382823385056], [-0.5644183270895496], [0.6626185713620913], [0.18895400780966276], [0.04566319330036046], [0.33507746706517844], [0.7571576252837762], [0.7974706802078884], [0.12814082393337986], [0.1318701614859165], [0.199965605515274], [0.6768805704170912], [0.7347503117287676], [-0.15750812396849945], [-0.4695908363965198], [-0.6853904988631501], [0.1798972170526034], [-0.367080900046813], [-0.6210803241254944], [-0.08753313542051265], [0.02775638458861764], [0.29239399532975346], [0.6428891213452148], [0.5433670533754711], [-0.6787082645793041], [0.63392245734116], [-0.5308631248631209], [0.7334754640721143], [0.6057547832338126], [-0.41995377987573745], [0.5800321449110057], [-0.23692633322412082], [-0.41820699833034547], [-0.3657591560548738], [0.778257458841585], [0.1878836524280098], [-0.6903600813082266], [0.18791101782476444], [-0.5348683893563035], [0.4730540879522534], [-0.4067792994299688], [-0.5214683112383391], [0.4713268598031016], [0.19015555436792186], [-0.2869609251788545], [0.15915758131790428], [-0.18947345861574225], [-0.14986436062022288], [0.6128133523326595], [0.27253332739018227], [0.3816971590220768], [-0.6780909368104108], [-0.023607977210945506], [0.8310983552131842], [0.1881607043826668], [0.6728441776674905], [0.02290744651134846], [-0.45788202156390584], [-0.5060902650468088], [-0.38963360305605654], [0.25515839632748644], [0.004359999901989538], [-0.26001491706424334], [0.30112051983730365], [0.5222993893236005], [0.8025535220772054], [-0.46802679721760304], [-0.5818350052251033], [-0.824190606139115], [-0.38992996360721577], [-0.3977901552236335], [0.2680669857134143], [-0.23845778742207402], [-0.8297242483689323], [0.255760950675876], [-0.8659574568406575], [-0.6670647300156236], [0.19167900989162417], [0.43257668657763154], [-0.527646854345113], [0.10686822643173789], [-0.5698077538564373], [-0.43299425572548295], [0.5361491794235481], [0.4383614364436267], [0.3531652816897006], [-0.29716357932557114], [-0.11800529273242605], [0.4300945402245274], [0.08464562751455841], [0.018380650760983323], [0.15006116581766327], [0.5922239418103153], [0.1704332417344348], [0.1945758684828539], [0.18061810623814156], [-0.7039532317927443], [0.17797823791084094], [0.18789698688876888], [-0.5009509509393154], [0.7853254375274974], [-0.9055790653928733], [0.3698809300767035], [-0.5041318186877217], [0.88037612844094], [-0.199605883416801], [-0.6666167046869795], [-0.7702471572005744], [-0.679231970534199], [-0.31804335147335866], [0.277194757489701], [0.35699040741203064], [-0.5251269078137031], [0.41633290294866715], [-0.7589838967029596], [0.015833202507196154], [0.1720659871715327], [0.23329037927214316], [0.5106774561347482], [-0.37899834721429737], [0.2621009000561397], [0.21749926710838996], [0.9279553839512437], [-0.3127908325221476], [0.7300314126975166], [-0.5070473865934872], [-0.058556980954510195], [-0.4166255439120248], [0.16906102746118307], [-0.8893201427690184], [0.1906892922542785], [0.43231817235649034], [-0.42426071628082157], [-0.6471348448209898], [0.1786735381124711], [-0.7577089369521862], [0.021364940196010804], [0.773931337967142], [-0.4302789886871392], [-0.2942871042615507], [-0.38192023066747915], [0.2807032381108259], [-0.7229638018409211], [0.41608283495056597], [-0.03772770317721005], [0.2780497974639221], [-0.36839203884818383], [-0.19018438725724174], [0.7771113597820496], [0.8980227960635596], [0.733716455902645], [0.18728454585267632], [0.2548691454511655], [-0.6808215863405035], [0.31657756410779886], [0.2962548098581513], [0.06800589110968114], [0.6469070638437971], [-0.5635077298952328], [-0.5984071766989795], [0.2929782094805606], [0.8380952144896842], [-0.32740928900024335], [-0.4866114387912867], [-0.7100041553657742], [0.6316459130468177], [0.5246240307295817], [-0.6415001922503962], [-0.47217016351431607], [-0.04636297839078131], [-0.3660717492336051], [0.6478910223539919], [0.17700174406218752], [0.39707757235517], [0.18360427108242613], [0.2713011789776052], [-0.21129634495192132], [-0.1336943508305902], [-0.1762824824245963], [0.8339199555559423], [-0.2464832908854275], [0.3414968180178119], [0.5590402696156065], [-0.34499296002801133], [0.5908004182171714], [-0.6797493133243986], [-0.04192086598347064], [-0.6335057189555552], [0.5404971580599857], [-0.667108352838169], [-0.6689301185460207], [0.3193426225593671], [0.007187831603770238], [0.5009523702518128], [0.6836823355272381], [0.30598797396217003], [-0.7202373429273935], [-0.5931953512411491], [0.40758024462466913], [0.17968304350367953], [0.725343932326798], [0.349178856709576], [-0.10773407556645466], [0.251795084865466], [-0.45226358450723225], [-0.6077076113283981], [-0.636155465978121], [-0.04207292618607271], [0.20577964077529992], [-0.3300624183534104], [0.25276261270557593], [-0.36417090122345236], [0.05683995013065725], [-0.6619787129947969], [-0.02479405258971344], [0.4119083074761567], [0.22768480046406514], [-0.48036054000707906], [0.1718116000542545], [0.26054870921338535], [-0.01995648178320526], [0.08866440133438933], [-0.4630044527301932], [-0.23930743700977228], [0.9276136681175691], [-0.396617880636711], [-0.7192794682471308], [-0.6583282883759082], [-0.3822500054559745], [-0.6784953573233083], [-0.5815273234731987], [0.02166285822094197], [-0.320664292264664], [0.23475440981972237], [-0.24245356767015575], [-0.33881630570509813], [0.8579466505700324], [0.0134244301095331], [0.7235716781660012], [0.3150209771247288], [-0.6158895342599606], [-0.3945295420061713], [-0.5425759413024988], [-0.25934465934021883], [0.650533423273977], [0.2840646972757137], [0.14306654402224814], [-0.503212928525533], [0.11612267702388038], [0.17192782306792145], [0.5215256929107818], [-0.40912888990024415], [-0.5600296052708309], [-0.03266321564534737], [-0.6178738582531864], [0.426249513212617], [0.0849118119945315], [-0.7873595002217534], [-0.37073879002217786], [0.8402886087660919], [0.1684386214390453], [-0.18808191256221274], [0.14092893507818316], [-0.7358580129050004], [-0.05640106570575576], [-0.7661295552420289], [0.4327463475428147], [-0.020431550652695623], [0.1114243032448103], [-0.8123059370057769], [-0.6501641151835023], [-0.6458049071877986], [-0.8578810368078309], [-0.49609106711988243], [0.7269655190877408], [-0.0730558657318351], [-0.3928746776996856], [0.3151918260163895], [0.6855586679197706], [0.8077159723178603], [-0.28661265098000416], [-0.38582786403989167], [-0.15327306948992403], [0.2546626520063655], [0.18848977300802208], [0.24255454378109007], [-0.5278173137465036], [-0.7905294603214801], [-0.5073781803090197], [-0.7719464942406982], [0.2532902501518148], [0.35751247227377303], [0.6663130098940526], [0.016986068116536322], [-0.04507416263826142], [0.02264408061343778], [0.005839194159256363], [0.27927494040033957], [0.17969933490347448], [0.09056689367204207], [0.35298839050955094], [-0.6253204927027086], [0.26860355766311106], [-0.5129761876447937], [-0.43492531032469417], [-0.05123176307772753], [-0.05303647461003725], [-0.740434742796331], [0.30160809016368906], [0.17193653914431076], [0.12863660607812294], [0.5382197560592187], [0.8209937577566014], [-0.3667469880706648], [0.16778886279367583], [0.16505830147415287], [0.665364511822924], [0.4564391599446234], [-0.5344805776038929], [-0.7296509722322807], [0.22783236824086547], [0.4864019656400513], [0.17678159961974876], [0.15936557371187096], [0.28477604017400404], [-0.5548549751983286], [0.8297674146039737], [0.5637084973951163], [-0.8079941964845285], [0.7865874151756579], [0.6114008904256681], [-0.3729956085996172], [0.15426412728785335], [0.19102899574852866], [-0.12849087869250608], [-0.052274447845306084], [-0.6836042504998333], [0.37509789499081475], [-0.3639916816499866], [0.7229859648061691], [-0.4835880634067739], [0.27524809748560447], [0.13522559433666234], [0.05722433883048604], [0.7943352675977993], [-0.43804833539843335], [-0.05251065409743553], [0.090272233518627], [0.32640002461387924], [0.00514172176800749], [-0.9039906320590075], [0.8140113108292101], [0.48522008929302224], [0.7290049522942937], [0.5405331001446175], [-0.787329079687529], [-0.23845475596085614], [0.6122680558297788], [0.5355425466409374], [-0.25028577252238954], [0.1793604933743827], [0.7314568736590961], [0.8856679468363475], [0.5209148429353493], [-0.8729110412593756], [0.15566353513627423], [-0.6956676863266602], [-0.3605258283381204], [0.34376762719867754], [-0.21765410191391785], [0.6777155122271531], [0.37221661139743195], [0.17604090636878436], [0.18809801210750138], [0.17969260628492617], [-0.2552433948094037], [0.3224953786086265], [-0.575313639398551], [0.5242661711811649], [-0.3605468506143572], [0.291554794814849], [-0.24943233293722872], [0.6796152852473548], [0.8337910827397035], [-0.37381357140404314], [0.5525589456866589], [0.25821708894737117], [0.02887787926322552], [0.08492675206930489], [-0.3007120028502058], [0.17970201234824879], [-0.4815233497091356], [0.7700991221643301], [-0.4853585320868271], [-0.10039608547348697], [-0.7632131040426834], [0.31440365623294525], [0.9514832759459368], [-0.9474329153920005], [-0.7404356130916372], [0.40247584225269534], [0.4512890363986648], [-0.7841143119338753], [-0.7441708939251449], [-0.36424031825454367], [0.3162382703639192], [0.469408137193639], [0.18230987014485603], [-0.1106093870028682], [0.4777227289209832], [-0.20850332681256303], [-0.03651062523769355], [-0.5528948082877024], [0.29249672603328375], [0.20228080615069383], [-0.2934842217542371], [0.5393647434685142], [0.17945040956984643], [0.4319012290369399], [-0.4873891882109536], [0.08415553917459179], [0.10750038374382384], [0.6177809434727412], [-0.28650323838067643], [0.48677547894712586], [0.4263599596693093], [-0.5315362602511187], [-0.42572545419257535], [0.292955776581829], [0.7698600107178037], [-0.33606983271734636], [-0.7521088346591918], [0.3577114832275354], [0.1719378979917486], [-0.6893578375931153], [0.4012645117210388], [0.37043733431096265], [0.5045812272289504], [-0.20913479090025225], [0.31840208391594566], [0.6269784805221176], [0.4905617777422915], [-0.949373103759105], [-0.5952230792317881], [0.9008083066405096], [0.7933229337961724], [0.19333779077744268], [0.6364084944946462], [0.6249718148169546], [0.10760071686280223], [0.08487296921192458], [0.6091190239009975], [-0.8871521808427227], [0.3371517183410196], [-0.5539428346724169], [0.04807511732373819], [0.17901927022313285], [-0.6975431360977529], [0.35499133489300316], [0.3532433225511422], [-0.0034063417845888126], [0.3402397665192703], [0.07294630799407845], [0.17176860083457993], [0.29143176861228687], [-0.292930163843102], [-0.3061717404854968], [-0.9138092780691627], [-0.21575690941682593], [0.8328801234357609], [-0.34476734401173303], [0.01805274530547481], [0.5949556326511233], [0.0631762919059821], [0.3148279544252498], [0.5476977763431157], [0.14718044318504092], [0.18184870958793536], [0.3879946475620728], [0.2163464185913807], [-0.5487366916318304], [0.04707146831010022], [0.8978286446751809], [-0.19439752446072836], [0.300152696633241], [-0.26929368423749916], [0.19457127756750453], [-0.33804012903431924], [0.283988892296091], [0.04200222404697624], [-0.6616546135472051], [0.7295054656166744], [0.053461196672481406], [-0.04748419571422026], [0.5855505678075265], [-0.439643682390586], [0.9130671419656538], [-0.23646605725228684], [-0.03684777560875907], [0.1719330774979505], [0.6324491904309858], [0.1793733806794534], [0.7679014326055732], [0.20727002542281092], [0.7429633077131144], [-0.9440225183184009], [0.17198277214635835], [-0.11583406307082605], [0.1817235166526391], [0.6137222012363818], [0.2975896216561394], [0.36470367651344043], [-0.7861515090498092], [0.23344960939384507], [-0.7469111655128953], [-0.6127691870437528], [-0.28076897403139417], [-0.6003371542917527], [-0.739417628866587], [-0.27784740940504854], [-0.2543698202841407], [0.38362351237986986], [-0.4421544742996794], [0.17767973428074668], [-0.3649635042775992], [0.620758825027408], [0.7158134026848286], [0.3158004546097167], [-0.528656824364312], [0.29945599632277575], [0.6696570721983487], [0.3944711608340118], [0.857000625764883], [0.2521547115237843], [0.24647028176213456], [-0.38541038379053544], [0.2954097412918211], [-0.2652425643459235], [0.28083778649326274], [0.1581405710373208], [0.082791747367928], [-0.19050253798716935], [-0.518616348861855], [0.8910204892296528], [0.2515469945616935], [-0.32318689968638953], [0.3176491506422486], [0.393959549148679], [-0.39598320769481704], [0.1598571560740307], [-0.6476181046873561], [0.7001426230875708], [0.22336289767436898], [0.04645447344420475], [0.2580189786359841], [-0.16631399086326357], [0.18098168498085268], [0.7436214690137546], [0.00767645778711683], [0.08704681118538549], [-0.5765471708858698], [0.31755247442607554], [0.2572033622178144], [-0.2847862313433184], [0.31141591396932145], [-0.3949693879265244], [0.8344740841944074], [0.9382821866215655], [0.13678560525062808], [-0.3539540613207417], [-0.5140071792443266], [0.7580138281921835], [-0.14563239502705705], [-0.5895000168300706], [-0.37757651494698014], [0.6487601709693005], [0.06393382842324483], [-0.49523815523015796], [0.5582831750586699], [-0.5241387930738168], [0.41958179797887124], [-0.639938550354446], [-0.5545200735773798], [-0.6860745001740334], [-0.36081730078644847], [-0.4444231276447504], [0.17447456145104648], [0.2555669588513407], [0.266338869603578], [0.2404052981721326], [0.06202809985938011], [0.5224781100339035], [0.29817045257801156], [0.16714054219797544], [0.6539259990935058], [-0.5512794532894253], [0.3163050911951848], [0.2144680426525197], [-0.3761597384713552], [-0.7426983561713563], [0.4342729969519696], [0.5123019781863462], [-0.5224862250759037], [0.726324583284916], [-0.003801199055340981], [0.29542180679399827], [0.8369657145106261], [-0.4674623865118965], [0.18788690510916672], [0.9258432384669444], [-0.5200868231931773], [-0.7088626331245217], [0.17367271314274044], [0.9891606550310119], [0.22668707121079154], [-0.3550814755369465], [0.40298366939257535], [-0.1470387368798445], [-0.6392145674729977], [-0.3477484544458496], [-0.06147493197466948], [-0.4343589725286627], [-0.8131261253081794], [-0.4357498932658311], [-0.5681888971949279], [0.20753413615955255], [0.31198523645393067], [-0.07910137317170954], [0.19747784287287679], [-0.15380852477833756], [0.5255661822161073], [0.6663323454625664], [-0.4187200677923009], [-0.6673328942046824], [0.48230433115852056], [0.5101548680288388], [-0.5589984402443257], [-0.5699422754760763], [-0.779238556435711], [-0.650760585335619], [-0.030765065374249997], [0.20854824940699815], [-0.2911930847041556], [-0.12610672087689526], [0.2808750228493018], [0.08492062400043562], [-0.1694668899893933], [0.7457031558889162], [-0.23609025290281196], [0.4492165605776031], [0.10231860869301183], [0.23218104688112154], [0.3277121771709553], [-0.20597948305381356], [0.7928411793362965], [0.18096386807193862], [0.7068281991041022], [-0.07336492547800992], [0.036776548513230596], [-0.4532232883032623], [0.17193709418958386], [0.9778344668222351], [-0.8359304228348853], [-0.09164733888735273], [0.211525169795443], [0.650562656865657], [-0.10360190787867268], [0.15191672015151605], [-0.5980665390351366], [-0.8435818112084585], [0.7686114810829423], [0.23666901000765728], [0.1843593659011455], [-0.4812423628947885], [-0.8187576270845276], [-0.21152882572582649], [0.16902656864856258], [0.03747457917923797], [0.05533955902730469], [0.18788480547912767], [0.016708973675472038], [0.48933837057759205], [-0.36822224194206365], [0.6491616216264336], [0.7484101680932558], [0.1791961951338956], [0.15109194638680837], [-0.39461078525383086], [-0.7977661877015854], [-0.13701319239254348], [0.550384539579308], [-0.7420365005139262], [0.4506198109067144], [0.06882543298010563], [-0.8839276881641684], [-0.6711626536100207], [0.662296129587993], [0.8454676536984932], [-0.24019517345688066], [0.892647465408181], [-0.38347236420664965], [-0.29217700061572766], [0.5192664172394028], [0.7407575631623555], [0.5267657167182885], [0.278010857117017], [-0.6581367927335982], [-0.5571795859125641], [-0.014096707734294058], [0.4125164044796842], [0.31830281078445066], [-0.7998508047498728], [0.5126214127407462], [0.6848881032283325], [0.3776402200830417], [-0.0020108629478585945], [0.1485850731452708], [0.2528990629458447], [-0.005514855238873093], [0.33435604911069666], [-0.450204163154062], [-0.41859889701221614], [0.8682763967338599], [-0.22162251174842562], [0.7953920359337157], [0.29399980497565453], [-0.04742105023221948], [-0.23800225656322446], [0.15010359452617736], [-0.47383080244646786], [-0.191537015170617], [0.08450362704009698], [0.2114151821025511], [-0.15542243330800307], [-0.6214275632212833], [-0.324966861594779], [-0.3626362951745634], [0.13314215595063622], [0.31719106075349757], [-0.4972337235478736], [-0.6970769155640459], [0.7851372125042998], [0.8617394918624829], [0.7228034049817785], [0.5203208104876156], [0.5614433494699465], [-0.3584937799083757], [-0.3201064310557051], [0.5925739849202464], [0.34124701242718464], [-0.14292381565825593], [-0.41422262610880844], [-0.8078562593490192], [0.168283077828849], [0.17969714001845963], [0.6277331231585249], [-0.2511664040670056], [-0.7774886590044197], [0.7152776498481055], [0.8098310149469728], [0.3387366604415506], [-0.24120502051190856], [-0.8020993210499616], [-0.3099144771802111], [0.9321449510646947], [-0.14268415916200128], [-0.01352643201067578], [-0.47483286813367975], [0.6504137952180301], [0.5643168603734985], [-0.9641829721544722], [0.7361230043022962], [-0.8686319374743001], [0.4569707138044729], [-0.37606182254362863], [-0.3671413887239632], [0.6558194693079252], [-0.6225966265252516], [0.3596959963035816], [0.16297555338728492], [0.45196829429636487], [0.27923958166258867], [0.7039352425647116], [-0.6579297701738375], [0.21728754045115392], [0.09717252278656346], [-0.16134714805630124], [-0.6753711948580354], [0.7766625298410414], [0.19335152557692295], [-0.2440299867024376], [0.3531659596485115], [0.5187499791103812], [0.2555921923991093], [-0.1757559440689693], [-0.25989778374640204], [0.11642793749926249], [0.10039451653656246], [-0.48005874347030986], [0.44623328333908896], [0.3624289637832466], [0.3147535161480535], [0.21967702132248307], [0.3989982607516094], [0.004650501266852275], [-0.3332973168082413], [-0.34082680686138744], [0.6272339363453846], [-0.1435052176213882], [0.02033703993034651], [-0.3518142146644212], [-0.05661895343105395], [0.4985880837667567], [-0.5233013161989144], [-0.1402550096035858], [0.2576884925039687], [-0.47614281164850264], [0.43077684214476697], [0.5213798134283689], [0.19439230285068756], [0.6689138421039901], [0.27682170092680525], [-0.2829426933596832], [0.49887419617163997], [0.3097169415227559], [-0.7404368538243629], [0.8008922355371034], [-0.6578793445816724], [-0.5443393146958152], [0.6542889037655246], [0.7313535114050174], [1.1614118305821009e-05], [0.3734700724401167], [0.354059911138685], [0.26449600443833576], [-0.006617789944930142], [0.3158260594464339], [0.31616068214861076], [-0.8391768721687589], [-0.08734007880984787], [-0.21370397051675805], [0.09799510029018367], [-0.8913939454656372], [-0.6965820446946139], [-0.34292285982993415], [-0.10214417329529123], [0.7740916142775709], [0.7816569263312164], [0.10810950004314536], [-0.2215422277670471], [0.2694865443429694], [-0.4003400842211862], [0.018523864190876455], [0.5766916882087647], [-0.5849152168470009], [-0.7955532157449452], [-0.07432863974467709], [-0.8391512464068632], [-0.5719385178445345], [0.2698324622001819], [0.13475299602459564], [-0.28917859463667867], [0.41477087063639306], [0.020478574635478995], [-0.17312330055543426], [-0.41853840690406646], [-0.2853403826879814], [-0.7949602442086456], [-0.44943510917736396], [0.6288712503706309], [0.1867744370699322], [0.43540916408042485], [0.47736592656157595], [-0.2916953886158633], [0.18789290228579777], [-0.8044368515792361], [0.8170139205378159], [0.08621728345107427], [0.18788803689963895], [-0.26914168220066653], [-0.5324954197095858], [-0.472363437596593], [0.07412933105961797], [0.48790580136494566], [0.08570349600282738], [-0.5483656491110912], [0.4386186055685698], [-0.11385314304530021], [-0.374198274156296], [0.17969942432897673], [-0.586188187209401], [-0.32166386170527833], [-0.35928891628518306], [0.020070630127105655], [0.48345558028614344], [0.6355231962176595], [0.12653888057291005], [0.3686975494047989], [-0.34913345276017566], [-0.18205485016358472], [0.39081889088898936], [-0.3924130879565603], [-0.4733793128688563], [0.0810782496320075], [0.46306852070712595], [0.5213260005371201], [0.5967899007383697], [-0.03691231946903714], [-0.35596604072344523], [0.525829727297371], [0.3982275929693782], [-0.6382787428036926], [0.11145984199594762], [0.431438990807984], [-0.20927786525138378], [-0.5482818534213093], [0.17890904185581588], [0.2762867330954755], [-0.3736488870886622], [0.7064527432549018], [0.23494521402168875], [0.12508504179370877], [-0.3298430694597079], [0.8218672750749555], [-0.24670683061372736], [0.19456361430429397], [-0.42173556626482744], [-0.30248685291779587], [-0.4727016378437506], [0.7853081194954384], [0.3548814049079044], [-0.8402502072143558], [0.08757741046596562], [-0.6789839009292776], [0.4714340625085598], [-0.22297980643305404], [0.44626043453347364], [0.31316362452459406], [0.7516846854957929], [-0.9700153568890878], [0.6674885916721406], [0.3341976283297223], [-0.06310252892975236], [-0.22918869315947452], [0.19663899154449171], [0.5408691929364058], [0.7597410305666729], [0.17967449157823162], [0.41820644168957144], [0.049615614506039095], [0.5643217396795928], [-0.3229873241783734], [0.33382355363721833], [0.6485647355254638], [-0.5225101164480224], [0.19091846973009222], [0.7715755718539687], [0.7553678331838076], [0.2608009380412104], [-0.010390072371447031], [-0.4612947856051292], [-0.4827599898764157], [-0.2561917044984377], [0.3014699875269623], [0.04556410303543767], [0.025798328529749705], [-0.5165253794629634], [0.8163893033584841], [0.48822413183403673], [-0.36360941982634054], [-0.2936391662250955], [0.22800053994077155], [0.2547473615244576], [0.7668157450991132], [0.45235728970699624], [0.4121251148759217], [0.18562045034734398], [0.5381886808717828], [0.21989154535448918], [0.17198695260043648], [0.31855044496326423], [0.37736817788507326], [0.35396784472695175], [-0.12495216578658927], [0.596618194969026], [-0.7708197806416088], [-0.39601736730926246], [0.17084205599002458], [0.18791051486421526], [-0.45125340897374056], [-0.6999076905349824], [-0.2004090601717961], [-0.3430872865353595], [-0.18819552024047964], [0.1669407061757278], [0.4596085495279289], [-0.45234434261786605], [0.2023585909936458], [0.1879753805046839], [0.20091448818179022], [-0.7683726007265468], [-0.27892425829603756], [0.3637301506215002], [-0.38256579781452815], [0.2934663731883592], [0.16464442735033635], [0.41710292963341694], [0.7428675666575275], [0.17745859252957238], [-0.32810599045402233], [0.7856454401728643], [-0.7149719054367377], [0.09728026122270679], [-0.6472963191773874], [0.6624656952882911], [-0.7550775534404703], [0.22074432100524735], [-0.4290356568196856], [-0.055255270943880844], [-0.598111963776949], [-0.49930345371765206], [0.6856258864673148], [-0.3961824920753254], [0.6522021117735322], [0.34648277955067824], [-0.21760920287467272], [-0.18409255662677793], [0.18145375396164598], [0.18473390218162872], [0.15381748437350898], [0.1912744572431446], [-0.39606136433374595], [0.6192587769031503], [0.038725721876839224], [0.5402313282697577], [-0.7480549792117493], [0.04083963678240186], [-0.5673279928495973], [-0.5069118795216541], [0.3269384288808344], [-0.3733210741096695], [-0.812015248331798], [-0.572754750424057], [0.0715917156640847], [-0.44440615278330275], [-0.37226227432086817], [0.18812455546845325], [0.5946496908050066], [0.32703909247190993], [-0.8639966902632239], [0.017270978449304066], [0.39912341744557345], [0.5231053744445076], [0.58350377453687], [-0.18554621881486333], [0.523280776002682], [0.5777426894139644], [0.7253729268614025], [0.3420794945302651], [0.753537570218083], [-0.3946665071980673], [-0.5535562496620591], [-0.3167382072479812], [-0.48048497961541226], [0.17193743477358805], [-0.5154804043945264], [-0.5525000954383678], [0.7318205981263572], [0.377747418223195], [-0.22691932257708194], [0.4257574300445802], [0.15248899891264958], [0.06170806853253583], [-0.472370369575915], [0.4480559900975625], [0.17439642775905792], [0.5910343810597373], [0.597042648846124], [-0.6932900645585195], [-0.662295660586493], [-0.39449138184595006], [0.602048023331222], [-0.5915473984030747], [0.13316582525154055], [0.4457871460889942], [-0.34198877508402487], [-0.2877227666569753], [0.016990368814960143], [-0.7138063489389282], [-0.5846019941726771], [-0.6524059336307199], [-0.7409277766036426], [-0.6088600254949591], [0.17199984435226245], [-0.3887245248061173], [-0.5372491155390986], [0.38997179327687065], [0.527144720807743], [0.7972349971946754], [0.44034048274983556], [0.021988401285450078], [-0.2950736689768075], [0.808188896968252], [0.0639731812155434], [0.8891348349705259], [0.2616175669099973], [-0.27237341078379823], [0.4055708363025476], [0.6833105618488657], [0.18404646157991444], [-0.7874363165817665], [0.10099822331771345], [0.3212042311153326], [-0.04136456789419348], [0.41893468011925505], [-0.7493258171125882], [-0.5675767734832597], [0.7333398986918197], [-0.8669772680745662], [-0.04910481117547969], [-0.8350178417669928], [0.5565877064411247], [-0.13592971656831584], [0.3549368085499245], [-0.1520933113133799], [0.5422514874185994], [0.5555724239611048], [0.6172977876132757], [0.8403061105505949], [0.767950358773081], [0.729711559163027], [0.7737776082073338], [0.48727165449756105], [-0.6575338087873949], [-0.3253628409017801], [0.3179602907978464], [0.7828308907454892], [0.6889063780659745], [-0.6778817616118173], [-0.4618608065658131], [0.5381288133580129], [0.3518098717838938], [-0.8196374223886814], [0.011354647817952297], [0.358829296770118], [0.2823986455762441], [0.4722486956317874], [0.31523287244422443], [0.6851206074773832], [0.3610183217279631], [-0.5943715623042634], [-0.0018853965872410712], [0.46996819115923777], [-0.39057731202121065], [0.7434231267791473], [0.17193468630959657], [-0.34982122947762967], [-0.5112869997319596], [0.17314456119978347], [0.7160191083580135], [-0.029067933098860244], [-0.778456224575495], [0.08382179886551715], [-0.14477791021940717], [0.6254896349501128], [-0.8452518535963573], [0.7333398986811617], [0.9633975224943383], [0.483999772116154], [-0.02723992073606975], [-0.2525213060833677], [0.17430913489135386], [0.514897078278247], [-0.2632285457085492], [0.2915474230780432], [0.09093288847515102], [0.2769137650093074], [0.5214823694395732], [0.18788383741192657], [0.17767317205893615], [-0.2979207866153583], [-0.4731500798218635], [0.609719600324728], [0.23484608425860645], [-0.14741575771087082], [0.5625866256392685], [0.08802591039987948], [-0.21912484495858126], [0.2288837450018187], [0.2528075494203137], [-0.06888816879045324], [0.6481374116289518], [-0.44920683496343383], [0.5191156030975439], [0.2284231638032608], [-0.18689166844537883], [0.6861336252328811], [0.1481651885302711], [0.19661040242826572], [0.8546268404016121], [0.7360342074223394], [-0.5472284373052766], [0.6991104766412447], [-0.14260426113207908], [0.7203041431041959], [-0.8248749768201743], [-0.7524469783222212], [0.21953067262566459], [0.7397448014253515], [-0.5067245670468286], [-0.6784304723596105], [-0.1927830945365521], [0.24663074436987903], [0.7433136522318472], [0.5978311124133194], [-0.09667477634487986], [0.7226786638667606], [0.25952215553272723], [-0.3610726914408672], [0.7725517166321054], [0.7250648184832623], [0.47599493337141485], [-0.5475406624928209], [0.2024757716189877], [0.9238697204076902], [0.5920963695575613], [0.6053050373595518], [0.02410698297578819], [0.8045158258289176], [0.15655910613730728], [0.6778515802974501], [-0.19357954996853138], [0.15812060612977744], [0.6822194219739667], [0.16023862222566224], [-0.9488102785378741], [0.4274223476601969], [0.48624073634382725], [0.09714067003222993], [0.7255908999416549], [-0.6036396366757928], [0.7412503749093561], [0.062018569465825645], [0.6086246639487676], [-0.31584191361656544], [-0.20819581928865516], [0.8760350035325635], [0.12591710122437616], [0.29454378113252777], [-0.7877291161355381], [-0.39363189443226954], [0.07892598840329491], [-0.007788444996235436], [-0.794784508293582], [0.7538569721712743], [-0.0752101001677749], [0.20623016047363543], [0.01687705875220839], [-0.3343494828058773], [-0.2879986173399535], [0.289949158142015], [0.17970272442437527], [0.5404239692254977], [0.23048955657944153], [0.5981314937262309], [-0.26696090282516477], [-0.5516737789106184], [0.012749062268018283], [-0.4619935167581128], [-0.38871535798466006], [0.2735746062426862], [0.5488227491743474], [-0.1787996035620818], [-0.2014340496786085], [0.06459179020057228], [0.3547294268521794], [0.26567085602796203], [0.4498947885957638], [0.2938392664529904], [-0.5073692854085048], [0.4227270581225474], [-0.44113040547835364], [0.4322718186225591], [0.08492619476261637], [-0.7402937954725253], [-0.4954927196303126], [-0.705697007255475], [0.11445144433028932], [-0.05131806730037109], [-0.6213989788636168], [0.4447105436389463], [0.8538754408402084], [-0.08453352659808819], [0.19077093756717112], [0.30163515278812464], [-0.9155478948004291], [0.4208422331055539], [0.20411528892460487], [-0.7180478431585997], [0.7143303909699344], [0.0644331460334942], [0.5824321035257509], [-0.5857517677049776], [-0.5806394312148764], [-0.08256991307717684], [0.17466076194542862], [-0.0761924092700192], [-0.22530676569704824], [-0.47301766198705614], [-0.37650764485444815], [-0.23089426373456845], [0.5046069035280617], [-0.21288108225424465], [0.12699150588757901], [0.1869079247750099], [0.5691601757197944], [-0.6107976725613982], [-0.6361778085612], [-0.5833910869177508], [-0.9583796775313735], [-0.6171921684115067], [-0.029390522381020318], [0.6258692236637242], [-0.6902282067960828], [0.1591414500929942], [-0.38014230930442017], [0.4090562834004405], [0.5109391238191556], [0.7000092471559652], [0.08510527960304912], [-0.5523279758743067], [-0.3734577146503171], [-0.3464883427720159], [0.05620360999965971], [-0.8573915537639087], [0.43602232701309873], [-0.35875661671912357], [0.742948222237812], [-0.5698210187263716], [0.19598146918659565], [-0.8878759337713888], [0.07428989508966952], [0.9030052620062318], [-0.5335810916492945], [0.005415240603314787], [0.18029055750436754], [-0.9391454202137383], [-0.37068872755092414], [0.5062397174405961], [0.4460943261414893], [-0.8087711178830053], [0.017226531110039186], [0.7263610784275714], [0.3087048606910609], [-0.4770837449934449], [-0.4640219061936122], [0.3159363157612357], [0.874438812785164], [0.4560388392643805], [-0.8224956531925746], [0.8807207135651866], [-0.14625957071814746], [0.21004594009783875], [0.5058454970320757], [-0.10946230526416927], [0.5404607789300075], [-0.2741104191650533], [0.2897038054938945], [-0.5402809842745794], [0.7783079244415729], [0.30328954428278815], [0.7662406022824885], [-0.5196796272563633], [-0.3120307287079732], [0.9066974002611299], [0.2645159369497368], [0.5004477288181824], [0.5709144173658404], [0.46150065116529176], [0.33430955686055663], [0.22143214214803147], [0.17916694870901095], [0.09851669673573972], [0.19476378816384995], [-0.8968723253219696], [-0.2986556505341447], [0.11199627822240829], [-0.5044004133248537], [-0.29157973906090556], [-0.2447236810950614], [-0.05391396852206631], [0.80715656176636], [0.23731123635575277], [-0.47222682273054717], [-0.62925823237165], [-0.38761255216551266], [0.9404425766344819], [-0.09417032753984639], [0.8634269721521569], [-0.21673941936288976], [-0.0464765349774142], [0.2561901748171847], [-0.2741090671303558], [0.17193531384392083], [-0.017549048001530204], [0.2680952594933779], [0.8640860950638584], [-0.6875144909608235], [-0.2145448723935787], [-0.45928061009337673], [-0.19766420283463382], [0.2368700367093314], [0.3031039088680018], [0.5101879272436576], [0.6635714623489404], [0.21135179956288394], [-0.30448197252184417], [-0.1896530998384869], [0.19136101335126027], [-0.9300228772015581], [-0.22884773387894503], [-0.12206881247621784], [-0.14634027217625756], [0.19595024554803486], [-0.5662709190123686], [0.4324524668649037], [0.2908902826257283], [-0.36841719962997627], [0.8300437532851689], [0.5063282345562886], [0.6377871226239291], [0.08612650005777027], [-0.8417716025546189], [-0.48830589533214513], [0.18788625875534654], [0.22183914759701853], [-0.5662745106576225], [-0.4743911898229705], [-0.6730726401912736], [0.4269623613683152], [-0.15091504189516738], [-0.7404321174158582], [-0.7056746266768701], [0.17649723395073963], [0.11073811849066396], [0.6930399432089926], [0.6990292376385275], [0.2866807399096864], [0.7952710036135122], [0.6528066229310501], [0.24020244004257668], [0.023477575873442055], [-0.10847281076089657], [0.436955481751979], [0.5477888981727457], [-0.8849291115527791], [-0.019942210056435455], [0.7403175950615518], [0.4455530993614555], [-0.658970587621977], [0.25298966289950675], [-0.49083756033533493], [0.3346557808755485], [0.17653869766008715], [0.1814265849934608], [-0.4129739709808635], [0.17193789799175357], [-0.7873556379887109], [-0.8447666360703976], [-0.27097868754959065], [-0.32795277759506386], [0.22401016775180344], [-0.3255544028898628], [-0.140526176510311], [-0.1422303342876471], [-0.10710540677800612], [-0.20100047566813922], [-0.24300025411195186], [0.4388136296800664], [-0.5447063543981974], [-0.48603128664838996], [-0.6784606567287148], [-0.3264040504583885], [0.19196107970220846], [0.5203296209020776], [-0.41928697696028966], [-0.6601088172196055], [0.5005835409747467], [-0.7399902567111599], [0.5464038677348844], [-0.15581663488061168], [0.1917005473167466], [0.3018398869729597], [0.8513438503320782], [-0.5175119751022106], [-0.2380595793203569], [0.18623164580639312], [0.21301472627872728], [0.17251474892124066], [0.5786216019199264], [-0.4510801625755552], [0.029961089524920916], [0.04197931362159996], [-0.26175932875634245], [-0.267596789471156], [0.4601922789381962], [0.11808738232713598], [0.7910295469594331], [-0.38244504943978025], [0.09888325455539283], [-0.4760875667443788], [0.27389570137317604], [0.511794783343721], [-0.7167377130360733], [0.3239471928988036], [-0.2615156167150739], [-0.20226681037796293], [0.7961164051713633], [-0.43601849732219583], [-0.686105752896046], [-0.7005623531934632], [-0.2015768204919099], [0.34932233327609674], [0.021286697807020603], [-0.11825628749220864], [0.6911466064697184], [0.3625416813630811], [-0.6480031683395553], [0.2631479454731758], [-0.6225401906296136], [0.5196075896600916], [-0.740467932133173], [-0.4581412524603658], [0.17895081576161004], [0.18978577348898307], [-0.6781273235616483], [0.7021773490063935], [0.49304014636912336], [-0.1354065858365893], [0.3157970538337787], [-0.5996400509080918], [-0.2668345562849412], [-0.1982634209117065], [-0.7222914051623164], [0.27782360981537524], [0.06159223249171662], [-0.604690142305702], [-0.3387591322787398], [0.29273639345652097], [0.6469423616336694], [0.24522667030104892], [-0.6337344748023798], [0.19926415951638926], [-0.7079596997886031], [0.669584106874542], [-0.3962944560982736], [0.39474856973693206], [-0.33055088717683656], [-0.48834411196853467], [0.17967068103159475], [0.0043708228936236455], [0.23084874366911828], [0.35847303446589496], [0.5236111156768666], [0.1640163391377729], [0.76855963333227], [-0.34328312773624403], [0.32687257196255015], [-0.460644201920015], [-0.37259743182355154], [-0.5940579004149029], [-0.3221643018180217], [0.7547112676369714], [0.2508342596994027], [0.11115561030529518], [0.10475288344454428], [-0.3747284201121504], [0.862134683816974], [-0.9156969188956204], [-0.13822440666575608], [0.3596883409498472], [-0.7557628670867782], [-0.031775619059420064], [0.47881701074150373], [0.2714112011449824], [0.06933091787091065], [0.22507445466678244], [0.509628532077932], [0.7067249483340056], [0.23030813139512152], [-0.39521798173672434], [0.9344853803892114], [-0.5916539334618274], [0.26066258500027495], [-0.4413111151795716], [0.020123286174652474], [0.19395011272414903], [-0.3930743737443135], [0.018683520677640314], [-0.3993817365642507], [-0.5643572922079708], [-0.10001455731783197], [-0.7507982247078079], [-0.23763639602135214], [0.3484865134122526], [0.669593421446089], [0.7534877153560146], [0.22688762747275315], [0.023273495981979902], [0.19513770659153248], [-0.18962703434668843], [0.18880114565803852], [0.43783016984215867], [-0.6073680382108132], [-0.6526512965312438], [0.07182024532140406], [0.03110634870598652], [-0.7454258259783915], [-0.41439049349731727], [-0.33233407268256926], [0.1851270016237153], [0.4462009091587681], [-0.7536855715987943], [-0.4481356086624053], [0.15736023926514592], [0.5083667277105948], [0.16603007804971157], [0.4669460560966598], [-0.5301657370572198], [0.1317895346594452], [0.7394542367833326], [-0.14196059833910543], [-0.6861961621900207], [0.6157396552273388], [0.30167975258408813], [0.7892913994768522], [-0.7086093633572843], [0.27740082618761025], [0.27678580475075565], [0.24486199872139977], [-0.007180303883803037], [0.46368876541361476], [0.44656383149371265], [0.7621428847119539], [-0.4804419564126454], [0.2139825887504676], [0.44177331427911176], [0.1702594375370589], [0.23526133411584735], [-0.5284641020824503], [-0.10871295687207949], [-0.6036664629407463], [-0.7873652818384742], [0.4404301349248234], [0.47081313657408835], [0.4751455172823549], [0.44588876282166245], [-0.6891727525546919], [0.5473961201560755], [0.4140491901538323], [-0.26937194923955865], [-0.5491975063483858], [0.3449367154563753], [0.18933000380105589], [-0.5666682841426547], [-0.09850715952969383], [-0.7693885106691493], [-0.5855314965984356], [-0.2776914018886132], [-0.8795747176379936], [5.247441576780156e-05], [-0.034481116244954334], [-0.3559718386408112], [0.22255248367934133], [0.32264537033986534], [0.20684215735114125], [0.452202843663544], [0.08314900497690152], [0.1996351941418549], [-0.5928238014639104], [0.2417970931077313], [0.47916475454340557], [0.11731959668177515], [-0.011766543449313977], [0.17799507721572252], [-0.3846147556271919], [0.03887046309623614], [0.4322003338043627], [-0.8923013974695435], [0.16656278280895534], [0.3786637505632229], [-0.517561554860552], [0.847593469333422], [0.24027009111662412], [0.1797325722928024], [0.22217109724009326], [0.5311356654247968], [0.4434602114955977], [0.6379796796341086], [0.2571871901469986], [0.7715749302460677], [-0.6477297821994658], [0.18788480547912975], [-0.7652945608819046], [0.8564219179488208], [-0.6388692184295675], [-0.10795370667581344], [0.8052966433351381], [-0.35456766353305336], [-0.9109038656668558], [0.3664764749026777], [-0.7263279306320429], [0.3158337852590098], [0.30095718729000454], [0.07858153656964992], [-0.6313532117080622], [0.18064716385685825], [-0.18776582300866665], [-0.36490746131642615], [0.4216165997349894], [0.4323595592653024], [0.15706286685274956], [-0.8141079450002616], [0.6751858685565858], [-0.3022452703954495], [-0.9012329673306889], [-0.4103380380963995], [0.07684249957789473], [0.7292506523757865], [0.30038168407310106], [0.4362931488036893], [0.3248330144240969], [0.32184281989509994], [0.039719558505854596], [0.5630693216082053], [0.3269173622724331], [-0.09420959689426583], [0.7282378989425177], [0.4966854601274586], [-0.745648988136481], [-0.48171629368204494], [-0.8231813702167187], [-0.796525604839776], [-0.8492898634591298], [0.7616187346759421], [-0.4377410188181473], [-0.6087925639394861], [-0.5218546089902076], [0.7517911664644432], [0.08490237883003672], [0.7059002762881681], [-0.48308112115331137], [-0.23145656425688538], [-0.1411035236043484], [0.1310687976125933], [0.25788768431576364], [-0.2905086345580816], [-0.1736627396261666], [0.8908628188764619], [0.2823340542915237], [-0.750948543338911], [0.19970804542370416], [-0.4866795314150837], [-0.6784909252676825], [-0.625889504836028], [-0.7564482401604535], [0.6150346502573818], [0.11467763443725768], [-0.9187683389740613], [-0.25926747952260254], [-0.7459712170124702], [-0.526837071747206], [0.18004395029615416], [0.2813342144856287], [0.771184936900577], [-0.19619443802122788], [0.10803235807744913], [0.2546608354952219], [-0.7119967498132787], [-0.7393548458287178], [0.32976976592745], [0.6161986559930203], [0.6744401691761147], [-0.06897376691660968], [0.519250212465778], [0.2698103360416949], [-0.8644698531038915], [-0.8426099595181984], [-0.18556705233866996], [-0.7040318926899282], [0.10835648770349599], [-0.22978125626594553], [0.1723252201550436], [-0.3724937422250585], [0.4702071211899686], [0.9771793346615435], [-0.7483973236375104], [-0.06735601234688963], [-0.3226816868516036], [0.27774083512147607], [0.546397345363984], [-0.4098416361312464], [0.4150265458994166], [-0.3508583593449773], [-0.4617232975411243], [0.4419173059805204], [-0.8072765260816299], [-0.6487609529258037], [-0.6836648166212255], [-0.44731048497671855], [0.7187202641450166], [0.11906946127970713], [-0.7702954489568468], [0.9139458749028372], [-0.42929457246980807], [-0.49271497309443213], [0.061833599365274126], [0.8981352153891814], [-0.5612083254191015], [0.7683543698098507], [-0.5380312655919954], [0.7793010857110276], [0.5484974078584226], [-0.41432821580070156], [-0.38719072095012536], [-0.8559190920434093], [-0.10231042427394589], [0.1988491987408499], [0.3183211488555744], [0.0524443918519785], [-0.45408274520004605], [0.776130977811791], [0.6977520703428276], [-0.5237615320172444], [0.45576144432618987], [0.30778599354578634], [-0.7171186608951272], [0.20548105226855518], [0.14170131093676577], [-0.5267781472477951], [-0.6085629762357382], [-0.6715867241814751], [0.6779763169200015], [0.26516515159542076], [-0.1343506443433684], [0.03256813755512239], [0.2548793869757075], [0.1873277429822986], [-0.6725594740366374], [0.4376092333115105], [0.7093318941324557], [0.698102160637153], [0.6893733827687056], [0.5381659726786182], [-0.14082069294039387], [-0.3697837654045561], [-0.6761058049733285], [-0.0902710784623926], [0.4151406808864433], [0.15702599349027616], [0.17208613875390294], [-0.3203503584320392], [0.8026245615873865], [-0.7383568992738583], [0.06511389359665111], [0.7656135998162539], [0.6520574492221973], [0.13133497345322503], [-0.26384307652770417], [-0.6929962859735893], [0.16339123148575843], [-0.5503047488967936], [0.042112848419662396], [0.4954202440080707], [-0.41480648627333183], [-0.35000575310340876], [0.8001411555787692], [0.3653673941425384], [-0.7043041770461242], [-0.20024139941404953], [0.18790954239701155], [-0.07286718191531091], [-0.8196921010092626], [0.7679609731954212], [-0.5648661824499517], [0.17067120188193688], [0.18934302797844563], [-0.5770402110962178], [-0.5718039180493854], [0.17386195258017179], [0.7694136806970078], [0.772830993848599], [0.4197616760201462], [-0.13628963376238076], [-0.32604510517307467], [0.5830442269282906], [0.658979445199706], [-0.47009853150303], [-0.6350571280519134], [0.1265679182634422], [0.7260564659973459], [0.0621849444158759], [0.7921094051475006], [0.01260125668250109], [0.09347645784169999], [0.27795991290075595], [-0.46764474286350716], [-0.7026497835496688], [-0.6794972897874384], [-0.4933875866387687], [0.6534995351053233], [0.21976301838093257], [-0.2726245726996971], [0.7627227869954691], [0.2672981176600297], [-0.03870111118209355], [0.5609289625981403], [0.32071789275647544], [-0.08123336175301549], [0.1873537739012806], [0.5730810409659426], [-0.13560706408242318], [-0.19339418173771455], [0.8009875821456259], [-0.7914763808062314], [0.2823101284799996], [0.3164064859474628], [-0.17125046520634454], [0.7887950948273935], [0.5918124773236114], [0.17969646661540353], [-0.5437462789862622], [-0.4274980848727156], [0.0373641985954564], [0.09428596247550733], [0.7974111572957999], [-0.8899298850607126], [0.7884537886600161], [-0.38256247232515833], [-0.35995122379004757], [-0.6240662324497666], [0.1855838642852174], [-0.2396769586204511], [0.29526438785415193], [-0.9014110650151914], [0.16860841598441398], [0.1273612665672916], [-0.0014703942793236053], [0.18826509790095147], [0.1605795174618779], [-0.26238088808886406], [0.3428437848520261], [0.47023226660843165], [0.19780463234779824], [0.4406628012381739], [0.02684066813922993], [0.4784118491246449], [0.756341343640794], [0.258585719504927], [-0.03715295283265809], [0.18881677914761308], [-0.21216359289405523], [-0.4674025435116491], [-0.13294964128652187], [0.8825675519328009], [0.1072020281571151], [-0.2574928298854878], [-0.22851652930966151], [0.06545361654268467], [0.791158134619297], [-0.2255814947898636], [0.809791502938985], [0.24349776780314106], [0.18187317671250056], [-0.3584966452297098], [0.3254713174161346], [-0.5348656371516811], [0.6150311139125015], [0.945506644516095], [-0.29176688885326924], [0.18379329881450757], [-0.412564187872379], [-0.7609269977648442], [0.27066925891190785], [0.09811085227052191], [0.8309450093404839], [-0.27709078617694094], [-0.27015330700838], [0.42339690391450174], [-0.7404843244658901], [0.4818320783648126], [0.20445229891666764], [0.8005447987723092], [-0.5445950912052726], [-0.7874134571936362], [-0.33608001942225063], [-0.33293551528807963], [0.5652912043205343], [0.2806850027561884], [0.3884509963717226], [-0.3884172570371527], [0.22340109443918718], [0.5669562333037327], [-0.018230795634634242], [0.8463725922944866], [-0.7314617761442345], [-0.28807410408159023], [0.17519136390947154], [0.1881814141798506], [-0.0005977960187459417], [-0.051974491895594305], [0.26904497621196355], [0.23435787648667783], [0.8469494225363793], [0.2981789164505822], [0.5792706591481789], [0.44434770906473986], [0.255686400812347], [0.7955444622843483], [0.5310943403974488], [-0.7152501652703029], [0.5906042094241991], [0.29694609349947215], [0.5901938246606903], [-0.12673063482393487], [0.4707097743686079], [-0.7455371430157648], [0.3431957483366113], [-0.2353165244331364], [-0.14321587481730882], [-0.8416469055586279], [-0.5441287102508304], [0.27503842697522346], [-0.3481318828593752], [0.7673753906692788], [0.08963436722666374], [0.43417844248086845], [-0.050822770563874686], [-0.36421345333406835], [-0.7245450233826531], [-0.5729016000318239], [0.1284926431717461], [-0.3046950007739276], [-0.5479533445020374], [0.013839523528790372], [-0.43827879721601937], [-0.2162630951239137], [0.1879488993785677], [-0.09203894543615836], [-0.9145292091916278], [-0.07231438127110734], [-0.5022329728976541], [-0.02185085589747734], [0.617123851188625], [0.0007168034790746131], [0.3631408146043251], [0.12568822963570178], [-0.4598111928828487], [0.41814183273427535], [0.17199324904177282], [0.7002632602833165], [0.7461806128658643], [0.8311362729614393], [0.4507850413371589], [-0.35619395544280785], [-0.7317445556308678], [0.7330394713461931], [0.24488693850471974], [-0.20928522065918118], [0.39714173258930296], [0.7621793314668243], [0.000265776600622495], [0.5868975610791501], [0.012059038710211986], [0.3382507257170777], [0.2679473839240967], [0.45720627991439283], [0.5493191886857978], [-0.7619373701341062], [0.3836978156725711], [0.26616661083157056], [0.3598790251880941], [0.003307879188174947], [0.33818429444129955], [-0.0992095051917099], [-0.9097039124869297], [0.044351269488615265], [0.358818188444837], [-0.6554924744060379], [-0.09265819144471811], [0.21794640085729086], [0.3903422365923054], [0.548707095876252], [-0.8006339810106817], [0.346644432748853], [-0.041451445051816214], [0.14958502618711794], [0.030719505336784494], [-0.716504826361239], [0.30164406576788333], [0.01698511352454828], [0.03205792543263363], [-0.3931186230252172], [0.14445922742654024], [-0.2061312395161975], [0.09300035244037402], [-0.18641209015350702], [0.47682005723521187], [0.5750846955513197], [-0.671080010182358], [-0.02290237183836913], [0.7696080935430515], [-0.4763404761695111], [-0.9068151003133114], [0.1988444695608917], [0.7246167896135919], [0.19926161976986567], [0.5925124326295608], [0.05134971798251235], [0.012816961045850605], [0.7893965877826657], [-0.7835853706345607], [0.2319054856292281], [-0.3940689127999585], [0.4457545598670766], [-0.7005733632273339], [0.7469477110291552], [-0.6317468215858392], [0.18132930142631865], [0.2389319048309979], [0.8546976100351047], [0.07301566778403175], [0.311887057387932], [-0.5423338776257892], [0.16106801639377605], [0.19769737946919488], [-0.4099585307022118], [-0.801928717573849], [0.35926540149657893], [-0.5329692723817109], [0.7052115848357383], [-0.4812387328116617], [0.4175849663909285], [0.5813666077069577], [-0.6200457696096716], [0.17761476413846497], [-0.043448932233627426], [0.32972656707026515], [0.17754210877922202], [-0.27591972542554066], [-0.4387005002780417], [-0.603595331373707], [0.25217774939970194], [0.3151280863987989], [0.26527437689154826], [-0.09395201202076243], [0.6688617595618824], [0.2852107921359594], [-0.37044738014916895], [0.17015660786699674], [0.20603449004798202], [0.4956698283426078], [0.9530491492172121], [0.2616631534326289], [0.3622066018154995], [0.13819785774079604], [0.4231529294084599], [-0.4505423352680946], [-0.1415185274928003], [0.19818859102162187], [-0.6782480255810832], [0.18655074114529122], [0.6395091236450413], [-0.1823950284501147], [-0.7362712555940287], [0.015594442359661148], [0.08576704937399114], [0.16828407885821667], [-0.5940219768087331], [-0.32039246986685865], [-0.054606474187818305], [-0.775984901904474], [0.3838822249080123], [-0.24490391183671015], [0.2665608592059906], [0.3549443240304839], [-0.5102194632215634], [-0.3202325984853894], [-0.6696389961326009], [-0.3774615203211122], [0.35635704784743877], [0.6599025146934938], [0.19596885593177704], [-0.6112684256933372], [-0.4495939653569827], [-0.2817464140117008], [0.6067946958880165], [-0.08634687191508947], [0.6023380803965002], [-0.3426584469871357], [0.3165925673922663], [-0.26479262636189904], [0.7001700507241648], [-0.14607004456012773], [0.6282381968150286], [0.7473822599135842], [0.6508813263970369], [0.7411905735721223], [-0.0909520398248722], [0.15633677962160947], [0.23342976961941286], [0.04191014170809518], [0.19724930566921034], [-0.6070512706627079], [0.18372803948531619], [0.4012906307438312], [0.7585860988697634], [0.2243718743695735], [0.22840963383142074], [-0.31283374783800294], [0.8453862479187386], [-0.14523063257624833], [0.04882768487681351], [0.18973337613405206], [0.7370045643411799], [0.6780233115522672], [0.14532505051578234], [-0.8015858229190022], [-0.580106380731172], [0.017143697512656705], [0.5388006087638275], [0.6967303865780828], [0.6354085799914335], [0.6721832806614108], [0.7636711395921347], [0.5925187038812882], [-0.1272893442247793], [0.5300020132805132], [0.5875915830198843], [0.7185180865895869], [0.4491530821750629], [-0.5041688104853874], [0.3371339408213872], [0.18195025473922363], [0.45525542434112054], [-0.5156022887097028], [-0.6714509596405945], [0.3306969752534051], [0.7607384641042706], [0.2716663192980555], [-0.04928549432786443], [0.4545020843016183], [0.14951768950847738], [0.5670866257387231], [-0.2192994807833037], [0.2543654098108657], [-0.5943282135001065], [-0.07965460905278815], [-0.7396461996323762], [-0.6115943509665381], [-0.07730099579791634], [0.6376963718736672], [0.1797000946633149], [-0.21068474314950833], [-0.21451176216875753], [0.11712558544924108], [0.3210350551190186], [0.36681158826581267], [0.6711763985225523], [-0.009305787213538709], [0.1929144139844832], [0.7683900164602019], [0.003438193711740892], [-0.4701758696010373], [0.4563129701275135], [-0.677493176886452], [-0.5930450799850108], [0.22629685087602977], [0.3586624202730498], [0.17811807289851536], [-0.4235374841651882], [-0.7501028787017119], [0.1775526365392291], [0.4877599999051431], [0.17193619032400492], [0.5166284848546786], [0.8781312646670334], [0.05677263714233958], [-0.589112406747877], [-0.11119787338128218], [-0.454087837362818], [0.7967643900910552], [0.33262163420681695], [0.31963662291714207], [0.443252536139274], [0.0478538305815427], [0.7431227846652112], [-0.034274414161086564], [0.027190659788491396], [0.26246011819291026], [-0.2265208810638011], [-0.7178262041841834], [0.3709651034364559], [-0.690670535632578], [0.7847182725185979], [-0.6099459075209714], [0.7573409884622035], [0.27577336302237115], [0.1664756401672922], [0.9043845756105545], [-0.15011418344365066], [0.3727667174486253], [0.13703411155856016], [-0.6499157225544544], [0.6323015437518146], [0.039926349415945715], [-0.8576453890144097], [0.724042414871693], [-0.7060482325794789], [-0.8790994595204252], [0.24537974091663445], [-0.4375571440540158], [-0.36002058880534443], [-0.6675661487997645], [-0.6070576495212466], [-0.1442256646980157], [0.3226998174150729], [0.7729569801167795], [-0.6993197464005265], [-0.8168296652166454], [-0.629247316006742], [0.5275167869419981], [0.7538438099955848], [0.3848414568052556], [0.5437919292123755], [0.18144313364128437], [0.042537671213098316], [0.6219249421134619], [-0.3984359863813804], [-0.734784871620895], [0.6598161420676774], [0.2671098226489358], [0.15686295878322823], [0.20181013398328704], [0.877566866072427], [0.6229872472524088], [-0.10290676780704368], [-0.2648321344415381], [-0.6898768536023726], [-0.6367896390471641], [-0.0588217631787118], [0.14655195381280828], [0.1809077108755596], [0.19817159667930764], [0.6642640093030927], [-0.6795196050900641], [-0.7223536238163026], [-0.2643942392955316], [0.15766658364458702], [0.3964593500420152], [0.9337394188492361], [0.15374416113540865], [-0.7091557357835924], [-0.4928304365786953], [0.48877146880918504], [0.07404014824500625], [0.48855348564414114], [0.16111530377822683], [-0.3830391767749504], [-0.16575693157264595], [0.4355826160815553], [0.18071570354485936], [0.6545008944637414], [0.8155344796451294], [0.19899346490848183], [0.630475450185641], [0.7465314137214782], [0.5413410705249109], [0.341252735951732], [0.7725936551405821], [0.731107611891367], [-0.3789367426559558], [0.6576637185304537], [-0.21741858599947972], [0.07823870464218395], [-0.3819510224755198], [-0.5842903980101319], [0.6615148850211885], [0.3717548602775172], [-0.6486885941311917], [0.30880001052996764], [0.17970334683417802], [-0.05427595497869617], [0.20913345051999957], [0.16375313117855492], [-0.4808781994348059], [-0.7404365704657704], [0.6847686055467753], [0.1024883434582793], [0.3997120821459126], [-0.06883299120157411], [0.3607366812973577], [0.08923835739993592], [-0.46337538519134763], [0.19538393234922638], [-0.17535421223129447], [0.358704130676133], [0.3158733437280044], [0.48592177351045274], [0.23561652567497832], [-0.7387880637360272], [0.36964168095477845], [0.29886433017848046], [0.7870125820350649], [0.8165393159898351], [0.5984301957985477], [0.5101723598203581], [-0.49430092461753505], [-0.3305003036441697], [-0.17629042826407013], [0.3576622626920064], [0.7526653181363215], [-0.04405522935378132], [0.6981977524994588], [-0.5685315904203488], [-0.30083351920299023], [-0.12394468864186466], [-0.7957322077481588], [0.6947913837699656], [0.4132952466687074], [0.35647848695652073], [-0.7948510632131641], [0.37316747638211295], [-0.6228845739893487], [0.304987929614494], [0.01698870074757124], [-0.1542378325780218], [-0.5027591406426628], [0.1809856256543353], [-0.7950352548492329], [-0.41741317239637654], [0.48794316791056586], [-0.25983216609044213], [0.6613187065588869], [0.18788739005761246], [0.3257284340709788], [-0.6737795206437573], [-0.4298876080993597], [-0.8336732407488516], [-0.7684862819222741], [0.23549507375389767], [-0.5259391657743584], [-0.16703690952472344], [0.15110431460148474], [-0.7971430317658104], [0.7529060499026553], [-0.4591209652857634], [0.8812391367859386], [0.08520516341866789], [0.15915608500107595], [0.07092534656216089], [-0.5133382096520781], [0.3641269085147922], [-0.7162032237937745], [-0.3034792061363418], [0.6833563108819906], [0.23678876568334958], [0.15361309880731147], [-0.4212560503467737], [0.7823662780468041], [-0.5872807625120852], [0.23943780074855017], [-0.172793358724493], [-0.25206714786351864], [-0.8091476536909085], [0.2999650901510604], [0.14061729242973434], [-0.5040136930868346], [-0.23996543242787816], [0.02766882941473362], [0.5873156663859258], [-0.8295530444047361], [0.1474758940743536], [-0.08650856684828949], [0.13291638259045024], [0.4816299815102365], [0.510977721734884], [-0.7512672485798781], [0.09139617636238537], [0.36210158456801833], [0.02487568043384799], [0.1867135199978331], [0.837811259702246], [0.09079719793728311], [0.25031680337775836], [-0.1750380774615731], [0.6535663806758065], [-0.3131432803990614], [0.6922153153033427], [0.19904503062840803], [0.3142818398838181], [0.41656326619489126], [-0.8001469858489909], [-0.4559115427073527], [-0.6990368326761591], [-0.15273766552027335], [0.14723035670787707], [0.38450951584430926], [0.1805656788212722], [-0.37488029118167815], [-0.38447885293643913], [0.9054187885532738], [0.17193269875352188], [0.3011998202619388], [0.2778103840620618], [-0.8677623474019243], [-0.02533666651785931], [-0.5942152606410855], [0.5512607751815517], [0.2551501213323568], [-0.3599169546475601], [0.6179001696278199], [0.7871549307020398], [0.2038755564125477], [-0.7238445574260274], [-0.39516597131796405], [-0.4545002020696487], [0.13106607043572274], [0.7881666180965018], [0.3371091568374031], [0.11728397417236892], [-0.7172368207746028], [0.8116495086664781], [-0.0218511856267803], [0.16234720490610885], [0.06414651266754001], [-0.6975164707989833], [-0.5975735905957682], [0.4520191185106407], [-0.1998550430123741], [0.8288330372020795], [0.33851223135842007], [-0.8287753736557467], [-0.7333399427354886], [-0.1807483707593636], [-0.19503494540226846], [-0.5081342605931997], [0.10994253820547614], [0.4256608819856143], [0.5977068084206545], [-0.6357905027540156], [-0.5593468389699091], [-0.9816884620495996], [-0.727786116718966], [-0.4476300211213157], [0.18793285208110008], [0.08620899095557202], [0.6430348609841818], [0.05493058703821713], [-0.7441132547208243], [-0.32480154881105594], [0.17955392804214276], [0.18804285717616206], [-0.6756286074847084], [-0.24097557186006138], [0.6798402533586432], [-0.8944302457477628], [0.635775909899471], [-0.3402794247962357], [0.8594783615907273], [-0.4984505180290797], [0.2349533888577471], [0.663022890906663], [-0.7436445133983316], [-0.3049891999518434], [-0.7071461891531095], [-0.5215015252996199], [0.6906189687224645], [0.20921402184927493], [0.13616741813102679], [0.3974185232393079], [0.15786564965610286], [-0.005056927223636585], [0.4349883789757007], [0.5850068522267982], [0.1984665221814631], [0.5542367403839308], [-0.2564178881838785], [-0.7145510224634662], [-0.6653992642884358], [0.16885591148848636], [0.4894084614294668], [0.1718093697148647], [-0.7150767111759919], [-0.09930249088763846], [0.29152117580831455], [-0.8067096368516666], [-0.2386277829731722], [0.7737093035161992], [-0.12838815504265855], [-0.1810231438471312], [0.8559440961142891], [-0.2659362738166272], [-0.7229885154704963], [0.6248071610753094], [-0.4411462415553916], [0.4783445926250123], [0.4969510718434972], [0.016191733528209698], [0.5412919686489931], [-0.5326001749976453], [-0.8186801640218715], [0.5017677346511099], [0.1976462057245146], [-0.02985479777785141], [-0.19330702954545861], [0.5467862649410928], [-0.1380498131037871], [-0.5964246110948691], [0.567693415858795], [0.5245167700631461], [0.0172739367798229], [-0.5309264906414863], [-0.2895303208073194], [0.5211981034099417], [0.3590888574364779], [0.6236513059566651], [0.16379911256663043], [-0.05547577363554578], [0.7699139371282625], [-0.2763708923377371], [0.3352468629092405], [-0.29879082619097114], [-0.2174803610539384], [-0.36305295321957937], [0.7147124157865787], [-0.4621133868935328], [0.3529807622796046], [0.5863718332172929], [0.22086376286437692], [0.6511761237400717], [0.8788409419972554], [0.27751866387176216], [-0.3587984978794959], [-0.4764101003495522], [-0.68635182616495], [-0.11595688347692838], [0.37293149592005903], [-0.30414213586668404], [0.17493341164737933], [-0.6432226301393789], [-0.31664637695684156], [0.7304587177908839], [0.5375369466700238], [0.20429583588842246], [-0.46907829166155873], [0.3717995907105222], [0.8225317639390117], [-0.7404343714897429], [0.7080273550007129], [-0.6368280558017304], [0.8623531592635643], [0.4521762827783418], [0.34833975651744586], [0.4064651106266717], [-0.9031115100635043], [-0.4730498957226431], [0.14198804838210358], [0.7495215065663807], [0.7335239577097018], [-0.30390696992129673], [0.3340800928872022], [-0.09078491294644779], [0.14935830406305026], [0.5372784034559736], [0.4886129959284129], [0.16930164469854606], [-0.3319743777411698], [0.336813472420897], [0.6972965702599299], [0.03352516558867226], [0.5466925557593575], [-0.2673243076776426], [-0.5662080615654267], [-0.6359457572510434], [-0.1336943508305902], [-0.3711546203180554], [0.4102712593406384], [-0.9874974075744356], [0.7151814938290987], [-0.008372171135048656], [0.17990116838413545], [0.16128476140994852], [0.36107660131977587], [0.34721177283049226], [-0.4952682262732795], [0.3108595226692247], [0.0038741107770397815], [-0.053848242690288685], [-0.25063083867114555], [0.20573189934286107], [-0.4626301461364149], [0.18790103269228864], [0.2610147735111445], [-0.1749510931534494], [-0.7113838630249895], [0.11176760792191581], [0.810799549664952], [0.3157274022031114], [0.6461123347552786], [0.09570035249973789], [0.5002774792290335], [-0.4242395012954921], [-0.7310509458981422], [0.5076944858198514], [0.1878873900576357], [-0.04433455493438529], [-0.8322567370058714], [-0.3208066175001353], [0.03823051416096384], [-0.7027713355728118], [0.4059642456143203], [-0.21315284818540436], [-0.07798048158512591], [-0.0054324086151924245], [0.20404100228190938], [0.13610774850728838], [0.05645682621599968], [-0.39615501495072764], [-0.27254318811318395], [0.2919798621663518], [0.29403706393811313], [0.17194197691027713], [0.43130227266385124], [0.27927597379410396], [-0.5089638923445367], [0.7079437515714895], [0.26359385365562404], [0.8173035971031878], [0.758282903670514], [0.08886952628679579], [-0.33368313927176013], [0.6516766557628503], [-0.4730321314273098], [0.36766247284007986], [0.2645594301514963], [-0.6755420406176033], [-0.6174718507498297], [-0.4929109877250518], [-0.7778500371261002], [0.14411069889573883], [0.17193717425207167], [0.5716954563417374], [0.17969924547302352], [-0.012444997060276864], [0.09854044735505167], [-0.42025937230329896], [-0.356497983913087], [0.17192649612559807], [0.08363491693841725], [0.6742314124130052], [-0.6868973624382295], [-0.10850265136433893], [0.21500047165575134], [-0.6642762460962043], [-0.4687592201912307], [-0.7409051334492707], [0.8469940900220518], [0.19257146346724496], [0.25478419519229895], [-0.3735456620707383], [0.787432960932156], [0.7342796492394944], [0.8432471300089324], [0.7363282780063765], [-0.3930902229090674], [0.2612308191316083], [-0.3436765466293627], [-0.8233540454250714], [-0.5348871734278708], [-0.44830240559647383], [0.10969274858857887], [-0.48704275066487474], [0.01698519097859986], [-0.7404345465630804], [-0.2010808279047362], [-0.6911261566906363], [0.2529751790135074], [0.9563726274972751], [-0.6714664103691066], [-0.10719846512245504], [0.5234283030966098], [0.6081540533807779], [0.8812994179690768], [0.17969070059897221], [0.18796501303914198], [0.6001299235862768], [-0.6277650751808108], [0.4492931570841565], [0.2627856656347603], [-0.3135239857250991], [0.058953756888650094], [0.452425256512251], [0.6546281765176971], [0.18155168887012202], [0.29372788821833684], [-0.8004557816209387], [-0.7037638495977557], [0.11060383125723319], [-0.07455029495028155], [0.20976833379062942], [0.4526607385872529], [0.08093791976306505], [0.19323541699801727], [-0.6896271877780803], [-0.36597032446124533], [0.12822369588306898], [0.3329033791846199], [-0.5225023419663613], [-0.4159940798756511], [0.1708233527647194], [0.26539193904105834], [-0.48384651123635836], [-0.02032124989908886], [-0.8533154322920554], [0.19716582023141913], [-0.18117817793990004], [0.049549416327551866], [-0.6479556340430239], [0.14164513603739212], [0.6102606160189893], [0.5784202916331213], [0.5844513044914114], [0.17703582183647354], [0.1544058354143292], [-0.6214760549808099], [-0.3723922179998757], [-0.8467060715593072], [-0.5728549042282907], [0.15394417545243336], [0.19944286080833842], [0.32666285148527635], [-0.8023697688265792], [-0.3128586373717585], [-0.7618457846768031], [0.08494937010941143], [-0.4733038673829722], [0.5975977488210633], [0.8370819315298055], [-0.5375845499440829], [0.5233757018580817], [0.3395018926147574], [0.2666925072391432], [0.07770093611237607], [0.6918117109732764], [0.9070726113651043], [-0.573307429608316], [-0.29433164884821433], [-0.6133686153220413], [-0.12081572637189608], [-0.519158172380996], [0.8594540461394211], [0.25705489976500645], [0.8110477838739816], [-0.7531953080477807], [0.1294869878899407], [-0.5495306036738757], [0.44355226323283653], [-0.0019456272652657346], [0.6301069431867778], [0.7200123789072347], [-0.31999223171898006], [0.043027673231761945], [0.41446462700045755], [-0.4659294472148125], [-0.34751613158926997], [0.8426442993150076], [-0.7611240161833424], [-0.1900930643846653], [-0.6956975240901551], [-0.10249303806221335], [0.33806175574639197], [0.4200690590967397], [-0.19840907307283132], [0.2618646214877318], [0.6088234425476401], [0.03058058609364986], [0.08522132500868533], [0.6519970184988236], [0.35910383445817523], [0.13671757780252877], [-0.23959139533465224], [-0.4850274011155223], [0.004732819898244832], [-0.7817073939573679], [-0.14132876200204683], [-0.5348951386125489], [0.1494016772500998], [-0.5990691378141243], [0.2546491465350495], [0.24960718957062186], [-0.7404180901052441], [0.09673936968786996], [-0.693178326141628], [0.08492731269714514], [-0.32335308851489614], [-0.2621233702976303], [-0.006176100069104691], [-0.7539857823655327], [-0.6765030268272574], [0.3530746426056356], [-0.8157031767672029], [0.2542852031845837], [-0.8108927692747854], [0.7352851229865048], [0.016033613678685978], [0.2746052392887497], [0.0026097589442055234], [0.7665054027605419], [0.20411490391133041], [-0.4977873288734166], [0.11465906381484474], [-0.4569317232935235], [-0.25428447802388054], [-0.3726906525194777], [-0.18009750455037005], [0.16021494937571715], [-0.6222774194682404], [-0.677553602214316], [0.030437535163306405], [0.254883602448761], [-0.5291553643729973], [0.6162868433824216], [-0.14254528366705926], [0.6032418192182224], [0.302296564413023], [0.6660931180997591], [-0.37687348372980445], [0.1794380131246312], [0.2545283178431818], [0.8150074990167543], [-0.19062065749078186], [-0.8156244347395816], [0.3227247809608381], [0.15014319799083592], [0.6395891682522762], [-0.22035227517145586], [-0.6139080571006672], [0.6432534817816885], [-0.5487280243943865], [0.24589515238834497], [0.33872275581141964], [0.6295530722996127], [0.14063676081047669], [-0.9023127541691665], [0.26671990778060545], [-0.0966506540158844], [-0.10392835911345699], [-0.38224740097884313], [-0.2924073035014942], [0.68360871159367], [0.8273013229009648], [-0.6870956930640972], [-0.69985165204856], [-0.4268020853535569], [0.6722411105076577], [0.11407692154521236], [-0.2984042194310328], [0.0978868838174384], [-0.6811480886520871], [-0.5073781803097542], [0.4310885866050623], [0.4324783367410651], [-0.20827325049550258], [0.32704532505788014], [0.165052284351816], [0.15933236366569514], [0.3273311833863866], [0.72851834582131], [0.34451920037137324], [0.16947785315052796], [0.45520254507621427], [0.27403886709105146], [-0.8651704807757041], [0.09979991564563659], [0.42759466623147885], [0.7278315651024978], [0.9228875973246314], [0.7188453417586532], [0.2027133087003966], [0.06889507562917783], [0.00916217641574805], [0.5453935581169311], [0.06794748453667426], [0.1591560850021585], [-0.7591339979523541], [0.08568048130351089], [0.5727637551975614], [0.8275650272250822], [0.5894321620492461], [-0.27075982944843363], [0.13812317275856495], [-0.02929107285643996], [0.6411030873574431], [-0.5337867434251538], [0.3405216982643334], [0.20530521138515886], [-0.4722268227306701], [0.32116944070557135], [-0.7332678386527339], [-0.3567010951053261], [-0.4851193564664966], [-0.2579202028072546], [-0.18133257572932374], [0.03066266388940433], [-0.8449150134024569], [0.10352208672507318], [-0.02035795691432931], [0.1524896461346888], [0.03592151742633662], [0.1907860233299396], [-0.6503646546499787], [0.39324215691574615], [-0.9669645994770891], [0.7583766675381789], [0.8750061481988456], [0.13870089082866754], [0.47516458603098005], [0.3151721335733051], [-0.6434978414770989], [0.8290083356645034], [-0.27950957396738735], [-0.4146810780906969], [0.7591037051222359], [-0.5368707916705104], [-0.21570251882186697], [-0.42189797860043016], [0.7029166237454558], [0.2328825276891029], [0.6770153387661288], [-0.0015473199816583092], [-0.579418231503994], [0.4186355359324316], [0.11504044488457636], [0.020423981194123284], [0.3095209146906321], [-0.7377935270323319], [-0.5881133078193875], [0.1261460662057352], [0.01698900843510771], [-0.6059104923906935], [0.8502078200391253], [-0.544841064085853], [0.4875466698607232], [-0.5458429350506769], [0.04601939345802462], [0.18877163789481463], [-0.16171103536267983], [0.10800592666492378], [-0.49576279120355526], [0.47313533478031006], [0.0894806776956996], [0.3164479264695873], [-0.6809823178246556], [-0.46180697788959396], [0.3003120422809578], [0.4346366818108319], [0.2991833489151027], [-0.16483423658322072], [-0.5565308827419214], [0.1061346289078139], [-0.7128017777527155], [-0.37643354058040746], [-0.14101771952769415], [0.05625909098319591], [-0.7756842479208231], [-0.5787899608936069], [0.5651871189326488], [0.016403829767022086], [0.7744289437102191], [0.3601667301290999], [0.19553908968255881], [0.01580368056855339], [0.6807270997876685], [0.5834132022577193], [-0.053418905678450125], [0.3614237693689129], [0.5633476318741748], [0.3374656736354395], [-0.7915092233228106], [-0.397567261586495], [0.2546646199587017], [-0.3097817295331662], [0.0615217061971958], [0.33239282201301085], [0.15831822638895288], [0.20065871024882542], [0.6932629199974978], [0.5277982972449095], [-0.7457304259097604], [-0.11198088120966679], [-0.47236771255484833], [0.17152370057800742], [0.22658233056329424], [0.1718430676384951], [0.4863458016608694], [-0.4364771640683708], [0.0420251146234439], [-0.3067779284828043], [-0.39042326485873374], [0.1358878652160388], [0.28241152578491896], [0.35524090760526167], [0.003571171271529884], [0.016990009657750795], [-0.19030096441346903], [0.11856936213631533], [-0.3847197914620238], [0.16004463533591123], [-0.04457887171604435], [-0.7404461992585065], [0.44115905706294495], [-0.5942850158612506], [-0.35834526121628146], [0.19782645804201432], [0.001836935155849095], [0.9611776692342849], [-0.5595161228451129], [0.38397560315518], [-0.655554489190522], [0.1701261161720004], [0.7397840189442899], [0.019734520160048105], [-0.5675627310691223], [-0.703311301503678], [-0.49803417430650226], [0.9031767739361956], [-0.041893273941068426], [-0.9030886511949855], [-0.19493951946933197], [0.35486722737896215], [0.8805521990532835], [0.7034629544146371], [0.17962411393006322], [0.270033684529915], [-0.34386536265715306], [0.25111524878449465], [-0.15004936725075954], [0.04109383979561226], [0.4068934421643871], [0.4460289614547022], [0.3539989082374902], [-0.5676857137990929], [-0.7365818870548729], [0.675981813510331], [0.3759746136034182], [0.1879063088166553], [0.22662875122396642], [0.6334970074075776], [0.029438207316059575], [-0.5971140361440224], [0.06728202845380378], [0.3534789826136842], [0.8448097880484076], [-0.6289753249010184], [-0.8088750489918634], [0.16562361501833664], [0.017572650564582792], [0.19977898530945698], [0.35840600302605413], [0.18610041032704813], [0.5914503272686382], [-0.5616726244666191], [-0.35979175559228793], [-0.3143360459813353], [-0.18039551890458616], [0.8226272889727022], [-0.7874253492560646], [0.4959725994913657], [0.5035026907427497], [0.08492333596547312], [-0.043706684776987914], [0.15676644051567015], [0.17952547442286987], [-0.554163966585395], [-0.005567946350566804], [0.6271466607940641], [-0.5235192885336322], [-0.3288743726362188], [-0.46348194651160246], [-0.5302596822184777], [-0.8058333875997539], [-0.6978151237607167], [-0.07550896039497677], [0.49038280367482506], [0.2723866307321291], [0.08730939830992476], [0.090285388160479], [0.41051368519761117], [-0.8493398863535876], [0.30710211784940744], [-0.7878451169911376], [0.5364631866755041], [0.28053076041709596], [-0.8799860231192456], [-0.22309484483274997], [0.35894047598195394], [-0.267406739280263], [0.18400585180731807], [-0.49619496273053126], [0.58972735830422], [0.7641363611588706], [-0.056218140985541225], [0.7439919859176016], [0.7985534669350397], [-0.11159755289409393], [-0.6813281444844238], [0.7872841657740639], [0.37047596561823815], [-0.6291897282688482], [0.6214938532252148], [0.8563550732688222], [0.2685115219691133], [-0.5664538634179461], [0.6542033992494886], [0.16811687466099995], [0.17178700564127647], [-0.7768996016877459], [0.6340304371361946], [-0.8030800546351164], [0.621772175797552], [0.26435532997947714], [0.024239381586241837], [0.04766839970231769], [-0.21508361868231735], [0.25631688879570924], [0.41970493144900817], [0.8544778279693901], [0.17193592993499834], [-0.09693165972638135], [0.35546414666412635], [-0.12766564790664947], [0.21594232443756384], [-0.8738521601040347], [0.44581928160054707], [0.27285782425338745], [-0.9345821687030669], [-0.7886033132872778], [0.8355551705790512], [0.1591551262310261], [-0.5679487917329568], [-0.20722002072987372], [0.6862736805789434], [0.8516517126842265], [0.40591333531129015], [-0.04540940202533837], [0.5460612571435391], [0.18103610647839105], [0.5801920530870228], [-0.6204840592905009], [-0.48736634747756463], [0.36137010094362504], [0.2451556775305938], [0.12786971113740295], [-0.26973427587720944], [-0.07169947574618314], [-0.42031479226018525], [-0.6092251159667298], [0.22600419538223393], [0.24254069753130628], [-0.32623921684979507], [-0.3455493148953639], [-0.1601768806564432], [0.25464129064242946], [-0.165367331424717], [0.6898831397285607], [0.6842979241631473], [0.26221136398397143], [0.20021836530163872], [0.15953647885347283], [-0.15929789261269647], [-0.11808342179830375], [-0.2978759460398377], [0.31455071825127895], [-0.3862398246476938], [0.18830207306454988], [-0.7540015133843039], [0.364293822315362], [-0.00790176587283717], [-0.17969223812531487], [0.32301020763896937], [0.3310359303342011], [0.18713062402689368], [-0.44305279214297727], [0.43969902630800745], [-0.6768381515804225], [0.3927600587467174], [-0.16224907849646225], [-0.7873672170691072], [0.7395339290041516], [-0.3598171553730908], [0.8236632576332761], [0.06842518897365153], [0.6544248428490265], [-0.7884623197958324], [-0.1680611396411949], [0.19473830224648056], [0.25663308856687944], [-0.746928157480588], [0.7536019456506527], [0.415501638111921], [-0.4728160166043369], [0.043392722641926215], [-0.2729113933154692], [0.3528468408792915], [0.19179422056925952], [0.5446936059824222], [0.9061614949081633], [-0.6404164383923792], [-0.385340227709535], [0.8443566834817536], [-0.06143428748270109], [0.7263416902580286], [-0.4257800421129471], [0.6073159417499546], [0.12706105141309387], [-0.7500252788338586], [0.28251785688579295], [-0.19866524194422344], [0.6499860016174906], [-0.22110379539569322], [0.27584189309468743], [0.2007330372522342], [0.5893356659020744], [0.1138947198651466], [-0.1341410549499437], [0.49513651671447806], [0.06798171583710313], [0.6077698393372786], [0.37551504504715305], [-0.13187923111355396], [0.29425726682750825], [0.32963362829202897], [0.07061912557398943], [0.33054671895417076], [-0.43196428172906515], [-0.2594035399351203], [0.5359089319243806], [0.18021900085472353], [-0.6293493379711435], [0.17945346771924034], [-0.34167433181771056], [-0.1888243835538556], [-0.716531947457391], [0.7492649239465804], [-0.1050057585085719], [-0.6326296892787716], [0.15915907547856215], [-0.6084026263126717], [-0.04112034394779867], [0.19900724664504493], [0.2730625233273024], [0.1879476045828849], [-0.14375069077497246], [0.40173444574999034], [0.5480686733836929], [0.07937371928873632], [-0.8345611454444005], [-0.2673431224400583], [0.2568832790233645], [0.578933366634882], [-0.0014820065732870696], [0.3405860417172748], [0.3416039344918404], [0.5452845521772666], [-0.07666997771993936], [-0.5121919637398289], [-0.699258766193488], [-0.3499541585751561], [-0.2187401655726202], [-0.7767617466653056], [0.39461397831969525], [0.6535349882458144], [0.2529711089228601], [0.12919248482673718], [-0.64347534031934], [0.229412230281162], [-0.04135361282246628], [0.3439738772806025], [0.4190386892494445], [0.8104892696136807], [-0.9404856302391746], [-0.557375734993498], [0.20065651676506502], [0.3608504769780171], [-0.044748936231715754], [0.29930461461357477], [-0.6895073659575115], [0.18215470644448892], [0.7792892181465945], [-0.6025939391850547], [0.06747064233967197], [0.17619240085391097], [0.7774301835916304], [-0.497302548719788], [0.5001272127942028], [0.050594211326510596], [-0.371370434343691], [0.11799007292424883], [0.6049967231811759], [0.08106171021127925], [0.024407050402008666], [-0.45340728792942847], [-0.03340638738705667], [-0.5589724534597159], [0.0863603287842275], [0.5815652702153313], [-0.33536848783621476], [-0.647746389536907], [-0.6326301309856308], [0.2788384694527383], [0.229932924010832], [0.7282274125626993], [-0.779706735323071], [-0.3788693027550022], [-0.21688801755093132], [0.7803144561556009], [0.08449542679477756], [0.27010463161100234], [0.6049000652783748], [-0.6168355441834413], [0.48659075635145305], [0.7895645571730102], [-0.4927816532080712], [-0.25279187065561654], [-0.43409910838319504], [0.6631158996804052], [0.1879109901889206], [-0.6132748618331945], [0.7766683859624649], [-0.4196256430802467], [-0.3344848317444237], [0.26897989299233616], [0.33201557810364063], [0.5486445872162309], [-0.10515943078330753], [0.016987956121568084], [-0.4550381774632006], [0.39213058630867037], [0.6308485206509241], [-0.14638131172729238], [0.05865244347942652], [-0.6070730119768912], [0.18823546316552006], [-0.7077841350686175], [-0.08040639199730143], [-0.58590615625288], [-0.30658226125943283], [0.27929809947428447], [0.04059544021613356], [0.7899689354338348], [-0.22764528310191312], [0.1172934378865828], [0.1679756510326607], [0.03485262645981933], [-0.4243806997195402], [-0.43039007015361036], [0.5747547652782878], [0.1747884615498572], [0.848572927982766], [0.32862123370667046], [0.18400888588903358], [0.44414240204925104], [0.02555259911261268], [0.27927599140788223], [0.25484069219384475]]
4060

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}57}]:} \PY{n}{file} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{16k.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{lst1}\PY{o}{=}\PY{p}{[}\PY{p}{]}
         \PY{n}{j}\PY{o}{=}\PY{l+m+mi}{0}
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{file}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{asin}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{:}
             \PY{k}{if} \PY{n}{i} \PY{o+ow}{in} \PY{n}{X}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{n}{correlation\PYZus{}product\PYZus{}ID} \PY{o}{\PYZgt{}} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{:}
                 \PY{n}{lst1}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{[}\PY{n}{correlation\PYZus{}product\PYZus{}ID}\PY{p}{[}\PY{n}{j}\PY{p}{]}\PY{p}{]}\PY{p}{)}
                 \PY{n}{j}\PY{o}{=}\PY{n}{j}\PY{o}{+}\PY{l+m+mi}{1}
             \PY{k}{else}\PY{p}{:}
                 \PY{n}{lst1}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}84}]:} \PY{n}{lst1} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{asarray}\PY{p}{(}\PY{n}{lst1}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{lst1}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[[-0.18774723]
 [ 0.        ]
 [ 0.05651221]
 {\ldots}
 [ 0.        ]
 [ 0.        ]
 [ 0.        ]]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}89}]:} \PY{k}{def} \PY{n+nf}{idf\PYZus{}w2v\PYZus{}brand}\PY{p}{(}\PY{n}{doc\PYZus{}id}\PY{p}{,} \PY{n}{w1}\PY{p}{,} \PY{n}{w2}\PY{p}{,} \PY{n}{w3}\PY{p}{,} \PY{n}{w4}\PY{p}{,} \PY{n}{num\PYZus{}results}\PY{p}{)}\PY{p}{:}
             \PY{c+c1}{\PYZsh{} doc\PYZus{}id: apparel\PYZsq{}s id in given corpus}
             \PY{c+c1}{\PYZsh{} w1: weight for  w2v features}
             \PY{c+c1}{\PYZsh{} w2: weight for brand and color features}
         
             \PY{c+c1}{\PYZsh{} pairwise\PYZus{}dist with cosine similarity}
             \PY{n}{idf\PYZus{}w2v\PYZus{}dist}  \PY{o}{=} \PY{n}{pairwise\PYZus{}distances}\PY{p}{(}\PY{n}{w2v\PYZus{}title\PYZus{}weight}\PY{p}{,} \PY{n}{w2v\PYZus{}title\PYZus{}weight}\PY{p}{[}\PY{n}{doc\PYZus{}id}\PY{p}{]}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
             \PY{n}{ex\PYZus{}feat\PYZus{}dist} \PY{o}{=} \PY{n}{pairwise\PYZus{}distances}\PY{p}{(}\PY{n}{extra\PYZus{}features}\PY{p}{,} \PY{n}{extra\PYZus{}features}\PY{p}{[}\PY{n}{doc\PYZus{}id}\PY{p}{]}\PY{p}{)}
             \PY{n}{cnn\PYZus{}dist} \PY{o}{=} \PY{n}{pairwise\PYZus{}distances}\PY{p}{(}\PY{n}{bottleneck\PYZus{}features\PYZus{}train}\PY{p}{,} \PY{n}{bottleneck\PYZus{}features\PYZus{}train}\PY{p}{[}\PY{n}{doc\PYZus{}id}\PY{p}{]}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
             \PY{n}{collab\PYZus{}dist} \PY{o}{=} \PY{n}{lst1}
             \PY{n}{pairwise\PYZus{}dist}   \PY{o}{=} \PY{p}{(}\PY{n}{w1} \PY{o}{*} \PY{n}{idf\PYZus{}w2v\PYZus{}dist} \PY{o}{+}  \PY{n}{w2} \PY{o}{*} \PY{n}{ex\PYZus{}feat\PYZus{}dist} \PY{o}{+} \PY{n}{w3} \PY{o}{*} \PY{n}{cnn\PYZus{}dist} \PY{o}{+} \PY{n}{w4} \PY{o}{*} \PY{n}{collab\PYZus{}dist}  \PY{p}{)}\PY{o}{/}\PY{n+nb}{float}\PY{p}{(}\PY{n}{w1} \PY{o}{+} \PY{n}{w2} \PY{o}{+} \PY{n}{w3} \PY{o}{+} \PY{n}{w4}\PY{p}{)}
             \PY{c+c1}{\PYZsh{} np.argsort will return indices of  smallest distances}
             \PY{n}{indices} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{argsort}\PY{p}{(}\PY{n}{pairwise\PYZus{}dist}\PY{o}{.}\PY{n}{flatten}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{num\PYZus{}results}\PY{p}{]}
             \PY{c+c1}{\PYZsh{}pdists will store the smallest distances}
             \PY{n}{pdists}  \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sort}\PY{p}{(}\PY{n}{pairwise\PYZus{}dist}\PY{o}{.}\PY{n}{flatten}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{num\PYZus{}results}\PY{p}{]}
         
             \PY{c+c1}{\PYZsh{}data frame indices of the smallest distace\PYZsq{}s}
             \PY{n}{df\PYZus{}indices} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n}{data}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{n}{indices}\PY{p}{]}\PY{p}{)}
             
             
         
             \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{indices}\PY{p}{)}\PY{p}{)}\PY{p}{:}
                 \PY{n}{heat\PYZus{}map\PYZus{}w2v\PYZus{}brand}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{title}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{df\PYZus{}indices}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{]}\PY{p}{,}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{title}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{df\PYZus{}indices}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{medium\PYZus{}image\PYZus{}url}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{df\PYZus{}indices}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{n}{indices}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{indices}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{,}\PY{n}{df\PYZus{}indices}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{df\PYZus{}indices}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{weighted}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                 \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ASIN :}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{asin}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{df\PYZus{}indices}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]}\PY{p}{)}
                 \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Brand :}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{brand}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{df\PYZus{}indices}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]}\PY{p}{)}
                 \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{euclidean distance from input :}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{pdists}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
                 \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{=}\PY{l+s+s1}{\PYZsq{}}\PY{o}{*}\PY{l+m+mi}{125}\PY{p}{)}
         
         \PY{n}{idf\PYZus{}w2v\PYZus{}brand}\PY{p}{(}\PY{l+m+mi}{4284}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{,} \PY{l+m+mf}{0.5}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{)}
\end{Verbatim}


    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_115_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B06VY83L6Z
Brand : George Jimmy
euclidean distance from input : 0.003421825243205559
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_115_4.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B06W5JQ7R9
Brand : George Jimmy
euclidean distance from input : 2.4162686975990852
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_115_7.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B06X6MVVV8
Brand : George Jimmy
euclidean distance from input : 2.4230307325777605
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_115_10.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B01GFVZZPW
Brand : Anboo
euclidean distance from input : 2.518064132848429
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_115_13.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B06VYJGTS7
Brand : George Jimmy
euclidean distance from input : 2.557286890541635
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_115_16.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B06X9STMKC
Brand : Fheaven
euclidean distance from input : 2.5598285412567705
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_115_19.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B072FP1NQV
Brand : Alfani
euclidean distance from input : 2.5707374967743615
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_115_22.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B071DK29B3
Brand : Macbeth
euclidean distance from input : 2.5879403470773656
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_115_25.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B00X0JI2VW
Brand : Arctic Leaf
euclidean distance from input : 2.5919338887965866
=============================================================================================================================

    \end{Verbatim}

    
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_115_28.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
ASIN : B074FRG8D8
Brand : Nanon
euclidean distance from input : 2.594179566523406
=============================================================================================================================

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}76}]:} \PY{n}{idf\PYZus{}w2v\PYZus{}dist}  \PY{o}{=} \PY{n}{pairwise\PYZus{}distances}\PY{p}{(}\PY{n}{w2v\PYZus{}title\PYZus{}weight}\PY{p}{,} \PY{n}{w2v\PYZus{}title\PYZus{}weight}\PY{p}{[}\PY{n}{doc\PYZus{}id}\PY{p}{]}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]

        ---------------------------------------------------------------------------

        IndexError                                Traceback (most recent call last)

        <ipython-input-76-4cef18af40c5> in <module>()
    ----> 1 idf\_w2v\_dist  = pairwise\_distances(w2v\_title\_weight, w2v\_title\_weight[doc\_id].reshape(1,-1))
    

        IndexError: index 16042 is out of bounds for axis 0 with size 16042

    \end{Verbatim}


    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
